/*!
---
MooTools: the javascript framework

web build:
 - http://mootools.net/core/76bf47062d6c1983d66ce47ad66aa0e0

packager build:
 - packager build Core/Core Core/Array Core/String Core/Number Core/Function Core/Object Core/Event Core/Browser Core/Class Core/Class.Extras Core/Slick.Parser Core/Slick.Finder Core/Element Core/Element.Style Core/Element.Event Core/Element.Delegation Core/Element.Dimensions Core/Fx Core/Fx.CSS Core/Fx.Tween Core/Fx.Morph Core/Fx.Transitions Core/Request Core/Request.HTML Core/Request.JSON Core/Cookie Core/JSON Core/DOMReady Core/Swiff

copyrights:
  - [MooTools](http://mootools.net)

licenses:
  - [MIT License](http://mootools.net/license.txt)
...
*/
(function(){this.MooTools={version:"1.4.5",build:"ab8ea8824dc3b24b6666867a2c4ed58ebb762cf0"};var u=this.typeOf=function(a){if(a==null){return"null"}if(a.$family!=null){return a.$family()}if(a.nodeName){if(a.nodeType==1){return"element"}if(a.nodeType==3){return(/\S/).test(a.nodeValue)?"textnode":"whitespace"}}else{if(typeof a.length=="number"){if(a.callee){return"arguments"}if("item" in a){return"collection"}}}return typeof a};var z=this.instanceOf=function(b,a){if(b==null){return false}var c=b.$constructor||b.constructor;while(c){if(c===a){return true}c=c.parent}if(!b.hasOwnProperty){return false}return b instanceof a};var C=this.Function;var t=true;for(var y in {toString:1}){t=null}if(t){t=["hasOwnProperty","valueOf","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","constructor"]}C.prototype.overloadSetter=function(b){var a=this;return function(f,g){if(f==null){return this}if(b||typeof f!="string"){for(var d in f){a.call(this,d,f[d])}if(t){for(var c=t.length;c--;){d=t[c];if(f.hasOwnProperty(d)){a.call(this,d,f[d])}}}}else{a.call(this,f,g)}return this}};C.prototype.overloadGetter=function(b){var a=this;return function(f){var d,g;if(typeof f!="string"){d=f}else{if(arguments.length>1){d=arguments}else{if(b){d=[f]}}}if(d){g={};for(var c=0;c<d.length;c++){g[d[c]]=a.call(this,d[c])}}else{g=a.call(this,f)}return g}};C.prototype.extend=function(a,b){this[a]=b}.overloadSetter();C.prototype.implement=function(a,b){this.prototype[a]=b}.overloadSetter();var v=Array.prototype.slice;C.from=function(a){return(u(a)=="function")?a:function(){return a}};Array.from=function(a){if(a==null){return[]}return(H.isEnumerable(a)&&typeof a!="string")?(u(a)=="array")?a:v.call(a):[a]};Number.from=function(b){var a=parseFloat(b);return isFinite(a)?a:null};String.from=function(a){return a+""};C.implement({hide:function(){this.$hidden=true;return this},protect:function(){this.$protected=true;return this}});var H=this.Type=function(a,c){if(a){var d=a.toLowerCase();var b=function(f){return(u(f)==d)};H["is"+a]=b;if(c!=null){c.prototype.$family=(function(){return d}).hide()}}if(c==null){return null}c.extend(this);c.$constructor=H;c.prototype.$constructor=c;return c};var D=Object.prototype.toString;H.isEnumerable=function(a){return(a!=null&&typeof a.length=="number"&&D.call(a)!="[object Function]")};var s={};var i=function(a){var b=u(a.prototype);return s[b]||(s[b]=[])};var G=function(f,a){if(a&&a.$hidden){return}var g=i(this);for(var d=0;d<g.length;d++){var b=g[d];if(u(b)=="type"){G.call(b,f,a)}else{b.call(this,f,a)}}var c=this.prototype[f];if(c==null||!c.$protected){this.prototype[f]=a}if(this[f]==null&&u(a)=="function"){w.call(this,f,function(h){return a.apply(h,v.call(arguments,1))})}};var w=function(b,a){if(a&&a.$hidden){return}var c=this[b];if(c==null||!c.$protected){this[b]=a}};H.implement({implement:G.overloadSetter(),extend:w.overloadSetter(),alias:function(a,b){G.call(this,a,this.prototype[b])}.overloadSetter(),mirror:function(a){i(this).push(a);return this}});new H("Type",H);var E=function(m,g,j){var k=(g!=Object),b=g.prototype;if(k){g=new H(m,g)}for(var f=0,h=j.length;f<h;f++){var a=j[f],c=g[a],d=b[a];if(c){c.protect()}if(k&&d){g.implement(a,d.protect())}}if(k){var l=b.propertyIsEnumerable(j[0]);g.forEachMethod=function(n){if(!l){for(var o=0,q=j.length;o<q;o++){n.call(b,b[j[o]],j[o])}}for(var p in b){n.call(b,b[p],p)}}}return E};E("String",String,["charAt","charCodeAt","concat","indexOf","lastIndexOf","match","quote","replace","search","slice","split","substr","substring","trim","toLowerCase","toUpperCase"])("Array",Array,["pop","push","reverse","shift","sort","splice","unshift","concat","join","slice","indexOf","lastIndexOf","filter","forEach","every","map","some","reduce","reduceRight"])("Number",Number,["toExponential","toFixed","toLocaleString","toPrecision"])("Function",C,["apply","call","bind"])("RegExp",RegExp,["exec","test"])("Object",Object,["create","defineProperty","defineProperties","keys","getPrototypeOf","getOwnPropertyDescriptor","getOwnPropertyNames","preventExtensions","isExtensible","seal","isSealed","freeze","isFrozen"])("Date",Date,["now"]);Object.extend=w.overloadSetter();Date.extend("now",function(){return +(new Date)});new H("Boolean",Boolean);Number.prototype.$family=function(){return isFinite(this)?"number":"null"}.hide();Number.extend("random",function(b,a){return Math.floor(Math.random()*(a-b+1)+b)});var B=Object.prototype.hasOwnProperty;Object.extend("forEach",function(c,b,a){for(var d in c){if(B.call(c,d)){b.call(a,c[d],d,c)}}});Object.each=Object.forEach;Array.implement({forEach:function(b,a){for(var c=0,d=this.length;c<d;c++){if(c in this){b.call(a,this[c],c,this)}}},each:function(a,b){Array.forEach(this,a,b);return this}});var x=function(a){switch(u(a)){case"array":return a.clone();case"object":return Object.clone(a);default:return a}};Array.implement("clone",function(){var b=this.length,a=new Array(b);while(b--){a[b]=x(this[b])}return a});var A=function(c,b,a){switch(u(a)){case"object":if(u(c[b])=="object"){Object.merge(c[b],a)}else{c[b]=Object.clone(a)}break;case"array":c[b]=a.clone();break;default:c[b]=a}return c};Object.extend({merge:function(g,c,d){if(u(c)=="string"){return A(g,c,d)}for(var h=1,f=arguments.length;h<f;h++){var b=arguments[h];for(var a in b){A(g,a,b[a])}}return g},clone:function(b){var a={};for(var c in b){a[c]=x(b[c])}return a},append:function(a){for(var b=1,d=arguments.length;b<d;b++){var f=arguments[b]||{};for(var c in f){a[c]=f[c]}}return a}});["Object","WhiteSpace","TextNode","Collection","Arguments"].each(function(a){new H(a)});var F=Date.now();String.extend("uniqueID",function(){return(F++).toString(36)})})();Array.implement({every:function(i,h){for(var f=0,g=this.length>>>0;f<g;f++){if((f in this)&&!i.call(h,this[f],f,this)){return false}}return true},filter:function(k,i){var l=[];for(var j,g=0,h=this.length>>>0;g<h;g++){if(g in this){j=this[g];if(k.call(i,j,g,this)){l.push(j)}}}return l},indexOf:function(i,h){var f=this.length>>>0;for(var g=(h<0)?Math.max(0,f+h):h||0;g<f;g++){if(this[g]===i){return g}}return -1},map:function(j,h){var i=this.length>>>0,f=Array(i);for(var g=0;g<i;g++){if(g in this){f[g]=j.call(h,this[g],g,this)}}return f},some:function(i,h){for(var f=0,g=this.length>>>0;f<g;f++){if((f in this)&&i.call(h,this[f],f,this)){return true}}return false},clean:function(){return this.filter(function(b){return b!=null})},invoke:function(d){var c=Array.slice(arguments,1);return this.map(function(a){return a[d].apply(a,c)})},associate:function(i){var h={},f=Math.min(this.length,i.length);for(var g=0;g<f;g++){h[i[g]]=this[g]}return h},link:function(j){var g={};for(var h=0,f=this.length;h<f;h++){for(var i in j){if(j[i](this[h])){g[i]=this[h];delete j[i];break}}}return g},contains:function(d,c){return this.indexOf(d,c)!=-1},append:function(b){this.push.apply(this,b);return this},getLast:function(){return(this.length)?this[this.length-1]:null},getRandom:function(){return(this.length)?this[Number.random(0,this.length-1)]:null},include:function(b){if(!this.contains(b)){this.push(b)}return this},combine:function(g){for(var d=0,f=g.length;d<f;d++){this.include(g[d])}return this},erase:function(c){for(var d=this.length;d--;){if(this[d]===c){this.splice(d,1)}}return this},empty:function(){this.length=0;return this},flatten:function(){var h=[];for(var f=0,g=this.length;f<g;f++){var i=typeOf(this[f]);if(i=="null"){continue}h=h.concat((i=="array"||i=="collection"||i=="arguments"||instanceOf(this[f],Array))?Array.flatten(this[f]):this[f])}return h},pick:function(){for(var c=0,d=this.length;c<d;c++){if(this[c]!=null){return this[c]}}return null},hexToRgb:function(c){if(this.length!=3){return null}var d=this.map(function(a){if(a.length==1){a+=a}return a.toInt(16)});return(c)?d:"rgb("+d+")"},rgbToHex:function(h){if(this.length<3){return null}if(this.length==4&&this[3]==0&&!h){return"transparent"}var f=[];for(var g=0;g<3;g++){var i=(this[g]-0).toString(16);f.push((i.length==1)?"0"+i:i)}return(h)?f:"#"+f.join("")}});String.implement({test:function(d,c){return((typeOf(d)=="regexp")?d:new RegExp(""+d,c)).test(this)},contains:function(d,c){return(c)?(c+this+c).indexOf(c+d+c)>-1:String(this).indexOf(d)>-1},trim:function(){return String(this).replace(/^\s+|\s+$/g,"")},clean:function(){return String(this).replace(/\s+/g," ").trim()},camelCase:function(){return String(this).replace(/-\D/g,function(b){return b.charAt(1).toUpperCase()})},hyphenate:function(){return String(this).replace(/[A-Z]/g,function(b){return("-"+b.charAt(0).toLowerCase())})},capitalize:function(){return String(this).replace(/\b[a-z]/g,function(b){return b.toUpperCase()})},escapeRegExp:function(){return String(this).replace(/([-.*+?^${}()|[\]\/\\])/g,"\\$1")},toInt:function(b){return parseInt(this,b||10)},toFloat:function(){return parseFloat(this)},hexToRgb:function(c){var d=String(this).match(/^#?(\w{1,2})(\w{1,2})(\w{1,2})$/);return(d)?d.slice(1).hexToRgb(c):null},rgbToHex:function(c){var d=String(this).match(/\d{1,3}/g);return(d)?d.rgbToHex(c):null},substitute:function(d,c){return String(this).replace(c||(/\\?\{([^{}]+)\}/g),function(a,b){if(a.charAt(0)=="\\"){return a.slice(1)}return(d[b]!=null)?d[b]:""})}});Number.implement({limit:function(c,d){return Math.min(d,Math.max(c,this))},round:function(b){b=Math.pow(10,b||0).toFixed(b<0?-b:0);return Math.round(this*b)/b},times:function(d,g){for(var f=0;f<this;f++){d.call(g,f,this)}},toFloat:function(){return parseFloat(this)},toInt:function(b){return parseInt(this,b||10)}});Number.alias("each","times");(function(c){var d={};c.each(function(a){if(!Number[a]){d[a]=function(){return Math[a].apply(null,[this].concat(Array.from(arguments)))}}});Number.implement(d)})(["abs","acos","asin","atan","atan2","ceil","cos","exp","floor","log","max","min","pow","sin","sqrt","tan"]);Function.extend({attempt:function(){for(var d=0,f=arguments.length;d<f;d++){try{return arguments[d]()}catch(g){}}return null}});Function.implement({attempt:function(f,g){try{return this.apply(g,Array.from(f))}catch(d){}return null},bind:function(h){var g=this,f=arguments.length>1?Array.slice(arguments,1):null,i=function(){};var j=function(){var b=h,a=arguments.length;if(this instanceof j){i.prototype=g.prototype;b=new i}var c=(!f&&!a)?g.call(b):g.apply(b,f&&a?f.concat(Array.slice(arguments)):f||arguments);return b==h?c:b};return j},pass:function(d,g){var f=this;if(d!=null){d=Array.from(d)}return function(){return f.apply(g,d||arguments)}},delay:function(d,g,f){return setTimeout(this.pass((f==null?[]:f),g),d)},periodical:function(g,d,f){return setInterval(this.pass((f==null?[]:f),d),g)}});(function(){var b=Object.prototype.hasOwnProperty;Object.extend({subset:function(k,h){var i={};for(var j=0,a=h.length;j<a;j++){var l=h[j];if(l in k){i[l]=k[l]}}return i},map:function(a,h,g){var i={};for(var j in a){if(b.call(a,j)){i[j]=h.call(g,a[j],j,a)}}return i},filter:function(a,j,h){var k={};for(var l in a){var i=a[l];if(b.call(a,l)&&j.call(h,i,l,a)){k[l]=i}}return k},every:function(a,g,f){for(var h in a){if(b.call(a,h)&&!g.call(f,a[h],h)){return false}}return true},some:function(a,g,f){for(var h in a){if(b.call(a,h)&&g.call(f,a[h],h)){return true}}return false},keys:function(a){var f=[];for(var g in a){if(b.call(a,g)){f.push(g)}}return f},values:function(g){var a=[];for(var f in g){if(b.call(g,f)){a.push(g[f])}}return a},getLength:function(a){return Object.keys(a).length},keyOf:function(a,f){for(var g in a){if(b.call(a,g)&&a[g]===f){return g}}return null},contains:function(a,d){return Object.keyOf(a,d)!=null},toQueryString:function(a,g){var f=[];Object.each(a,function(c,d){if(g){d=g+"["+d+"]"}var i;switch(typeOf(c)){case"object":i=Object.toQueryString(c,d);break;case"array":var j={};c.each(function(h,l){j[l]=h});i=Object.toQueryString(j,d);break;default:i=d+"="+encodeURIComponent(c)}if(c!=null){f.push(i)}});return f.join("&")}})})();(function(){var s=this.document;var v=s.window=this;var A=navigator.userAgent.toLowerCase(),z=navigator.platform.toLowerCase(),u=A.match(/(opera|ie|firefox|chrome|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0],x=u[1]=="ie"&&s.documentMode;var o=this.Browser={extend:Function.prototype.extend,name:(u[1]=="version")?u[3]:u[1],version:x||parseFloat((u[1]=="opera"&&u[4])?u[4]:u[2]),Platform:{name:A.match(/ip(?:ad|od|hone)/)?"ios":(A.match(/(?:webos|android)/)||z.match(/mac|win|linux/)||["other"])[0]},Features:{xpath:!!(s.evaluate),air:!!(v.runtime),query:!!(s.querySelector),json:!!(v.JSON)},Plugins:{}};o[o.name]=true;o[o.name+parseInt(o.version,10)]=true;o.Platform[o.Platform.name]=true;o.Request=(function(){var b=function(){return new XMLHttpRequest()};var c=function(){return new ActiveXObject("MSXML2.XMLHTTP")};var a=function(){return new ActiveXObject("Microsoft.XMLHTTP")};return Function.attempt(function(){b();return b},function(){c();return c},function(){a();return a})})();o.Features.xhr=!!(o.Request);var t=(Function.attempt(function(){return navigator.plugins["Shockwave Flash"].description},function(){return new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")})||"0 r0").match(/\d+/g);o.Plugins.Flash={version:Number(t[0]||"0."+t[1])||0,build:Number(t[2])||0};o.exec=function(b){if(!b){return b}if(v.execScript){v.execScript(b)}else{var a=s.createElement("script");a.setAttribute("type","text/javascript");a.text=b;s.head.appendChild(a);s.head.removeChild(a)}return b};String.implement("stripScripts",function(c){var b="";var a=this.replace(/<script[^>]*>([\s\S]*?)<\/script>/gi,function(f,d){b+=d+"\n";return""});if(c===true){o.exec(b)}else{if(typeOf(c)=="function"){c(b,a)}}return a});o.extend({Document:this.Document,Window:this.Window,Element:this.Element,Event:this.Event});this.Window=this.$constructor=new Type("Window",function(){});this.$family=Function.from("window").hide();Window.mirror(function(a,b){v[a]=b});this.Document=s.$constructor=new Type("Document",function(){});s.$family=Function.from("document").hide();Document.mirror(function(a,b){s[a]=b});s.html=s.documentElement;if(!s.head){s.head=s.getElementsByTagName("head")[0]}if(s.execCommand){try{s.execCommand("BackgroundImageCache",false,true)}catch(w){}}if(this.attachEvent&&!this.addEventListener){var y=function(){this.detachEvent("onunload",y);s.head=s.html=s.window=null};this.attachEvent("onunload",y)}var q=Array.from;try{q(s.html.childNodes)}catch(w){Array.from=function(c){if(typeof c!="string"&&Type.isEnumerable(c)&&typeOf(c)!="array"){var b=c.length,a=new Array(b);while(b--){a[b]=c[b]}return a}return q(c)};var r=Array.prototype,p=r.slice;["pop","push","reverse","shift","sort","splice","unshift","concat","join","slice"].each(function(a){var b=r[a];Array[a]=function(c){return b.apply(Array.from(c),p.call(arguments,1))}})}})();(function(){var c={};var d=this.DOMEvent=new Type("DOMEvent",function(r,n){if(!n){n=window}r=r||n.event;if(r.$extended){return r}this.event=r;this.$extended=true;this.shift=r.shiftKey;this.control=r.ctrlKey;this.alt=r.altKey;this.meta=r.metaKey;var l=this.type=r.type;var m=r.target||r.srcElement;while(m&&m.nodeType==3){m=m.parentNode}this.target=document.id(m);if(l.indexOf("key")==0){var q=this.code=(r.which||r.keyCode);this.key=c[q];if(l=="keydown"){if(q>111&&q<124){this.key="f"+(q-111)}else{if(q>95&&q<106){this.key=q-96}}}if(this.key==null){this.key=String.fromCharCode(q).toLowerCase()}}else{if(l=="click"||l=="dblclick"||l=="contextmenu"||l=="DOMMouseScroll"||l.indexOf("mouse")==0){var b=n.document;b=(!b.compatMode||b.compatMode=="CSS1Compat")?b.html:b.body;this.page={x:(r.pageX!=null)?r.pageX:r.clientX+b.scrollLeft,y:(r.pageY!=null)?r.pageY:r.clientY+b.scrollTop};this.client={x:(r.pageX!=null)?r.pageX-n.pageXOffset:r.clientX,y:(r.pageY!=null)?r.pageY-n.pageYOffset:r.clientY};if(l=="DOMMouseScroll"||l=="mousewheel"){this.wheel=(r.wheelDelta)?r.wheelDelta/120:-(r.detail||0)/3}this.rightClick=(r.which==3||r.button==2);if(l=="mouseover"||l=="mouseout"){var a=r.relatedTarget||r[(l=="mouseover"?"from":"to")+"Element"];while(a&&a.nodeType==3){a=a.parentNode}this.relatedTarget=document.id(a)}}else{if(l.indexOf("touch")==0||l.indexOf("gesture")==0){this.rotation=r.rotation;this.scale=r.scale;this.targetTouches=r.targetTouches;this.changedTouches=r.changedTouches;var o=this.touches=r.touches;if(o&&o[0]){var p=o[0];this.page={x:p.pageX,y:p.pageY};this.client={x:p.clientX,y:p.clientY}}}}}if(!this.client){this.client={}}if(!this.page){this.page={}}});d.implement({stop:function(){return this.preventDefault().stopPropagation()},stopPropagation:function(){if(this.event.stopPropagation){this.event.stopPropagation()}else{this.event.cancelBubble=true}return this},preventDefault:function(){if(this.event.preventDefault){this.event.preventDefault()}else{this.event.returnValue=false}return this}});d.defineKey=function(a,b){c[a]=b;return this};d.defineKeys=d.defineKey.overloadSetter(true);d.defineKeys({"38":"up","40":"down","37":"left","39":"right","27":"esc","32":"space","8":"backspace","9":"tab","46":"delete","13":"enter"})})();(function(){var h=this.Class=new Type("Class",function(a){if(instanceOf(a,Function)){a={initialize:a}}var b=function(){j(this);if(b.$prototyping){return this}this.$caller=null;var c=(this.initialize)?this.initialize.apply(this,arguments):this;this.$caller=this.caller=null;return c}.extend(this).implement(a);b.$constructor=h;b.prototype.$constructor=b;b.prototype.parent=l;return b});var l=function(){if(!this.$caller){throw new Error('The method "parent" cannot be called.')}var c=this.$caller.$name,b=this.$caller.$owner.parent,a=(b)?b.prototype[c]:null;if(!a){throw new Error('The method "'+c+'" has no parent.')}return a.apply(this,arguments)};var j=function(d){for(var c in d){var a=d[c];switch(typeOf(a)){case"object":var b=function(){};b.prototype=a;d[c]=j(new b);break;case"array":d[c]=a.clone();break}}return d};var g=function(d,c,a){if(a.$origin){a=a.$origin}var b=function(){if(a.$protected&&this.$caller==null){throw new Error('The method "'+c+'" cannot be called.')}var n=this.caller,f=this.$caller;this.caller=f;this.$caller=b;var o=a.apply(this,arguments);this.$caller=f;this.caller=n;return o}.extend({$owner:d,$origin:a,$name:c});return b};var i=function(b,a,c){if(h.Mutators.hasOwnProperty(b)){a=h.Mutators[b].call(this,a);if(a==null){return this}}if(typeOf(a)=="function"){if(a.$hidden){return this}this.prototype[b]=(c)?a:g(this,b,a)}else{Object.merge(this.prototype,b,a)}return this};var k=function(b){b.$prototyping=true;var a=new b;delete b.$prototyping;return a};h.implement("implement",i.overloadSetter());h.Mutators={Extends:function(a){this.parent=a;this.prototype=k(a)},Implements:function(a){Array.from(a).each(function(b){var d=new b;for(var c in d){i.call(this,c,d[c],true)}},this)}}})();(function(){this.Chain=new Class({$chain:[],chain:function(){this.$chain.append(Array.flatten(arguments));return this},callChain:function(){return(this.$chain.length)?this.$chain.shift().apply(this,arguments):false},clearChain:function(){this.$chain.empty();return this}});var b=function(a){return a.replace(/^on([A-Z])/,function(g,f){return f.toLowerCase()})};this.Events=new Class({$events:{},addEvent:function(f,g,a){f=b(f);this.$events[f]=(this.$events[f]||[]).include(g);if(a){g.internal=true}return this},addEvents:function(a){for(var d in a){this.addEvent(d,a[d])}return this},fireEvent:function(f,h,a){f=b(f);var g=this.$events[f];if(!g){return this}h=Array.from(h);g.each(function(c){if(a){c.delay(a,this,h)}else{c.apply(this,h)}},this);return this},removeEvent:function(f,g){f=b(f);var h=this.$events[f];if(h&&!g.internal){var a=h.indexOf(g);if(a!=-1){delete h[a]}}return this},removeEvents:function(g){var f;if(typeOf(g)=="object"){for(f in g){this.removeEvent(f,g[f])}return this}if(g){g=b(g)}for(f in this.$events){if(g&&g!=f){continue}var h=this.$events[f];for(var a=h.length;a--;){if(a in h){this.removeEvent(f,h[a])}}}return this}});this.Options=new Class({setOptions:function(){var a=this.options=Object.merge.apply(null,[{},this.options].append(arguments));if(this.addEvent){for(var d in a){if(typeOf(a[d])!="function"||!(/^on[A-Z]/).test(d)){continue}this.addEvent(d,a[d]);delete a[d]}}return this}})})();(function(){var r,o,q,v,B={},z={},p=/\\/g;var x=function(a,b){if(a==null){return null}if(a.Slick===true){return a}a=(""+a).replace(/^\s+|\s+$/g,"");v=!!b;var c=(v)?z:B;if(c[a]){return c[a]}r={Slick:true,expressions:[],raw:a,reverse:function(){return x(this.raw,true)}};o=-1;while(a!=(a=a.replace(s,A))){}r.length=r.expressions.length;return c[r.raw]=(v)?u(r):r};var t=function(a){if(a==="!"){return" "}else{if(a===" "){return"!"}else{if((/^!/).test(a)){return a.replace(/^!/,"")}else{return"!"+a}}}};var u=function(a){var d=a.expressions;for(var g=0;g<d.length;g++){var b=d[g];var f={parts:[],tag:"*",combinator:t(b[0].combinator)};for(var h=0;h<b.length;h++){var c=b[h];if(!c.reverseCombinator){c.reverseCombinator=" "}c.combinator=c.reverseCombinator;delete c.reverseCombinator}b.reverse().push(f)}return a};var w=function(a){return a.replace(/[-[\]{}()*+?.\\^$|,#\s]/g,function(b){return"\\"+b})};var s=new RegExp("^(?:\\s*(,)\\s*|\\s*(<combinator>+)\\s*|(\\s+)|(<unicode>+|\\*)|\\#(<unicode>+)|\\.(<unicode>+)|\\[\\s*(<unicode1>+)(?:\\s*([*^$!~|]?=)(?:\\s*(?:([\"']?)(.*?)\\9)))?\\s*\\](?!\\])|(:+)(<unicode>+)(?:\\((?:(?:([\"'])([^\\13]*)\\13)|((?:\\([^)]+\\)|[^()]*)+))\\))?)".replace(/<combinator>/,"["+w(">+~`!@$%^&={}\\;</")+"]").replace(/<unicode>/g,"(?:[\\w\\u00a1-\\uFFFF-]|\\\\[^\\s0-9a-f])").replace(/<unicode1>/g,"(?:[:\\w\\u00a1-\\uFFFF-]|\\\\[^\\s0-9a-f])"));function A(c,m,n,a,J,I,L,K,M,b,j,i,g,h,N,f){if(m||o===-1){r.expressions[++o]=[];q=-1;if(m){return""}}if(n||a||q===-1){n=n||" ";var l=r.expressions[o];if(v&&l[q]){l[q].reverseCombinator=t(n)}l[++q]={combinator:n,tag:"*"}}var O=r.expressions[o][q];if(J){O.tag=J.replace(p,"")}else{if(I){O.id=I.replace(p,"")}else{if(L){L=L.replace(p,"");if(!O.classList){O.classList=[]}if(!O.classes){O.classes=[]}O.classList.push(L);O.classes.push({value:L,regexp:new RegExp("(^|\\s)"+w(L)+"(\\s|$)")})}else{if(g){f=f||N;f=f?f.replace(p,""):null;if(!O.pseudos){O.pseudos=[]}O.pseudos.push({key:g.replace(p,""),value:f,type:i.length==1?"class":"element"})}else{if(K){K=K.replace(p,"");j=(j||"").replace(p,"");var k,d;switch(M){case"^=":d=new RegExp("^"+w(j));break;case"$=":d=new RegExp(w(j)+"$");break;case"~=":d=new RegExp("(^|\\s)"+w(j)+"(\\s|$)");break;case"|=":d=new RegExp("^"+w(j)+"(-|$)");break;case"=":k=function(C){return j==C};break;case"*=":k=function(C){return C&&C.indexOf(j)>-1};break;case"!=":k=function(C){return j!=C};break;default:k=function(C){return !!C}}if(j==""&&(/^[*$^]=$/).test(M)){k=function(){return false}}if(!k){k=function(C){return C&&d.test(C)}}if(!O.attributes){O.attributes=[]}O.attributes.push({key:K,operator:M,value:j,test:k})}}}}}return""}var y=(this.Slick||{});y.parse=function(a){return x(a)};y.escapeRegExp=w;if(!this.Slick){this.Slick=y}}).apply((typeof exports!="undefined")?exports:this);(function(){var o={},c={},v=Object.prototype.toString;o.isNativeCode=function(a){return(/\{\s*\[native code\]\s*\}/).test(""+a)};o.isXML=function(a){return(!!a.xmlVersion)||(!!a.xml)||(v.call(a)=="[object XMLDocument]")||(a.nodeType==9&&a.documentElement.nodeName!="HTML")};o.setDocument=function(f){var H=f.nodeType;if(H==9){}else{if(H){f=f.ownerDocument}else{if(f.navigator){f=f.document}else{return}}}if(this.document===f){return}this.document=f;var G=f.documentElement,I=this.getUIDXML(G),j=c[I],m;if(j){for(m in j){this[m]=j[m]}return}j=c[I]={};j.root=G;j.isXMLDocument=this.isXML(f);j.brokenStarGEBTN=j.starSelectsClosedQSA=j.idGetsName=j.brokenMixedCaseQSA=j.brokenGEBCN=j.brokenCheckedQSA=j.brokenEmptyAttributeQSA=j.isHTMLDocument=j.nativeMatchesSelector=false;var F,h,b,a,i;var d,g="slick_uniqueid";var K=f.createElement("div");var J=f.body||f.getElementsByTagName("body")[0]||G;J.appendChild(K);try{K.innerHTML='<a id="'+g+'"></a>';j.isHTMLDocument=!!f.getElementById(g)}catch(l){}if(j.isHTMLDocument){K.style.display="none";K.appendChild(f.createComment(""));h=(K.getElementsByTagName("*").length>1);try{K.innerHTML="foo</foo>";d=K.getElementsByTagName("*");F=(d&&!!d.length&&d[0].nodeName.charAt(0)=="/")}catch(l){}j.brokenStarGEBTN=h||F;try{K.innerHTML='<a name="'+g+'"></a><b id="'+g+'"></b>';j.idGetsName=f.getElementById(g)===K.firstChild}catch(l){}if(K.getElementsByClassName){try{K.innerHTML='<a class="f"></a><a class="b"></a>';K.getElementsByClassName("b").length;K.firstChild.className="b";a=(K.getElementsByClassName("b").length!=2)}catch(l){}try{K.innerHTML='<a class="a"></a><a class="f b a"></a>';b=(K.getElementsByClassName("a").length!=2)}catch(l){}j.brokenGEBCN=a||b}if(K.querySelectorAll){try{K.innerHTML="foo</foo>";d=K.querySelectorAll("*");j.starSelectsClosedQSA=(d&&!!d.length&&d[0].nodeName.charAt(0)=="/")}catch(l){}try{K.innerHTML='<a class="MiX"></a>';j.brokenMixedCaseQSA=!K.querySelectorAll(".MiX").length}catch(l){}try{K.innerHTML='<select><option selected="selected">a</option></select>';j.brokenCheckedQSA=(K.querySelectorAll(":checked").length==0)}catch(l){}try{K.innerHTML='<a class=""></a>';j.brokenEmptyAttributeQSA=(K.querySelectorAll('[class*=""]').length!=0)}catch(l){}}try{K.innerHTML='<form action="s"><input id="action"/></form>';i=(K.firstChild.getAttribute("action")!="s")}catch(l){}j.nativeMatchesSelector=G.matchesSelector||G.mozMatchesSelector||G.webkitMatchesSelector;if(j.nativeMatchesSelector){try{j.nativeMatchesSelector.call(G,":slick");j.nativeMatchesSelector=null}catch(l){}}}try{G.slick_expando=1;delete G.slick_expando;j.getUID=this.getUIDHTML}catch(l){j.getUID=this.getUIDXML}J.removeChild(K);K=d=J=null;j.getAttribute=(j.isHTMLDocument&&i)?function(z,B){var y=this.attributeGetters[B];if(y){return y.call(z)}var A=z.getAttributeNode(B);return(A)?A.nodeValue:null}:function(z,A){var y=this.attributeGetters[A];return(y)?y.call(z):z.getAttribute(A)};j.hasAttribute=(G&&this.isNativeCode(G.hasAttribute))?function(y,z){return y.hasAttribute(z)}:function(y,z){y=y.getAttributeNode(z);return !!(y&&(y.specified||y.nodeValue))};var k=G&&this.isNativeCode(G.contains),E=f&&this.isNativeCode(f.contains);j.contains=(k&&E)?function(z,y){return z.contains(y)}:(k&&!E)?function(z,y){return z===y||((z===f)?f.documentElement:z).contains(y)}:(G&&G.compareDocumentPosition)?function(z,y){return z===y||!!(z.compareDocumentPosition(y)&16)}:function(z,y){if(y){do{if(y===z){return true}}while((y=y.parentNode))}return false};j.documentSorter=(G.compareDocumentPosition)?function(y,z){if(!y.compareDocumentPosition||!z.compareDocumentPosition){return 0}return y.compareDocumentPosition(z)&4?-1:y===z?0:1}:("sourceIndex" in G)?function(y,z){if(!y.sourceIndex||!z.sourceIndex){return 0}return y.sourceIndex-z.sourceIndex}:(f.createRange)?function(y,A){if(!y.ownerDocument||!A.ownerDocument){return 0}var z=y.ownerDocument.createRange(),B=A.ownerDocument.createRange();z.setStart(y,0);z.setEnd(y,0);B.setStart(A,0);B.setEnd(A,0);return z.compareBoundaryPoints(Range.START_TO_END,B)}:null;G=null;for(m in j){this[m]=j[m]}};var t=/^([#.]?)((?:[\w-]+|\*))$/,r=/\[.+[*$^]=(?:""|'')?\]/,s={};o.search=function(d,aj,ab,aq){var au=this.found=(aq)?null:(ab||[]);if(!d){return au}else{if(d.navigator){d=d.document}else{if(!d.nodeType){return au}}}var ad,k,b=this.uniques={},aa=!!(ab&&ab.length),ak=(d.nodeType==9);if(this.document!==(ak?d:d.ownerDocument)){this.setDocument(d)}if(aa){for(k=au.length;k--;){b[this.getUID(au[k])]=true}}if(typeof aj=="string"){var ar=aj.match(t);simpleSelectors:if(ar){var ao=ar[1],an=ar[2],ai,ae;if(!ao){if(an=="*"&&this.brokenStarGEBTN){break simpleSelectors}ae=d.getElementsByTagName(an);if(aq){return ae[0]||null}for(k=0;ai=ae[k++];){if(!(aa&&b[this.getUID(ai)])){au.push(ai)}}}else{if(ao=="#"){if(!this.isHTMLDocument||!ak){break simpleSelectors}ai=d.getElementById(an);if(!ai){return au}if(this.idGetsName&&ai.getAttributeNode("id").nodeValue!=an){break simpleSelectors}if(aq){return ai||null}if(!(aa&&b[this.getUID(ai)])){au.push(ai)}}else{if(ao=="."){if(!this.isHTMLDocument||((!d.getElementsByClassName||this.brokenGEBCN)&&d.querySelectorAll)){break simpleSelectors}if(d.getElementsByClassName&&!this.brokenGEBCN){ae=d.getElementsByClassName(an);if(aq){return ae[0]||null}for(k=0;ai=ae[k++];){if(!(aa&&b[this.getUID(ai)])){au.push(ai)}}}else{var f=new RegExp("(^|\\s)"+u.escapeRegExp(an)+"(\\s|$)");ae=d.getElementsByTagName("*");for(k=0;ai=ae[k++];){className=ai.className;if(!(className&&f.test(className))){continue}if(aq){return ai}if(!(aa&&b[this.getUID(ai)])){au.push(ai)}}}}}}if(aa){this.sort(au)}return(aq)?null:au}querySelector:if(d.querySelectorAll){if(!this.isHTMLDocument||s[aj]||this.brokenMixedCaseQSA||(this.brokenCheckedQSA&&aj.indexOf(":checked")>-1)||(this.brokenEmptyAttributeQSA&&r.test(aj))||(!ak&&aj.indexOf(",")>-1)||u.disableQSA){break querySelector}var g=aj,al=d;if(!ak){var ag=al.getAttribute("id"),ap="slickid__";al.setAttribute("id",ap);g="#"+ap+" "+g;d=al.parentNode}try{if(aq){return d.querySelector(g)||null}else{ae=d.querySelectorAll(g)}}catch(i){s[aj]=1;break querySelector}finally{if(!ak){if(ag){al.setAttribute("id",ag)}else{al.removeAttribute("id")}d=al}}if(this.starSelectsClosedQSA){for(k=0;ai=ae[k++];){if(ai.nodeName>"@"&&!(aa&&b[this.getUID(ai)])){au.push(ai)}}}else{for(k=0;ai=ae[k++];){if(!(aa&&b[this.getUID(ai)])){au.push(ai)}}}if(aa){this.sort(au)}return au}ad=this.Slick.parse(aj);if(!ad.length){return au}}else{if(aj==null){return au}else{if(aj.Slick){ad=aj}else{if(this.contains(d.documentElement||d,aj)){(au)?au.push(aj):au=aj;return au}else{return au}}}}this.posNTH={};this.posNTHLast={};this.posNTHType={};this.posNTHTypeLast={};this.push=(!aa&&(aq||(ad.length==1&&ad.expressions[0].length==1)))?this.pushArray:this.pushUID;if(au==null){au=[]}var m,X,Y;var ah,Z,af,aw,at,ac,a;var l,j,av,am,h=ad.expressions;search:for(k=0;(j=h[k]);k++){for(m=0;(av=j[m]);m++){ah="combinator:"+av.combinator;if(!this[ah]){continue search}Z=(this.isXMLDocument)?av.tag:av.tag.toUpperCase();af=av.id;aw=av.classList;at=av.classes;ac=av.attributes;a=av.pseudos;am=(m===(j.length-1));this.bitUniques={};if(am){this.uniques=b;this.found=au}else{this.uniques={};this.found=[]}if(m===0){this[ah](d,Z,af,at,ac,a,aw);if(aq&&am&&au.length){break search}}else{if(aq&&am){for(X=0,Y=l.length;X<Y;X++){this[ah](l[X],Z,af,at,ac,a,aw);if(au.length){break search}}}else{for(X=0,Y=l.length;X<Y;X++){this[ah](l[X],Z,af,at,ac,a,aw)}}}l=this.found}}if(aa||(ad.expressions.length>1)){this.sort(au)}return(aq)?(au[0]||null):au};o.uidx=1;o.uidk="slick-uniqueid";o.getUIDXML=function(b){var a=b.getAttribute(this.uidk);if(!a){a=this.uidx++;b.setAttribute(this.uidk,a)}return a};o.getUIDHTML=function(a){return a.uniqueNumber||(a.uniqueNumber=this.uidx++)};o.sort=function(a){if(!this.documentSorter){return a}a.sort(this.documentSorter);return a};o.cacheNTH={};o.matchNTH=/^([+-]?\d*)?([a-z]+)?([+-]\d+)?$/;o.parseNTHArgument=function(a){var d=a.match(this.matchNTH);if(!d){return false}var b=d[2]||false;var g=d[1]||1;if(g=="-"){g=-1}var f=+d[3]||0;d=(b=="n")?{a:g,b:f}:(b=="odd")?{a:2,b:1}:(b=="even")?{a:2,b:0}:{a:0,b:g};return(this.cacheNTH[a]=d)};o.createNTHPseudo=function(a,f,d,b){return function(E,h){var C=this.getUID(E);if(!this[d][C]){var i=E.parentNode;if(!i){return false}var g=i[a],D=1;if(b){var j=E.nodeName;do{if(g.nodeName!=j){continue}this[d][this.getUID(g)]=D++}while((g=g[f]))}else{do{if(g.nodeType!=1){continue}this[d][this.getUID(g)]=D++}while((g=g[f]))}}h=h||"n";var B=this.cacheNTH[h]||this.parseNTHArgument(h);if(!B){return false}var k=B.a,l=B.b,m=this[d][C];if(k==0){return l==m}if(k>0){if(m<l){return false}}else{if(l<m){return false}}return((m-l)%k)==0}};o.pushArray=function(d,h,a,f,g,b){if(this.matchSelector(d,h,a,f,g,b)){this.found.push(d)}};o.pushUID=function(d,i,a,f,h,b){var g=this.getUID(d);if(!this.uniques[g]&&this.matchSelector(d,i,a,f,h,b)){this.uniques[g]=true;this.found.push(d)}};o.matchNode=function(g,f){if(this.isHTMLDocument&&this.nativeMatchesSelector){try{return this.nativeMatchesSelector.call(g,f.replace(/\[([^=]+)=\s*([^'"\]]+?)\s*\]/g,'[$1="$2"]'))}catch(j){}}var k=this.Slick.parse(f);if(!k){return true}var a=k.expressions,l=0,b;for(b=0;(currentExpression=a[b]);b++){if(currentExpression.length==1){var d=currentExpression[0];if(this.matchSelector(g,(this.isXMLDocument)?d.tag:d.tag.toUpperCase(),d.id,d.classes,d.attributes,d.pseudos)){return true}l++}}if(l==k.length){return false}var h=this.search(this.document,k),i;for(b=0;i=h[b++];){if(i===g){return true}}return false};o.matchPseudo=function(a,g,b){var f="pseudo:"+g;if(this[f]){return this[f](a,b)}var d=this.getAttribute(a,g);return(b)?b==d:!!d};o.matchSelector=function(f,i,h,d,b,l){if(i){var k=(this.isXMLDocument)?f.nodeName:f.nodeName.toUpperCase();if(i=="*"){if(k<"@"){return false}}else{if(k!=i){return false}}}if(h&&f.getAttribute("id")!=h){return false}var a,g,j;if(d){for(a=d.length;a--;){j=this.getAttribute(f,"class");if(!(j&&d[a].regexp.test(j))){return false}}}if(b){for(a=b.length;a--;){g=b[a];if(g.operator?!g.test(this.getAttribute(f,g.key)):!this.hasAttribute(f,g.key)){return false}}}if(l){for(a=l.length;a--;){g=l[a];if(!this.matchPseudo(f,g.key,g.value)){return false}}}return true};var p={" ":function(b,i,g,a,m,k,d){var l,j,f;if(this.isHTMLDocument){getById:if(g){j=this.document.getElementById(g);if((!j&&b.all)||(this.idGetsName&&j&&j.getAttributeNode("id").nodeValue!=g)){f=b.all[g];if(!f){return}if(!f[0]){f=[f]}for(l=0;j=f[l++];){var h=j.getAttributeNode("id");if(h&&h.nodeValue==g){this.push(j,i,null,a,m,k);break}}return}if(!j){if(this.contains(this.root,b)){return}else{break getById}}else{if(this.document!==b&&!this.contains(b,j)){return}}this.push(j,i,null,a,m,k);return}getByClass:if(a&&b.getElementsByClassName&&!this.brokenGEBCN){f=b.getElementsByClassName(d.join(" "));if(!(f&&f.length)){break getByClass}for(l=0;j=f[l++];){this.push(j,i,g,null,m,k)}return}}getByTag:{f=b.getElementsByTagName(i);if(!(f&&f.length)){break getByTag}if(!this.brokenStarGEBTN){i=null}for(l=0;j=f[l++];){this.push(j,i,g,a,m,k)}}},">":function(d,h,a,f,g,b){if((d=d.firstChild)){do{if(d.nodeType==1){this.push(d,h,a,f,g,b)}}while((d=d.nextSibling))}},"+":function(d,h,a,f,g,b){while((d=d.nextSibling)){if(d.nodeType==1){this.push(d,h,a,f,g,b);break}}},"^":function(d,h,a,f,g,b){d=d.firstChild;if(d){if(d.nodeType==1){this.push(d,h,a,f,g,b)}else{this["combinator:+"](d,h,a,f,g,b)}}},"~":function(d,i,a,f,h,b){while((d=d.nextSibling)){if(d.nodeType!=1){continue}var g=this.getUID(d);if(this.bitUniques[g]){break}this.bitUniques[g]=true;this.push(d,i,a,f,h,b)}},"++":function(d,h,a,f,g,b){this["combinator:+"](d,h,a,f,g,b);this["combinator:!+"](d,h,a,f,g,b)},"~~":function(d,h,a,f,g,b){this["combinator:~"](d,h,a,f,g,b);this["combinator:!~"](d,h,a,f,g,b)},"!":function(d,h,a,f,g,b){while((d=d.parentNode)){if(d!==this.document){this.push(d,h,a,f,g,b)}}},"!>":function(d,h,a,f,g,b){d=d.parentNode;if(d!==this.document){this.push(d,h,a,f,g,b)}},"!+":function(d,h,a,f,g,b){while((d=d.previousSibling)){if(d.nodeType==1){this.push(d,h,a,f,g,b);break}}},"!^":function(d,h,a,f,g,b){d=d.lastChild;if(d){if(d.nodeType==1){this.push(d,h,a,f,g,b)}else{this["combinator:!+"](d,h,a,f,g,b)}}},"!~":function(d,i,a,f,h,b){while((d=d.previousSibling)){if(d.nodeType!=1){continue}var g=this.getUID(d);if(this.bitUniques[g]){break}this.bitUniques[g]=true;this.push(d,i,a,f,h,b)}}};for(var q in p){o["combinator:"+q]=p[q]}var n={empty:function(b){var a=b.firstChild;return !(a&&a.nodeType==1)&&!(b.innerText||b.textContent||"").length},not:function(b,a){return !this.matchNode(b,a)},contains:function(b,a){return(b.innerText||b.textContent||"").indexOf(a)>-1},"first-child":function(a){while((a=a.previousSibling)){if(a.nodeType==1){return false}}return true},"last-child":function(a){while((a=a.nextSibling)){if(a.nodeType==1){return false}}return true},"only-child":function(a){var d=a;while((d=d.previousSibling)){if(d.nodeType==1){return false}}var b=a;while((b=b.nextSibling)){if(b.nodeType==1){return false}}return true},"nth-child":o.createNTHPseudo("firstChild","nextSibling","posNTH"),"nth-last-child":o.createNTHPseudo("lastChild","previousSibling","posNTHLast"),"nth-of-type":o.createNTHPseudo("firstChild","nextSibling","posNTHType",true),"nth-last-of-type":o.createNTHPseudo("lastChild","previousSibling","posNTHTypeLast",true),index:function(b,a){return this["pseudo:nth-child"](b,""+(a+1))},even:function(a){return this["pseudo:nth-child"](a,"2n")},odd:function(a){return this["pseudo:nth-child"](a,"2n+1")},"first-of-type":function(b){var a=b.nodeName;while((b=b.previousSibling)){if(b.nodeName==a){return false}}return true},"last-of-type":function(b){var a=b.nodeName;while((b=b.nextSibling)){if(b.nodeName==a){return false}}return true},"only-of-type":function(b){var f=b,a=b.nodeName;while((f=f.previousSibling)){if(f.nodeName==a){return false}}var d=b;while((d=d.nextSibling)){if(d.nodeName==a){return false}}return true},enabled:function(a){return !a.disabled},disabled:function(a){return a.disabled},checked:function(a){return a.checked||a.selected},focus:function(a){return this.isHTMLDocument&&this.document.activeElement===a&&(a.href||a.type||this.hasAttribute(a,"tabindex"))},root:function(a){return(a===this.root)},selected:function(a){return a.selected}};for(var w in n){o["pseudo:"+w]=n[w]}var x=o.attributeGetters={"for":function(){return("htmlFor" in this)?this.htmlFor:this.getAttribute("for")},href:function(){return("href" in this)?this.getAttribute("href",2):this.getAttribute("href")},style:function(){return(this.style)?this.style.cssText:this.getAttribute("style")},tabindex:function(){var a=this.getAttributeNode("tabindex");return(a&&a.specified)?a.nodeValue:null},type:function(){return this.getAttribute("type")},maxlength:function(){var a=this.getAttributeNode("maxLength");return(a&&a.specified)?a.nodeValue:null}};x.MAXLENGTH=x.maxLength=x.maxlength;var u=o.Slick=(this.Slick||{});u.version="1.1.7";u.search=function(d,a,b){return o.search(d,a,b)};u.find=function(b,a){return o.search(b,a,null,true)};u.contains=function(b,a){o.setDocument(b);return o.contains(b,a)};u.getAttribute=function(b,a){o.setDocument(b);return o.getAttribute(b,a)};u.hasAttribute=function(b,a){o.setDocument(b);return o.hasAttribute(b,a)};u.match=function(b,a){if(!(b&&a)){return false}if(!a||a===b){return true}o.setDocument(b);return o.matchNode(b,a)};u.defineAttributeGetter=function(b,a){o.attributeGetters[b]=a;return this};u.lookupAttributeGetter=function(a){return o.attributeGetters[a]};u.definePseudo=function(b,a){o["pseudo:"+b]=function(d,f){return a.call(d,f)};return this};u.lookupPseudo=function(b){var a=o["pseudo:"+b];if(a){return function(d){return a.call(this,d)}}return null};u.override=function(b,a){o.override(b,a);return this};u.isXML=o.isXML;u.uidOf=function(a){return o.getUIDHTML(a)};if(!this.Slick){this.Slick=u}}).apply((typeof exports!="undefined")?exports:this);var Element=function(i,l){var k=Element.Constructors[i];if(k){return k(l)}if(typeof i!="string"){return document.id(i).set(l)}if(!l){l={}}if(!(/^[\w-]+$/).test(i)){var n=Slick.parse(i).expressions[0][0];i=(n.tag=="*")?"div":n.tag;if(n.id&&l.id==null){l.id=n.id}var o=n.attributes;if(o){for(var j,m=0,p=o.length;m<p;m++){j=o[m];if(l[j.key]!=null){continue}if(j.value!=null&&j.operator=="="){l[j.key]=j.value}else{if(!j.value&&!j.operator){l[j.key]=true}}}}if(n.classList&&l["class"]==null){l["class"]=n.classList.join(" ")}}return document.newElement(i,l)};if(Browser.Element){Element.prototype=Browser.Element.prototype;Element.prototype._fireEvent=(function(b){return function(a,d){return b.call(this,a,d)}})(Element.prototype.fireEvent)}new Type("Element",Element).mirror(function(d){if(Array.prototype[d]){return}var c={};c[d]=function(){var b=[],l=arguments,a=true;for(var i=0,m=this.length;i<m;i++){var k=this[i],n=b[i]=k[d].apply(k,l);a=(a&&typeOf(n)=="element")}return(a)?new Elements(b):b};Elements.implement(c)});if(!Browser.Element){Element.parent=Object;Element.Prototype={"$constructor":Element,"$family":Function.from("element").hide()};Element.mirror(function(d,c){Element.Prototype[d]=c})}Element.Constructors={};var IFrame=new Type("IFrame",function(){var h=Array.link(arguments,{properties:Type.isObject,iframe:function(a){return(a!=null)}});var j=h.properties||{},f;if(h.iframe){f=document.id(h.iframe)}var i=j.onload||function(){};delete j.onload;j.id=j.name=[j.id,j.name,f?(f.id||f.name):"IFrame_"+String.uniqueID()].pick();f=new Element(f||"iframe",j);var g=function(){i.call(f.contentWindow)};if(window.frames[j.id]){g()}else{f.addListener("load",g)}return f});var Elements=this.Elements=function(g){if(g&&g.length){var h={},i;for(var j=0;i=g[j++];){var f=Slick.uidOf(i);if(!h[f]){h[f]=true;this.push(i)}}}};Elements.prototype={length:0};Elements.parent=Array;new Type("Elements",Elements).implement({filter:function(d,c){if(!d){return this}return new Elements(Array.filter(this,(typeOf(d)=="string")?function(a){return a.match(d)}:d,c))}.protect(),push:function(){var h=this.length;for(var f=0,g=arguments.length;f<g;f++){var i=document.id(arguments[f]);if(i){this[h++]=i}}return(this.length=h)}.protect(),unshift:function(){var f=[];for(var i=0,g=arguments.length;i<g;i++){var h=document.id(arguments[i]);if(h){f.push(h)}}return Array.prototype.unshift.apply(this,f)}.protect(),concat:function(){var f=new Elements(this);for(var i=0,g=arguments.length;i<g;i++){var h=arguments[i];if(Type.isEnumerable(h)){f.append(h)}else{f.push(h)}}return f}.protect(),append:function(g){for(var d=0,f=g.length;d<f;d++){this.push(g[d])}return this}.protect(),empty:function(){while(this.length){delete this[--this.length]}return this}.protect()});(function(){var i=Array.prototype.splice,h={"0":0,"1":1,length:2};i.call(h,1,1);if(h[1]==1){Elements.implement("splice",function(){var a=this.length;var b=i.apply(this,arguments);while(a>=this.length){delete this[a--]}return b}.protect())}Array.forEachMethod(function(a,b){Elements.implement(b,a)});Array.mirror(Elements);var j;try{j=(document.createElement("<input name=x>").name=="x")}catch(g){}var k=function(a){return(""+a).replace(/&/g,"&amp;").replace(/"/g,"&quot;")};Document.implement({newElement:function(b,a){if(a&&a.checked!=null){a.defaultChecked=a.checked}if(j&&a){b="<"+b;if(a.name){b+=' name="'+k(a.name)+'"'}if(a.type){b+=' type="'+k(a.type)+'"'}b+=">";delete a.name;delete a.type}return this.id(this.createElement(b)).set(a)}})})();(function(){Slick.uidOf(window);Slick.uidOf(document);Document.implement({newTextNode:function(a){return this.createTextNode(a)},getDocument:function(){return this},getWindow:function(){return this.window},id:(function(){var a={string:function(c,d,b){c=Slick.find(b,"#"+c.replace(/(\W)/g,"\\$1"));return(c)?a.element(c,d):null},element:function(d,c){Slick.uidOf(d);if(!c&&!d.$family&&!(/^(?:object|embed)$/i).test(d.tagName)){var b=d.fireEvent;d._fireEvent=function(g,f){return b(g,f)};Object.append(d,Element.Prototype)}return d},object:function(d,c,b){if(d.toElement){return a.element(d.toElement(b),c)}return null}};a.textnode=a.whitespace=a.window=a.document=function(b){return b};return function(f,c,d){if(f&&f.$family&&f.uniqueNumber){return f}var b=typeOf(f);return(a[b])?a[b](f,c,d||document):null}})()});if(window.$==null){Window.implement("$",function(b,a){return document.id(b,a,this.document)})}Window.implement({getDocument:function(){return this.document},getWindow:function(){return this}});[Document,Element].invoke("implement",{getElements:function(a){return Slick.search(this,a,new Elements)},getElement:function(a){return document.id(Slick.find(this,a))}});var S={contains:function(a){return Slick.contains(this,a)}};if(!document.contains){Document.implement(S)}if(!document.createElement("div").contains){Element.implement(S)}var L=function(b,d){if(!b){return d}b=Object.clone(Slick.parse(b));var a=b.expressions;for(var c=a.length;c--;){a[c][0].combinator=d}return b};Object.forEach({getNext:"~",getPrevious:"!~",getParent:"!"},function(b,a){Element.implement(a,function(c){return this.getElement(L(c,b))})});Object.forEach({getAllNext:"~",getAllPrevious:"!~",getSiblings:"~~",getChildren:">",getParents:"!"},function(b,a){Element.implement(a,function(c){return this.getElements(L(c,b))})});Element.implement({getFirst:function(a){return document.id(Slick.search(this,L(a,">"))[0])},getLast:function(a){return document.id(Slick.search(this,L(a,">")).getLast())},getWindow:function(){return this.ownerDocument.window},getDocument:function(){return this.ownerDocument},getElementById:function(a){return document.id(Slick.find(this,"#"+(""+a).replace(/(\W)/g,"\\$1")))},match:function(a){return !a||Slick.match(this,a)}});if(window.$$==null){Window.implement("$$",function(a){if(arguments.length==1){if(typeof a=="string"){return Slick.search(this.document,a,new Elements)}else{if(Type.isEnumerable(a)){return new Elements(a)}}}return new Elements(arguments)})}var F={before:function(a,c){var b=c.parentNode;if(b){b.insertBefore(a,c)}},after:function(a,c){var b=c.parentNode;if(b){b.insertBefore(a,c.nextSibling)}},bottom:function(a,b){b.appendChild(a)},top:function(a,b){b.insertBefore(a,b.firstChild)}};F.inside=F.bottom;var U={},Z={};var T={};Array.forEach(["type","value","defaultValue","accessKey","cellPadding","cellSpacing","colSpan","frameBorder","rowSpan","tabIndex","useMap"],function(a){T[a.toLowerCase()]=a});T.html="innerHTML";T.text=(document.createElement("div").textContent==null)?"innerText":"textContent";Object.forEach(T,function(a,b){Z[b]=function(d,c){d[a]=c};U[b]=function(c){return c[a]}});var E=["compact","nowrap","ismap","declare","noshade","checked","disabled","readOnly","multiple","selected","noresize","defer","defaultChecked","autofocus","controls","autoplay","loop"];var W={};Array.forEach(E,function(b){var a=b.toLowerCase();W[a]=b;Z[a]=function(d,c){d[b]=!!c};U[a]=function(c){return !!c[b]}});Object.append(Z,{"class":function(b,a){("className" in b)?b.className=(a||""):b.setAttribute("class",a)},"for":function(b,a){("htmlFor" in b)?b.htmlFor=a:b.setAttribute("for",a)},style:function(b,a){(b.style)?b.style.cssText=a:b.setAttribute("style",a)},value:function(b,a){b.value=(a!=null)?a:""}});U["class"]=function(a){return("className" in a)?a.className||null:a.getAttribute("class")};var Y=document.createElement("button");try{Y.type="button"}catch(l){}if(Y.type!="button"){Z.type=function(b,a){b.setAttribute("type",a)}}Y=null;var P=document.createElement("input");P.value="t";P.type="submit";if(P.value!="t"){Z.type=function(a,c){var b=a.value;a.type=c;a.value=b}}P=null;var N=(function(a){a.random="attribute";return(a.getAttribute("random")=="attribute")})(document.createElement("div"));Element.implement({setProperty:function(a,d){var b=Z[a.toLowerCase()];if(b){b(this,d)}else{if(N){var c=this.retrieve("$attributeWhiteList",{})}if(d==null){this.removeAttribute(a);if(N){delete c[a]}}else{this.setAttribute(a,""+d);if(N){c[a]=true}}}return this},setProperties:function(b){for(var a in b){this.setProperty(a,b[a])}return this},getProperty:function(c){var g=U[c.toLowerCase()];if(g){return g(this)}if(N){var a=this.getAttributeNode(c),d=this.retrieve("$attributeWhiteList",{});if(!a){return null}if(a.expando&&!d[c]){var b=this.outerHTML;if(b.substr(0,b.search(/\/?['"]?>(?![^<]*<['"])/)).indexOf(c)<0){return null}d[c]=true}}var f=Slick.getAttribute(this,c);return(!f&&!Slick.hasAttribute(this,c))?null:f},getProperties:function(){var a=Array.from(arguments);return a.map(this.getProperty,this).associate(a)},removeProperty:function(a){return this.setProperty(a,null)},removeProperties:function(){Array.each(arguments,this.removeProperty,this);return this},set:function(c,a){var b=Element.Properties[c];(b&&b.set)?b.set.call(this,a):this.setProperty(c,a)}.overloadSetter(),get:function(a){var b=Element.Properties[a];return(b&&b.get)?b.get.apply(this):this.getProperty(a)}.overloadGetter(),erase:function(a){var b=Element.Properties[a];(b&&b.erase)?b.erase.apply(this):this.removeProperty(a);return this},hasClass:function(a){return this.className.clean().contains(a," ")},addClass:function(a){if(!this.hasClass(a)){this.className=(this.className+" "+a).clean()}return this},removeClass:function(a){this.className=this.className.replace(new RegExp("(^|\\s)"+a+"(?:\\s|$)"),"$1");return this},toggleClass:function(b,a){if(a==null){a=!this.hasClass(b)}return(a)?this.addClass(b):this.removeClass(b)},adopt:function(){var d=this,g,b=Array.flatten(arguments),c=b.length;if(c>1){d=g=document.createDocumentFragment()}for(var f=0;f<c;f++){var a=document.id(b[f],true);if(a){d.appendChild(a)}}if(g){this.appendChild(g)}return this},appendText:function(a,b){return this.grab(this.getDocument().newTextNode(a),b)},grab:function(a,b){F[b||"bottom"](document.id(a,true),this);return this},inject:function(a,b){F[b||"bottom"](this,document.id(a,true));return this},replaces:function(a){a=document.id(a,true);a.parentNode.replaceChild(this,a);return this},wraps:function(a,b){a=document.id(a,true);return this.replaces(a).grab(a,b)},getSelected:function(){this.selectedIndex;return new Elements(Array.from(this.options).filter(function(a){return a.selected}))},toQueryString:function(){var a=[];this.getElements("input, select, textarea").each(function(d){var b=d.type;if(!d.name||d.disabled||b=="submit"||b=="reset"||b=="file"||b=="image"){return}var c=(d.get("tag")=="select")?d.getSelected().map(function(f){return document.id(f).get("value")}):((b=="radio"||b=="checkbox")&&!d.checked)?null:d.get("value");Array.from(c).each(function(f){if(typeof f!="undefined"){a.push(encodeURIComponent(d.name)+"="+encodeURIComponent(f))}})});return a.join("&")}});var V={},O={};var M=function(a){return(O[a]||(O[a]={}))};var G=function(a){var b=a.uniqueNumber;if(a.removeEvents){a.removeEvents()}if(a.clearAttributes){a.clearAttributes()}if(b!=null){delete V[b];delete O[b]}return a};var K={input:"checked",option:"selected",textarea:"value"};Element.implement({destroy:function(){var a=G(this).getElementsByTagName("*");Array.each(a,G);Element.dispose(this);return null},empty:function(){Array.from(this.childNodes).each(Element.dispose);return this},dispose:function(){return(this.parentNode)?this.parentNode.removeChild(this):this},clone:function(n,p){n=n!==false;var h=this.cloneNode(n),a=[h],o=[this],j;if(n){a.append(Array.from(h.getElementsByTagName("*")));o.append(Array.from(this.getElementsByTagName("*")))}for(j=a.length;j--;){var m=a[j],i=o[j];if(!p){m.removeAttribute("id")}if(m.clearAttributes){m.clearAttributes();m.mergeAttributes(i);m.removeAttribute("uniqueNumber");if(m.options){var c=m.options,f=i.options;for(var k=c.length;k--;){c[k].selected=f[k].selected}}}var b=K[i.tagName.toLowerCase()];if(b&&i[b]){m[b]=i[b]}}if(Browser.ie){var g=h.getElementsByTagName("object"),d=this.getElementsByTagName("object");for(j=g.length;j--;){g[j].outerHTML=d[j].outerHTML}}return document.id(h)}});[Element,Window,Document].invoke("implement",{addListener:function(b,d){if(b=="unload"){var c=d,a=this;d=function(){a.removeListener("unload",d);c()}}else{V[Slick.uidOf(this)]=this}if(this.addEventListener){this.addEventListener(b,d,!!arguments[2])}else{this.attachEvent("on"+b,d)}return this},removeListener:function(a,b){if(this.removeEventListener){this.removeEventListener(a,b,!!arguments[2])}else{this.detachEvent("on"+a,b)}return this},retrieve:function(a,d){var b=M(Slick.uidOf(this)),c=b[a];if(d!=null&&c==null){c=b[a]=d}return c!=null?c:null},store:function(a,c){var b=M(Slick.uidOf(this));b[a]=c;return this},eliminate:function(b){var a=M(Slick.uidOf(this));delete a[b];return this}});if(window.attachEvent&&!window.addEventListener){window.addListener("unload",function(){Object.each(V,G);if(window.CollectGarbage){CollectGarbage()}})}Element.Properties={};Element.Properties.style={set:function(a){this.style.cssText=a},get:function(){return this.style.cssText},erase:function(){this.style.cssText=""}};Element.Properties.tag={get:function(){return this.tagName.toLowerCase()}};Element.Properties.html={set:function(a){if(a==null){a=""}else{if(typeOf(a)=="array"){a=a.join("")}}this.innerHTML=a},erase:function(){this.innerHTML=""}};var I=document.createElement("div");I.innerHTML="<nav></nav>";var ac=(I.childNodes.length==1);if(!ac){var J="abbr article aside audio canvas datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video".split(" "),ab=document.createDocumentFragment(),H=J.length;while(H--){ab.createElement(J[H])}}I=null;var X=Function.attempt(function(){var a=document.createElement("table");a.innerHTML="<tr><td></td></tr>";return true});var aa=document.createElement("tr"),Q="<td></td>";aa.innerHTML=Q;var D=(aa.innerHTML==Q);aa=null;if(!X||!D||!ac){Element.Properties.html.set=(function(a){var b={table:[1,"<table>","</table>"],select:[1,"<select>","</select>"],tbody:[2,"<table><tbody>","</tbody></table>"],tr:[3,"<table><tbody><tr>","</tr></tbody></table>"]};b.thead=b.tfoot=b.tbody;return function(h){var g=b[this.get("tag")];if(!g&&!ac){g=[0,"",""]}if(!g){return a.call(this,h)}var c=g[0],d=document.createElement("div"),f=d;if(!ac){ab.appendChild(d)}d.innerHTML=[g[1],h,g[2]].flatten().join("");while(c--){f=f.firstChild}this.empty().adopt(f.childNodes);if(!ac){ab.removeChild(d)}d=null}})(Element.Properties.html.set)}var R=document.createElement("form");R.innerHTML="<select><option>s</option></select>";if(R.firstChild.value!="s"){Element.Properties.value={set:function(c){var a=this.get("tag");if(a!="select"){return this.setProperty("value",c)}var h=this.getElements("option");for(var f=0;f<h.length;f++){var d=h[f],g=d.getAttributeNode("value"),b=(g&&g.specified)?d.value:d.get("text");if(b==c){return d.selected=true}}},get:function(){var c=this,a=c.get("tag");if(a!="select"&&a!="option"){return this.getProperty("value")}if(a=="select"&&!(c=c.getSelected()[0])){return""}var b=c.getAttributeNode("value");return(b&&b.specified)?c.value:c.get("text")}}}R=null;if(document.createElement("div").getAttributeNode("id")){Element.Properties.id={set:function(a){this.id=this.getAttributeNode("id").value=a},get:function(){return this.id||null},erase:function(){this.id=this.getAttributeNode("id").value=""}}}})();(function(){var l=document.html;var q=document.createElement("div");q.style.color="red";q.style.color=null;var r=q.style.color=="red";q=null;Element.Properties.styles={set:function(a){this.setStyles(a)}};var m=(l.style.opacity!=null),p=(l.style.filter!=null),k=/alpha\(opacity=([\d.]+)\)/i;var t=function(a,b){a.store("$opacity",b);a.style.visibility=b>0||b==null?"visible":"hidden"};var o=(m?function(a,b){a.style.opacity=b}:(p?function(b,c){var d=b.style;if(!b.currentStyle||!b.currentStyle.hasLayout){d.zoom=1}if(c==null||c==1){c=""}else{c="alpha(opacity="+(c*100).limit(0,100).round()+")"}var a=d.filter||b.getComputedStyle("filter")||"";d.filter=k.test(a)?a.replace(k,c):a+c;if(!d.filter){d.removeAttribute("filter")}}:t));var n=(m?function(a){var b=a.style.opacity||a.getComputedStyle("opacity");return(b=="")?1:b.toFloat()}:(p?function(b){var a=(b.style.filter||b.getComputedStyle("filter")),c;if(a){c=a.match(k)}return(c==null||a==null)?1:(c[1]/100)}:function(a){var b=a.retrieve("$opacity");if(b==null){b=(a.style.visibility=="hidden"?0:1)}return b}));var s=(l.style.cssFloat==null)?"styleFloat":"cssFloat";Element.implement({getComputedStyle:function(a){if(this.currentStyle){return this.currentStyle[a.camelCase()]}var b=Element.getDocument(this).defaultView,c=b?b.getComputedStyle(this,null):null;return(c)?c.getPropertyValue((a==s)?"float":a.hyphenate()):null},setStyle:function(b,c){if(b=="opacity"){if(c!=null){c=parseFloat(c)}o(this,c);return this}b=(b=="float"?s:b).camelCase();if(typeOf(c)!="string"){var a=(Element.Styles[b]||"@").split(" ");c=Array.from(c).map(function(d,f){if(!a[f]){return""}return(typeOf(d)=="number")?a[f].replace("@",Math.round(d)):d}).join(" ")}else{if(c==String(Number(c))){c=Math.round(c)}}this.style[b]=c;if((c==""||c==null)&&r&&this.style.removeAttribute){this.style.removeAttribute(b)}return this},getStyle:function(d){if(d=="opacity"){return n(this)}d=(d=="float"?s:d).camelCase();var c=this.style[d];if(!c||d=="zIndex"){c=[];for(var f in Element.ShortStyles){if(d!=f){continue}for(var g in Element.ShortStyles[f]){c.push(this.getStyle(g))}return c.join(" ")}c=this.getComputedStyle(d)}if(c){c=String(c);var a=c.match(/rgba?\([\d\s,]+\)/);if(a){c=c.replace(a[0],a[0].rgbToHex())}}if(Browser.opera||Browser.ie){if((/^(height|width)$/).test(d)&&!(/px$/.test(c))){var b=(d=="width")?["left","right"]:["top","bottom"],h=0;b.each(function(i){h+=this.getStyle("border-"+i+"-width").toInt()+this.getStyle("padding-"+i).toInt()},this);return this["offset"+d.capitalize()]-h+"px"}if(Browser.ie&&(/^border(.+)Width|margin|padding/).test(d)&&isNaN(parseFloat(c))){return"0px"}}return c},setStyles:function(a){for(var b in a){this.setStyle(b,a[b])}return this},getStyles:function(){var a={};Array.flatten(arguments).each(function(b){a[b]=this.getStyle(b)},this);return a}});Element.Styles={left:"@px",top:"@px",bottom:"@px",right:"@px",width:"@px",height:"@px",maxWidth:"@px",maxHeight:"@px",minWidth:"@px",minHeight:"@px",backgroundColor:"rgb(@, @, @)",backgroundPosition:"@px @px",color:"rgb(@, @, @)",fontSize:"@px",letterSpacing:"@px",lineHeight:"@px",clip:"rect(@px @px @px @px)",margin:"@px @px @px @px",padding:"@px @px @px @px",border:"@px @ rgb(@, @, @) @px @ rgb(@, @, @) @px @ rgb(@, @, @)",borderWidth:"@px @px @px @px",borderStyle:"@ @ @ @",borderColor:"rgb(@, @, @) rgb(@, @, @) rgb(@, @, @) rgb(@, @, @)",zIndex:"@",zoom:"@",fontWeight:"@",textIndent:"@px",opacity:"@"};Element.ShortStyles={margin:{},padding:{},border:{},borderWidth:{},borderStyle:{},borderColor:{}};["Top","Right","Bottom","Left"].each(function(d){var f=Element.ShortStyles;var b=Element.Styles;["margin","padding"].each(function(j){var i=j+d;f[j][i]=b[i]="@px"});var g="border"+d;f.border[g]=b[g]="@px @ rgb(@, @, @)";var h=g+"Width",c=g+"Style",a=g+"Color";f[g]={};f.borderWidth[h]=f[g][h]=b[h]="@px";f.borderStyle[c]=f[g][c]=b[c]="@";f.borderColor[a]=f[g][a]=b[a]="rgb(@, @, @)"})})();(function(){Element.Properties.events={set:function(a){this.addEvents(a)}};[Element,Window,Document].invoke("implement",{addEvent:function(n,l){var k=this.retrieve("events",{});if(!k[n]){k[n]={keys:[],values:[]}}if(k[n].keys.contains(l)){return this}k[n].keys.push(l);var m=n,r=Element.Events[n],p=l,a=this;if(r){if(r.onAdd){r.onAdd.call(this,l,n)}if(r.condition){p=function(c){if(r.condition.call(this,c,n)){return l.call(this,c)}return true}}if(r.base){m=Function.from(r.base).call(this,n)}}var o=function(){return l.call(a)};var q=Element.NativeEvents[m];if(q){if(q==2){o=function(c){c=new DOMEvent(c,a.getWindow());if(p.call(a,c)===false){c.stop()}}}this.addListener(m,o,arguments[2])}k[n].values.push(o);return this},removeEvent:function(l,m){var n=this.retrieve("events");if(!n||!n[l]){return this}var i=n[l];var a=i.keys.indexOf(m);if(a==-1){return this}var j=i.values[a];delete i.keys[a];delete i.values[a];var k=Element.Events[l];if(k){if(k.onRemove){k.onRemove.call(this,m,l)}if(k.base){l=Function.from(k.base).call(this,l)}}return(Element.NativeEvents[l])?this.removeListener(l,j,arguments[2]):this},addEvents:function(a){for(var d in a){this.addEvent(d,a[d])}return this},removeEvents:function(a){var f;if(typeOf(a)=="object"){for(f in a){this.removeEvent(f,a[f])}return this}var g=this.retrieve("events");if(!g){return this}if(!a){for(f in g){this.removeEvents(f)}this.eliminate("events")}else{if(g[a]){g[a].keys.each(function(c){this.removeEvent(a,c)},this);delete g[a]}}return this},fireEvent:function(f,h,a){var g=this.retrieve("events");if(!g||!g[f]){return this}h=Array.from(h);g[f].keys.each(function(c){if(a){c.delay(a,this,h)}else{c.apply(this,h)}},this);return this},cloneEvents:function(f,g){f=document.id(f);var h=f.retrieve("events");if(!h){return this}if(!g){for(var a in h){this.cloneEvents(f,a)}}else{if(h[g]){h[g].keys.each(function(c){this.addEvent(g,c)},this)}}return this}});Element.NativeEvents={click:2,dblclick:2,mouseup:2,mousedown:2,contextmenu:2,mousewheel:2,DOMMouseScroll:2,mouseover:2,mouseout:2,mousemove:2,selectstart:2,selectend:2,keydown:2,keypress:2,keyup:2,orientationchange:2,touchstart:2,touchmove:2,touchend:2,touchcancel:2,gesturestart:2,gesturechange:2,gestureend:2,focus:2,blur:2,change:2,reset:2,select:2,submit:2,paste:2,input:2,load:2,unload:1,beforeunload:2,resize:1,move:1,DOMContentLoaded:1,readystatechange:1,error:1,abort:1,scroll:1};Element.Events={mousewheel:{base:(Browser.firefox)?"DOMMouseScroll":"mousewheel"}};if("onmouseenter" in document.documentElement){Element.NativeEvents.mouseenter=Element.NativeEvents.mouseleave=2}else{var b=function(a){var d=a.relatedTarget;if(d==null){return true}if(!d){return false}return(d!=this&&d.prefix!="xul"&&typeOf(this)!="document"&&!this.contains(d))};Element.Events.mouseenter={base:"mouseover",condition:b};Element.Events.mouseleave={base:"mouseout",condition:b}}if(!window.addEventListener){Element.NativeEvents.propertychange=2;Element.Events.change={base:function(){var a=this.type;return(this.get("tag")=="input"&&(a=="radio"||a=="checkbox"))?"propertychange":"change"},condition:function(a){return this.type!="radio"||(a.event.propertyName=="checked"&&this.checked)}}}})();(function(){var t=!!window.addEventListener;Element.NativeEvents.focusin=Element.NativeEvents.focusout=2;var l=function(b,a,f,d,c){while(c&&c!=b){if(a(c,d)){return f.call(c,d,c)}c=document.id(c.parentNode)}};var v={mouseenter:{base:"mouseover"},mouseleave:{base:"mouseout"},focus:{base:"focus"+(t?"":"in"),capture:true},blur:{base:t?"blur":"focusout",capture:true}};var u="$delegation:";var n=function(a){return{base:"focusin",remove:function(b,d){var c=b.retrieve(u+a+"listeners",{})[d];if(c&&c.forms){for(var f=c.forms.length;f--;){c.forms[f].removeEvent(a,c.fns[f])}}},listen:function(i,b,k,g,z,A){var f=(z.get("tag")=="form")?z:g.target.getParent("form");if(!f){return}var y=i.retrieve(u+a+"listeners",{}),d=y[A]||{forms:[],fns:[]},h=d.forms,j=d.fns;if(h.indexOf(f)!=-1){return}h.push(f);var c=function(w){l(i,b,k,w,z)};f.addEvent(a,c);j.push(c);y[A]=d;i.store(u+a+"listeners",y)}}};var s=function(a){return{base:"focusin",listen:function(b,h,f,d,c){var g={blur:function(){this.removeEvents(g)}};g[a]=function(i){l(b,h,f,i,c)};d.target.addEvents(g)}}};if(!t){Object.append(v,{submit:n("submit"),reset:n("reset"),change:s("change"),select:s("select")})}var o=Element.prototype,q=o.addEvent,m=o.removeEvent;var r=function(b,a){return function(c,d,h){if(c.indexOf(":relay")==-1){return b.call(this,c,d,h)}var g=Slick.parse(c).expressions[0][0];if(g.pseudos[0].key!="relay"){return b.call(this,c,d,h)}var f=g.tag;g.pseudos.slice(1).each(function(i){f+=":"+i.key+(i.value?"("+i.value+")":"")});b.call(this,c,d);return a.call(this,f,g.pseudos[0].value,d)}};var p={addEvent:function(D,b,B){var F=this.retrieve("$delegates",{}),a=F[D];if(a){for(var k in a){if(a[k].fn==B&&a[k].match==b){return this}}}var c=D,E=b,f=B,g=v[D]||{};D=g.base||c;b=function(w){return Slick.match(w,E)};var C=Element.Events[c];if(C&&C.condition){var i=b,h=C.condition;b=function(w,x){return i(w,x)&&h.call(w,x,D)}}var j=this,G=String.uniqueID();var d=g.listen?function(x,w){if(!w&&x&&x.target){w=x.target}if(w){g.listen(j,b,B,x,w,G)}}:function(x,w){if(!w&&x&&x.target){w=x.target}if(w){l(j,b,B,x,w)}};if(!a){a={}}a[G]={match:E,fn:f,delegator:d};F[c]=a;return q.call(this,D,d,g.capture)},removeEvent:function(a,f,x,k){var b=this.retrieve("$delegates",{}),c=b[a];if(!c){return this}if(k){var g=a,i=c[k].delegator,h=v[a]||{};a=h.base||g;if(h.remove){h.remove(this,k)}delete c[k];b[g]=c;return m.call(this,a,i)}var d,j;if(x){for(d in c){j=c[d];if(j.match==f&&j.fn==x){return p.removeEvent.call(this,a,f,x,d)}}}else{for(d in c){j=c[d];if(j.match==f){p.removeEvent.call(this,a,f,j.fn,d)}}}return this}};[Element,Window,Document].invoke("implement",{addEvent:r(q,p.addEvent),removeEvent:r(m,p.removeEvent)})})();(function(){var q=document.createElement("div"),t=document.createElement("div");q.style.height="0";q.appendChild(t);var u=(t.offsetParent===q);q=t=null;var m=function(a){return n(a,"position")!="static"||x(a)};var p=function(a){return m(a)||(/^(?:table|td|th)$/i).test(a.tagName)};Element.implement({scrollTo:function(a,b){if(x(this)){this.getWindow().scrollTo(a,b)}else{this.scrollLeft=a;this.scrollTop=b}return this},getSize:function(){if(x(this)){return this.getWindow().getSize()}return{x:this.offsetWidth,y:this.offsetHeight}},getScrollSize:function(){if(x(this)){return this.getWindow().getScrollSize()}return{x:this.scrollWidth,y:this.scrollHeight}},getScroll:function(){if(x(this)){return this.getWindow().getScroll()}return{x:this.scrollLeft,y:this.scrollTop}},getScrolls:function(){var b=this.parentNode,a={x:0,y:0};while(b&&!x(b)){a.x+=b.scrollLeft;a.y+=b.scrollTop;b=b.parentNode}return a},getOffsetParent:u?function(){var a=this;if(x(a)||n(a,"position")=="fixed"){return null}var b=(n(a,"position")=="static")?p:m;while((a=a.parentNode)){if(b(a)){return a}}return null}:function(){var a=this;if(x(a)||n(a,"position")=="fixed"){return null}try{return a.offsetParent}catch(b){}return null},getOffsets:function(){if(this.getBoundingClientRect&&!Browser.Platform.ios){var d=this.getBoundingClientRect(),h=document.id(this.getDocument().documentElement),f=h.getScroll(),b=this.getScrolls(),c=(n(this,"position")=="fixed");return{x:d.left.toInt()+b.x+((c)?0:f.x)-h.clientLeft,y:d.top.toInt()+b.y+((c)?0:f.y)-h.clientTop}}var i=this,a={x:0,y:0};if(x(this)){return a}while(i&&!x(i)){a.x+=i.offsetLeft;a.y+=i.offsetTop;if(Browser.firefox){if(!v(i)){a.x+=w(i);a.y+=r(i)}var g=i.parentNode;if(g&&n(g,"overflow")!="visible"){a.x+=w(g);a.y+=r(g)}}else{if(i!=this&&Browser.safari){a.x+=w(i);a.y+=r(i)}}i=i.offsetParent}if(Browser.firefox&&!v(this)){a.x-=w(this);a.y-=r(this)}return a},getPosition:function(c){var b=this.getOffsets(),f=this.getScrolls();var a={x:b.x-f.x,y:b.y-f.y};if(c&&(c=document.id(c))){var d=c.getPosition();return{x:a.x-d.x-w(c),y:a.y-d.y-r(c)}}return a},getCoordinates:function(c){if(x(this)){return this.getWindow().getCoordinates()}var a=this.getPosition(c),d=this.getSize();var b={left:a.x,top:a.y,width:d.x,height:d.y};b.right=b.left+b.width;b.bottom=b.top+b.height;return b},computePosition:function(a){return{left:a.x-o(this,"margin-left"),top:a.y-o(this,"margin-top")}},setPosition:function(a){return this.setStyles(this.computePosition(a))}});[Document,Window].invoke("implement",{getSize:function(){var a=s(this);return{x:a.clientWidth,y:a.clientHeight}},getScroll:function(){var b=this.getWindow(),a=s(this);return{x:b.pageXOffset||a.scrollLeft,y:b.pageYOffset||a.scrollTop}},getScrollSize:function(){var b=s(this),c=this.getSize(),a=this.getDocument().body;return{x:Math.max(b.scrollWidth,a.scrollWidth,c.x),y:Math.max(b.scrollHeight,a.scrollHeight,c.y)}},getPosition:function(){return{x:0,y:0}},getCoordinates:function(){var a=this.getSize();return{top:0,left:0,bottom:a.y,right:a.x,height:a.y,width:a.x}}});var n=Element.getComputedStyle;function o(a,b){return n(a,b).toInt()||0}function v(a){return n(a,"-moz-box-sizing")=="border-box"}function r(a){return o(a,"border-top-width")}function w(a){return o(a,"border-left-width")}function x(a){return(/^(?:body|html)$/i).test(a.tagName)}function s(a){var b=a.getDocument();return(!b.compatMode||b.compatMode=="CSS1Compat")?b.html:b.body}})();Element.alias({position:"setPosition"});[Window,Document,Element].invoke("implement",{getHeight:function(){return this.getSize().y},getWidth:function(){return this.getSize().x},getScrollTop:function(){return this.getScroll().y},getScrollLeft:function(){return this.getScroll().x},getScrollHeight:function(){return this.getScrollSize().y},getScrollWidth:function(){return this.getScrollSize().x},getTop:function(){return this.getPosition().y},getLeft:function(){return this.getPosition().x}});(function(){var i=this.Fx=new Class({Implements:[Chain,Events,Options],options:{fps:60,unit:false,duration:500,frames:null,frameSkip:true,link:"ignore"},initialize:function(a){this.subject=this.subject||this;this.setOptions(a)},getTransition:function(){return function(a){return -(Math.cos(Math.PI*a)-1)/2}},step:function(d){if(this.options.frameSkip){var c=(this.time!=null)?(d-this.time):0,b=c/this.frameInterval;this.time=d;this.frame+=b}else{this.frame++}if(this.frame<this.frames){var a=this.transition(this.frame/this.frames);this.set(this.compute(this.from,this.to,a))}else{this.frame=this.frames;this.set(this.compute(this.from,this.to,1));this.stop()}},set:function(a){return a},compute:function(a,b,c){return i.compute(a,b,c)},check:function(){if(!this.isRunning()){return true}switch(this.options.link){case"cancel":this.cancel();return true;case"chain":this.chain(this.caller.pass(arguments,this));return false}return false},start:function(a,b){if(!this.check(a,b)){return this}this.from=a;this.to=b;this.frame=(this.options.frameSkip)?0:-1;this.time=null;this.transition=this.getTransition();var c=this.options.frames,d=this.options.fps,f=this.options.duration;this.duration=i.Durations[f]||f.toInt();this.frameInterval=1000/d;this.frames=c||Math.round(this.duration/this.frameInterval);this.fireEvent("start",this.subject);g.call(this,d);return this},stop:function(){if(this.isRunning()){this.time=null;k.call(this,this.options.fps);if(this.frames==this.frame){this.fireEvent("complete",this.subject);if(!this.callChain()){this.fireEvent("chainComplete",this.subject)}}else{this.fireEvent("stop",this.subject)}}return this},cancel:function(){if(this.isRunning()){this.time=null;k.call(this,this.options.fps);this.frame=this.frames;this.fireEvent("cancel",this.subject).clearChain()}return this},pause:function(){if(this.isRunning()){this.time=null;k.call(this,this.options.fps)}return this},resume:function(){if((this.frame<this.frames)&&!this.isRunning()){g.call(this,this.options.fps)}return this},isRunning:function(){var a=j[this.options.fps];return a&&a.contains(this)}});i.compute=function(a,b,c){return(b-a)*c+a};i.Durations={"short":250,normal:500,"long":1000};var j={},l={};var h=function(){var b=Date.now();for(var a=this.length;a--;){var c=this[a];if(c){c.step(b)}}};var g=function(a){var b=j[a]||(j[a]=[]);b.push(this);if(!l[a]){l[a]=h.periodical(Math.round(1000/a),b)}};var k=function(a){var b=j[a];if(b){b.erase(this);if(!b.length&&l[a]){delete j[a];l[a]=clearInterval(l[a])}}}})();Fx.CSS=new Class({Extends:Fx,prepare:function(i,n,j){j=Array.from(j);var k=j[0],l=j[1];if(l==null){l=k;k=i.getStyle(n);var p=this.options.unit;if(p&&k.slice(-p.length)!=p&&parseFloat(k)!=0){i.setStyle(n,l+p);var o=i.getComputedStyle(n);if(!(/px$/.test(o))){o=i.style[("pixel-"+n).camelCase()];if(o==null){var m=i.style.left;i.style.left=l+p;o=i.style.pixelLeft;i.style.left=m}}k=(l||1)/(parseFloat(o)||1)*(parseFloat(k)||0);i.setStyle(n,k+p)}}return{from:this.parse(k),to:this.parse(l)}},parse:function(b){b=Function.from(b)();b=(typeof b=="string")?b.split(" "):Array.from(b);return b.map(function(d){d=String(d);var a=false;Object.each(Fx.CSS.Parsers,function(c,g){if(a){return}var h=c.parse(d);if(h||h===0){a={value:h,parser:c}}});a=a||{value:d,parser:Fx.CSS.Parsers.String};return a})},compute:function(h,i,f){var g=[];(Math.min(h.length,i.length)).times(function(a){g.push({value:h[a].parser.compute(h[a].value,i[a].value,f),parser:h[a].parser})});g.$family=Function.from("fx:css:value");return g},serve:function(g,d){if(typeOf(g)!="fx:css:value"){g=this.parse(g)}var f=[];g.each(function(a){f=f.concat(a.parser.serve(a.value,d))});return f},render:function(g,h,i,f){g.setStyle(h,this.serve(i,f))},search:function(f){if(Fx.CSS.Cache[f]){return Fx.CSS.Cache[f]}var g={},d=new RegExp("^"+f.escapeRegExp()+"$");Array.each(document.styleSheets,function(b,c){var h=b.href;if(h&&h.contains("://")&&!h.contains(document.domain)){return}var a=b.rules||b.cssRules;Array.each(a,function(i,m){if(!i.style){return}var l=(i.selectorText)?i.selectorText.replace(/^\w+/,function(j){return j.toLowerCase()}):null;if(!l||!d.test(l)){return}Object.each(Element.Styles,function(j,k){if(!i.style[k]||Element.ShortStyles[k]){return}j=String(i.style[k]);g[k]=((/^rgb/).test(j))?j.rgbToHex():j})})});return Fx.CSS.Cache[f]=g}});Fx.CSS.Cache={};Fx.CSS.Parsers={Color:{parse:function(b){if(b.match(/^#[0-9a-f]{3,6}$/i)){return b.hexToRgb(true)}return((b=b.match(/(\d+),\s*(\d+),\s*(\d+)/)))?[b[1],b[2],b[3]]:false},compute:function(g,d,f){return g.map(function(a,b){return Math.round(Fx.compute(g[b],d[b],f))})},serve:function(b){return b.map(Number)}},Number:{parse:parseFloat,compute:Fx.compute,serve:function(c,d){return(d)?c+d:c}},String:{parse:Function.from(false),compute:function(c,d){return d},serve:function(b){return b}}};Fx.Tween=new Class({Extends:Fx.CSS,initialize:function(c,d){this.element=this.subject=document.id(c);this.parent(d)},set:function(c,d){if(arguments.length==1){d=c;c=this.property||this.options.property}this.render(this.element,c,d,this.options.unit);return this},start:function(j,h,i){if(!this.check(j,h,i)){return this}var f=Array.flatten(arguments);this.property=this.options.property||f.shift();var g=this.prepare(this.element,this.property,f);return this.parent(g.from,g.to)}});Element.Properties.tween={set:function(b){this.get("tween").cancel().setOptions(b);return this},get:function(){var b=this.retrieve("tween");if(!b){b=new Fx.Tween(this,{link:"cancel"});this.store("tween",b)}return b}};Element.implement({tween:function(f,g,d){this.get("tween").start(f,g,d);return this},fade:function(m){var l=this.get("tween"),j,n=["opacity"].append(arguments),i;if(n[1]==null){n[1]="toggle"}switch(n[1]){case"in":j="start";n[1]=1;break;case"out":j="start";n[1]=0;break;case"show":j="set";n[1]=1;break;case"hide":j="set";n[1]=0;break;case"toggle":var h=this.retrieve("fade:flag",this.getStyle("opacity")==1);j="start";n[1]=h?0:1;this.store("fade:flag",!h);i=true;break;default:j="start"}if(!i){this.eliminate("fade:flag")}l[j].apply(l,n);var k=n[n.length-1];if(j=="set"||k!=0){this.setStyle("visibility",k==0?"hidden":"visible")}else{l.chain(function(){this.element.setStyle("visibility","hidden");this.callChain()})}return this},highlight:function(g,f){if(!f){f=this.retrieve("highlight:original",this.getStyle("background-color"));f=(f=="transparent")?"#fff":f}var d=this.get("tween");d.start("background-color",g||"#ffff88",f).chain(function(){this.setStyle("background-color",this.retrieve("highlight:original"));d.callChain()}.bind(this));return this}});Fx.Morph=new Class({Extends:Fx.CSS,initialize:function(c,d){this.element=this.subject=document.id(c);this.parent(d)},set:function(d){if(typeof d=="string"){d=this.search(d)}for(var c in d){this.render(this.element,c,d[c],this.options.unit)}return this},compute:function(h,i,j){var g={};for(var f in h){g[f]=this.parent(h[f],i[f],j)}return g},start:function(f){if(!this.check(f)){return this}if(typeof f=="string"){f=this.search(f)}var h={},i={};for(var j in f){var g=this.prepare(this.element,j,f[j]);h[j]=g.from;i[j]=g.to}return this.parent(h,i)}});Element.Properties.morph={set:function(b){this.get("morph").cancel().setOptions(b);return this},get:function(){var b=this.retrieve("morph");if(!b){b=new Fx.Morph(this,{link:"cancel"});this.store("morph",b)}return b}};Element.implement({morph:function(b){this.get("morph").start(b);return this}});Fx.implement({getTransition:function(){var d=this.options.transition||Fx.Transitions.Sine.easeInOut;if(typeof d=="string"){var c=d.split(":");d=Fx.Transitions;d=d[c[0]]||d[c[0].capitalize()];if(c[1]){d=d["ease"+c[1].capitalize()+(c[2]?c[2].capitalize():"")]}}return d}});Fx.Transition=function(g,d){d=Array.from(d);var f=function(a){return g(a,d)};return Object.append(f,{easeIn:f,easeOut:function(a){return 1-g(1-a,d)},easeInOut:function(a){return(a<=0.5?g(2*a,d):(2-g(2*(1-a),d)))/2}})};Fx.Transitions={linear:function(b){return b}};Fx.Transitions.extend=function(d){for(var c in d){Fx.Transitions[c]=new Fx.Transition(d[c])}};Fx.Transitions.extend({Pow:function(c,d){return Math.pow(c,d&&d[0]||6)},Expo:function(b){return Math.pow(2,8*(b-1))},Circ:function(b){return 1-Math.sin(Math.acos(b))},Sine:function(b){return 1-Math.cos(b*Math.PI/2)},Back:function(c,d){d=d&&d[0]||1.618;return Math.pow(c,2)*((d+1)*c-d)},Bounce:function(a){var b;for(var g=0,h=1;1;g+=h,h/=2){if(a>=(7-4*g)/11){b=h*h-Math.pow((11-6*g-11*a)/4,2);break}}return b},Elastic:function(c,d){return Math.pow(2,10*--c)*Math.cos(20*c*Math.PI*(d&&d[0]||1)/3)}});["Quad","Cubic","Quart","Quint"].each(function(c,d){Fx.Transitions[c]=new Fx.Transition(function(a){return Math.pow(a,d+2)})});(function(){var h=function(){},g=("onprogress" in new Browser.Request);var i=this.Request=new Class({Implements:[Chain,Events,Options],options:{url:"",data:"",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"text/javascript, text/html, application/xml, text/xml, */*"},async:true,format:false,method:"post",link:"ignore",isSuccess:null,emulation:true,urlEncoded:true,encoding:"utf-8",evalScripts:false,evalResponse:false,timeout:0,noCache:false},initialize:function(a){this.xhr=new Browser.Request();this.setOptions(a);this.headers=this.options.headers},onStateChange:function(){var a=this.xhr;if(a.readyState!=4||!this.running){return}this.running=false;this.status=0;Function.attempt(function(){var b=a.status;this.status=(b==1223)?204:b}.bind(this));a.onreadystatechange=h;if(g){a.onprogress=a.onloadstart=h}clearTimeout(this.timer);this.response={text:this.xhr.responseText||"",xml:this.xhr.responseXML};if(this.options.isSuccess.call(this,this.status)){this.success(this.response.text,this.response.xml)}else{this.failure()}},isSuccess:function(){var a=this.status;return(a>=200&&a<300)},isRunning:function(){return !!this.running},processScripts:function(a){if(this.options.evalResponse||(/(ecma|java)script/).test(this.getHeader("Content-type"))){return Browser.exec(a)}return a.stripScripts(this.options.evalScripts)},success:function(a,b){this.onSuccess(this.processScripts(a),b)},onSuccess:function(){this.fireEvent("complete",arguments).fireEvent("success",arguments).callChain()},failure:function(){this.onFailure()},onFailure:function(){this.fireEvent("complete").fireEvent("failure",this.xhr)},loadstart:function(a){this.fireEvent("loadstart",[a,this.xhr])},progress:function(a){this.fireEvent("progress",[a,this.xhr])},timeout:function(){this.fireEvent("timeout",this.xhr)},setHeader:function(b,a){this.headers[b]=a;return this},getHeader:function(a){return Function.attempt(function(){return this.xhr.getResponseHeader(a)}.bind(this))},check:function(){if(!this.running){return true}switch(this.options.link){case"cancel":this.cancel();return true;case"chain":this.chain(this.caller.pass(arguments,this));return false}return false},send:function(a){if(!this.check(a)){return this}this.options.isSuccess=this.options.isSuccess||this.isSuccess;this.running=true;var d=typeOf(a);if(d=="string"||d=="element"){a={data:a}}var s=this.options;a=Object.append({data:s.data,url:s.url,method:s.method},a);var q=a.data,u=String(a.url),v=a.method.toLowerCase();switch(typeOf(q)){case"element":q=document.id(q).toQueryString();break;case"object":case"hash":q=Object.toQueryString(q)}if(this.options.format){var c="format="+this.options.format;q=(q)?c+"&"+q:c}if(this.options.emulation&&!["get","post"].contains(v)){var p="_method="+v;q=(q)?p+"&"+q:p;v="post"}if(this.options.urlEncoded&&["post","put"].contains(v)){var t=(this.options.encoding)?"; charset="+this.options.encoding:"";this.headers["Content-type"]="application/x-www-form-urlencoded"+t}if(!u){u=document.location.pathname}var r=u.lastIndexOf("/");if(r>-1&&(r=u.indexOf("#"))>-1){u=u.substr(0,r)}if(this.options.noCache){u+=(u.contains("?")?"&":"?")+String.uniqueID()}if(q&&v=="get"){u+=(u.contains("?")?"&":"?")+q;q=null}var b=this.xhr;if(g){b.onloadstart=this.loadstart.bind(this);b.onprogress=this.progress.bind(this)}b.open(v.toUpperCase(),u,this.options.async,this.options.user,this.options.password);if(this.options.user&&"withCredentials" in b){b.withCredentials=true}b.onreadystatechange=this.onStateChange.bind(this);Object.each(this.headers,function(k,l){try{b.setRequestHeader(l,k)}catch(j){this.fireEvent("exception",[l,k])}},this);this.fireEvent("request");b.send(q);if(!this.options.async){this.onStateChange()}else{if(this.options.timeout){this.timer=this.timeout.delay(this.options.timeout,this)}}return this},cancel:function(){if(!this.running){return this}this.running=false;var a=this.xhr;a.abort();clearTimeout(this.timer);a.onreadystatechange=h;if(g){a.onprogress=a.onloadstart=h}this.xhr=new Browser.Request();this.fireEvent("cancel");return this}});var f={};["get","post","put","delete","GET","POST","PUT","DELETE"].each(function(a){f[a]=function(b){var c={method:a};if(b!=null){c.data=b}return this.send(c)}});i.implement(f);Element.Properties.send={set:function(b){var a=this.get("send").cancel();a.setOptions(b);return this},get:function(){var a=this.retrieve("send");if(!a){a=new i({data:this,link:"cancel",method:this.get("method")||"post",url:this.get("action")});this.store("send",a)}return a}};Element.implement({send:function(b){var a=this.get("send");a.send({data:this,url:b||a.options.url});return this}})})();Request.HTML=new Class({Extends:Request,options:{update:false,append:false,evalScripts:true,filter:false,headers:{Accept:"text/html, application/xml, text/xml, */*"}},success:function(k){var l=this.options,n=this.response;n.html=k.stripScripts(function(a){n.javascript=a});var m=n.html.match(/<body[^>]*>([\s\S]*?)<\/body>/i);if(m){n.html=m[1]}var h=new Element("div").set("html",n.html);n.tree=h.childNodes;n.elements=h.getElements(l.filter||"*");if(l.filter){n.tree=n.elements}if(l.update){var j=document.id(l.update).empty();if(l.filter){j.adopt(n.elements)}else{j.set("html",n.html)}}else{if(l.append){var i=document.id(l.append);if(l.filter){n.elements.reverse().inject(i)}else{i.adopt(h.getChildren())}}}if(l.evalScripts){Browser.exec(n.javascript)}this.onSuccess(n.tree,n.elements,n.html,n.javascript)}});Element.Properties.load={set:function(d){var c=this.get("load").cancel();c.setOptions(d);return this},get:function(){var b=this.retrieve("load");if(!b){b=new Request.HTML({data:this,link:"cancel",update:this,method:"get"});this.store("load",b)}return b}};Element.implement({load:function(){this.get("load").send(Array.link(arguments,{data:Type.isObject,url:Type.isString}));return this}});if(typeof JSON=="undefined"){this.JSON={}}(function(){var special={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};var escape=function(chr){return special[chr]||"\\u"+("0000"+chr.charCodeAt(0).toString(16)).slice(-4)};JSON.validate=function(string){string=string.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"");return(/^[\],:{}\s]*$/).test(string)};JSON.encode=JSON.stringify?function(obj){return JSON.stringify(obj)}:function(obj){if(obj&&obj.toJSON){obj=obj.toJSON()}switch(typeOf(obj)){case"string":return'"'+obj.replace(/[\x00-\x1f\\"]/g,escape)+'"';case"array":return"["+obj.map(JSON.encode).clean()+"]";case"object":case"hash":var string=[];Object.each(obj,function(value,key){var json=JSON.encode(value);if(json){string.push(JSON.encode(key)+":"+json)}});return"{"+string+"}";case"number":case"boolean":return""+obj;case"null":return"null"}return null};JSON.decode=function(string,secure){if(!string||typeOf(string)!="string"){return null}if(secure||JSON.secure){if(JSON.parse){return JSON.parse(string)}if(!JSON.validate(string)){throw new Error("JSON could not decode the input; security is enabled and the value is not secure.")}}return eval("("+string+")")}})();Request.JSON=new Class({Extends:Request,options:{secure:true},initialize:function(b){this.parent(b);Object.append(this.headers,{Accept:"application/json","X-Request":"JSON"})},success:function(g){var d;try{d=this.response.json=JSON.decode(g,this.options.secure)}catch(f){this.fireEvent("error",[g,f]);return}if(d==null){this.onFailure()}else{this.onSuccess(d,g)}}});var Cookie=new Class({Implements:Options,options:{path:"/",domain:false,duration:false,secure:false,document:document,encode:true},initialize:function(c,d){this.key=c;this.setOptions(d)},write:function(c){if(this.options.encode){c=encodeURIComponent(c)}if(this.options.domain){c+="; domain="+this.options.domain}if(this.options.path){c+="; path="+this.options.path}if(this.options.duration){var d=new Date();d.setTime(d.getTime()+this.options.duration*24*60*60*1000);c+="; expires="+d.toGMTString()}if(this.options.secure){c+="; secure"}this.options.document.cookie=this.key+"="+c;return this},read:function(){var b=this.options.document.cookie.match("(?:^|;)\\s*"+this.key.escapeRegExp()+"=([^;]*)");return(b)?decodeURIComponent(b[1]):null},dispose:function(){new Cookie(this.key,Object.merge({},this.options,{duration:-1})).write("");return this}});Cookie.write=function(d,g,f){return new Cookie(d,f).write(g)};Cookie.read=function(b){return new Cookie(b).read()};Cookie.dispose=function(c,d){return new Cookie(c,d).dispose()};(function(p,n){var m,s,t=[],v,w,u=n.createElement("div");var r=function(){clearTimeout(w);if(m){return}Browser.loaded=m=true;n.removeListener("DOMContentLoaded",r).removeListener("readystatechange",x);n.fireEvent("domready");p.fireEvent("domready")};var x=function(){for(var a=t.length;a--;){if(t[a]()){r();return true}}return false};var o=function(){clearTimeout(w);if(!x()){w=setTimeout(o,10)}};n.addListener("DOMContentLoaded",r);var q=function(){try{u.doScroll();return true}catch(a){}return false};if(u.doScroll&&!q()){t.push(q);v=true}if(n.readyState){t.push(function(){var a=n.readyState;return(a=="loaded"||a=="complete")})}if("onreadystatechange" in n){n.addListener("readystatechange",x)}else{v=true}if(v){o()}Element.Events.domready={onAdd:function(a){if(m){a.call(this)}}};Element.Events.load={base:"load",onAdd:function(a){if(s&&this==p){a.call(this)}},condition:function(){if(this==p){r();delete Element.Events.load}return true}};p.addEvent("load",function(){s=true})})(window,document);(function(){var Swiff=this.Swiff=new Class({Implements:Options,options:{id:null,height:1,width:1,container:null,properties:{},params:{quality:"high",allowScriptAccess:"always",wMode:"window",swLiveConnect:true},callBacks:{},vars:{}},toElement:function(){return this.object},initialize:function(path,options){this.instance="Swiff_"+String.uniqueID();this.setOptions(options);options=this.options;var id=this.id=options.id||this.instance;var container=document.id(options.container);Swiff.CallBacks[this.instance]={};var params=options.params,vars=options.vars,callBacks=options.callBacks;var properties=Object.append({height:options.height,width:options.width},options.properties);var self=this;for(var callBack in callBacks){Swiff.CallBacks[this.instance][callBack]=(function(option){return function(){return option.apply(self.object,arguments)}})(callBacks[callBack]);vars[callBack]="Swiff.CallBacks."+this.instance+"."+callBack}params.flashVars=Object.toQueryString(vars);if(Browser.ie){properties.classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000";params.movie=path}else{properties.type="application/x-shockwave-flash"}properties.data=path;var build='<object id="'+id+'"';for(var property in properties){build+=" "+property+'="'+properties[property]+'"'}build+=">";for(var param in params){if(params[param]){build+='<param name="'+param+'" value="'+params[param]+'" />'}}build+="</object>";this.object=((container)?container.empty():new Element("div")).set("html",build).firstChild},replaces:function(element){element=document.id(element,true);element.parentNode.replaceChild(this.toElement(),element);return this},inject:function(element){document.id(element,true).appendChild(this.toElement());return this},remote:function(){return Swiff.remote.apply(Swiff,[this.toElement()].append(arguments))}});Swiff.CallBacks={};Swiff.remote=function(obj,fn){var rs=obj.CallFunction('<invoke name="'+fn+'" returntype="javascript">'+__flash__argumentsToXML(arguments,2)+"</invoke>");return eval(rs)}})();
/*!
@preserve
Copyright (c) 2011 Sencha Labs - Author: Nicolas Garcia Belmonte (http://philogb.github.com/)

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

*/
(function(){this.PhiloGL=null;(function(){PhiloGL=function(g,f){f=a.merge({context:{},camera:{fov:45,near:0.1,far:500},program:{from:"defaults",vs:"Default",fs:"Default"},scene:{},textures:{src:[]},events:{},onLoad:a.empty,onError:a.empty},f||{});var o=f.context,l=f.camera,q=f.events,m=f.textures,j=a.splat(f.program),k=f.scene;d=PhiloGL.WebGL.getContext(g,o);if(!d){f.onError("The WebGL context couldn't been initialized");return null}var p={defaults:"fromDefaultShaders",ids:"fromShaderIds",sources:"fromShaderSources",uris:"fromShaderURIs"};var h=j.length,i=(function(){var s=h,t={},r=false;return{onSuccess:function(u,v){t[v.id||(h-s)]=u;s--;if(s===0&&!r){n(d,h==1?u:t,function(w){f.onLoad(w)})}},onError:function(u){s--;f.onError(u);r=true}}})();j.forEach(function(u,t){var r=u.from,s;for(var w in p){if(r==w){try{s=PhiloGL.Program[p[w]](a.extend(i,u))}catch(v){i.onError(v)}break}}if(s){i.onSuccess(s,u)}});function n(v,r,w){var s=v.canvas,t=new PhiloGL.Camera(l.fov,l.aspect||(s.width/s.height),l.near,l.far,l);t.update();var u=new PhiloGL.Scene(r,t,k);c=new PhiloGL.WebGL.Application({gl:v,canvas:s,program:r,scene:u,camera:t});if(r.$$family=="program"){r.use()}if(q){PhiloGL.Events.create(c,a.extend(q,{bind:c}))}if(m.src.length){new PhiloGL.IO.Textures(a.extend(m,{onComplete:function(){w(c)}}))}else{w(c)}}}})();PhiloGL.unpack=function(f){f=f||b;["Vec3","Mat4","Quat","Camera","Program","WebGL","O3D","Scene","Shaders","IO","Events","WorkerGroup","Fx","Media"].forEach(function(g){f[g]=PhiloGL[g]});f.gl=d;f.Utils=a};PhiloGL.version="1.5.2";var d,c,b=this;function a(f){return document.getElementById(f)}a.empty=function(){};a.time=Date.now;a.uid=(function(){var f=a.time();return function(){return f++}})();a.extend=function(h,g){for(var f in g){h[f]=g[f]}return h};a.type=(function(){var g=Object.prototype.toString,f=function(i){var h=g.call(i);return h.substr(8,h.length-9).toLowerCase()};return function(h){var i=f(h);if(i!="object"){return i}if(h.$$family){return h.$$family}return(h&&h.nodeName&&h.nodeType==1)?"element":i}})();(function(){function f(m){var k=a.type(m),h;if(k=="object"){h={};for(var n in m){h[n]=f(m[n])}return h}else{if(k=="array"){h=[];for(var j=0,g=m.length;j<g;j++){h[j]=f(m[j])}return h}else{return m}}}a.merge=function(){var m={};for(var k=0,g=arguments.length;k<g;k++){var h=arguments[k];if(a.type(h)!="object"){continue}for(var j in h){var o=h[j],n=m[j];if(n&&a.type(o)=="object"&&a.type(n)=="object"){m[j]=a.merge(n,o)}else{m[j]=f(o)}}}return m}})();a.splat=(function(){var f=Array.isArray;return function(g){return f(g)&&g||[g]}})();(function(){var f={getContext:function(j,k){var j=typeof j=="string"?a(j):j,i;i=j.getContext("experimental-webgl",k);if(!i){i=j.getContext("webgl",k)}if(i&&k&&k.debug){d={};for(var h in i){var l=i[h];if(typeof l=="function"){d[h]=(function(n,m){return function(){console.log(n,Array.prototype.join.call(arguments),Array.prototype.slice.call(arguments));try{var o=m.apply(i,arguments)}catch(r){throw n+" "+r}var q=[],p;while((p=i.getError())!==i.NO_ERROR){q.push(p)}if(q.length){throw q.join()}return o}})(h,l)}else{d[h]=l}}}else{d=i}if(d){d.get=function(m){return typeof m=="string"?d[m]:m}}return d}};function g(h){for(var i in h){this[i]=h[i]}this.buffers={};this.bufferMemo={};this.frameBuffers={};this.frameBufferMemo={};this.renderBuffers={};this.renderBufferMemo={};this.textures={};this.textureMemo={}}g.prototype={$$family:"application",setBuffer:function(o,i,j){if(j===false||j===null){j=this.bufferMemo[i];if(j){d.bindBuffer(j.bufferType,null)}var q=j&&j.attribute||i,p=o.attributes[q];if(p!==undefined){d.disableVertexAttribArray(p)}return}j=a.extend(this.bufferMemo[i]||{bufferType:d.ARRAY_BUFFER,size:1,dataType:d.FLOAT,stride:0,offset:0,drawType:d.STATIC_DRAW},j||{});var q=j.attribute||i,t=j.bufferType,n=i in this.buffers,m=n?this.buffers[i]:d.createBuffer(),v="value" in j,s=j.value,w=j.size,r=j.dataType,h=j.stride,l=j.offset,k=j.drawType,p=o.attributes[q],u=p!==undefined;if(!n){this.buffers[i]=m}if(u){d.enableVertexAttribArray(p)}d.bindBuffer(t,m);if(v){d.bufferData(t,s,k)}if(u){d.vertexAttribPointer(p,w,r,false,h,l)}delete j.value;this.bufferMemo[i]=j;if(u){this.bufferMemo[q]=j}return this},setBuffers:function(h,j){for(var i in j){this.setBuffer(h,i,j[i])}return this},setFrameBuffer:function(h,i){if(typeof i!="object"){d.bindFramebuffer(d.FRAMEBUFFER,i?this.frameBuffers[h]:null);return}i=a.merge(this.frameBufferMemo[h]||{width:0,height:0,bindToTexture:false,textureOptions:{attachment:d.COLOR_ATTACHMENT0},bindToRenderBuffer:false,renderBufferOptions:{attachment:d.DEPTH_ATTACHMENT}},i||{});var l=i.bindToTexture,p=i.bindToRenderBuffer,m=h in this.frameBuffers,q=m?this.frameBuffers[h]:d.createFramebuffer();d.bindFramebuffer(d.FRAMEBUFFER,q);if(!m){this.frameBuffers[h]=q}if(l){var k=a.merge({data:{width:i.width,height:i.height}},a.type(l)=="object"?l:{}),s=h+"-texture",n=i.textureOptions;this.setTexture(s,k);d.framebufferTexture2D(d.FRAMEBUFFER,n.attachment,this.textureMemo[s].textureType,this.textures[s],0)}if(p){var j=a.extend({width:i.width,height:i.height},a.type(p)=="object"?p:{}),r=h+"-renderbuffer",o=i.renderBufferOptions;this.setRenderBuffer(r,j);d.framebufferRenderbuffer(d.FRAMEBUFFER,o.attachment,d.RENDERBUFFER,this.renderBuffers[r])}d.bindTexture(d.TEXTURE_2D,null);d.bindRenderbuffer(d.RENDERBUFFER,null);d.bindFramebuffer(d.FRAMEBUFFER,null);this.frameBufferMemo[h]=i;return this},setFrameBuffers:function(i){for(var h in i){this.setFrameBuffer(h,i[h])}return this},setRenderBuffer:function(i,j){if(typeof j!="object"){d.bindRenderbuffer(d.RENDERBUFFER,j?this.renderBufferMemo[i]:null);return}j=a.extend(this.renderBufferMemo[i]||{storageType:d.DEPTH_COMPONENT16,width:0,height:0},j||{});var k=i in this.renderBuffers,h=k?this.renderBuffers[i]:d.createRenderbuffer(d.RENDERBUFFER);if(!k){this.renderBuffers[i]=h}d.bindRenderbuffer(d.RENDERBUFFER,h);d.renderbufferStorage(d.RENDERBUFFER,j.storageType,j.width,j.height);this.renderBufferMemo[i]=j;return this},setRenderBuffers:function(i){for(var h in i){this.setRenderBuffer(h,i[h])}return this},setTexture:function(h,j){if(!j||typeof j!="object"){d.activeTexture(j||d.TEXTURE0);d.bindTexture(this.textureMemo[h].textureType||d.TEXTURE_2D,this.textures[h]);return}if(j.data&&j.data.type===d.FLOAT){if(!d.getExtension("OES_texture_float")){throw"OES_texture_float is not supported"}}j=a.merge(this.textureMemo[h]||{textureType:d.TEXTURE_2D,pixelStore:[{name:d.UNPACK_FLIP_Y_WEBGL,value:true},{name:d.UNPACK_ALIGNMENT,value:1}],parameters:[{name:d.TEXTURE_MAG_FILTER,value:d.NEAREST},{name:d.TEXTURE_MIN_FILTER,value:d.NEAREST},{name:d.TEXTURE_WRAP_S,value:d.CLAMP_TO_EDGE},{name:d.TEXTURE_WRAP_T,value:d.CLAMP_TO_EDGE}],data:{format:d.RGBA,value:false,type:d.UNSIGNED_BYTE,width:0,height:0,border:0}},j||{});var v=("textureType" in j)?j.textureType=d.get(j.textureType):d.TEXTURE_2D,u=("textureTarget" in j)?j.textureTarget=d.get(j.textureTarget):v,r=v==d.TEXTURE_CUBE_MAP,l=h in this.textures,p=l?this.textures[h]:d.createTexture(),k=j.pixelStore,w=j.parameters,n=j.data,t=n.value,q=n.type,s=n.format,x=!!n.value;if(!l){this.textures[h]=p}d.bindTexture(v,p);if(!l){k.forEach(function(i){i.name=typeof i.name=="string"?d.get(i.name):i.name;d.pixelStorei(i.name,i.value)})}if(x){if(r){for(var m=0;m<6;++m){if((n.width||n.height)&&(!t.width&&!t.height)){d.texImage2D(u[m],0,s,n.width,n.height,n.border,s,q,t[m])}else{d.texImage2D(u[m],0,s,s,q,t[m])}}}else{if((n.width||n.height)&&(!t.width&&!t.height)){d.texImage2D(u,0,s,n.width,n.height,n.border,s,q,t)}else{d.texImage2D(u,0,s,s,q,t)}}}else{if(n.width||n.height){d.texImage2D(u,0,s,n.width,n.height,n.border,s,q,null)}}if(!l){for(m=0;m<w.length;m++){var o=w[m];o.name=d.get(o.name);o.value=d.get(o.value);d.texParameteri(v,o.name,o.value);if(o.generateMipmap){d.generateMipmap(v)}}}j.isCube=r;if(x){j.data.value=false}this.textureMemo[h]=j;return this},setTextures:function(i){for(var h in i){this.setTexture(h,i[h])}return this},use:function(h){d.useProgram(h.program);this.usedProgram=h;return this}};f.Application=g;(function(){try{var h=document.createElement("canvas");PhiloGL.hasWebGL=function(){return !!(window.WebGLRenderingContext&&(h.getContext("webgl")||h.getContext("experimental-webgl")))}}catch(i){PhiloGL.hasWebGL=function(){return false}}PhiloGL.hasExtension=function(k){if(!PhiloGL.hasWebGL()){return false}var j=document.createElement("canvas");return(j.getContext("webgl")||j.getContext("experimental-webgl")).getExtension(k)}})();PhiloGL.WebGL=f})();(function(){var t=Math.sqrt,n=Math.sin,u=Math.cos,m=Math.tan,k=Math.PI,r=Array.prototype.slice,o=this.Float32Array,p=(function(){if(!o||!o.call){return Array}try{o.call({},10)}catch(v){return Array}return o})(),h=p!=Array;function g(v){return{get:function(){return this[v]},set:function(w){this[v]=w},configurable:false,enumerable:false}}var s=function(v,A,w){if(h){o.call(this,3);this[0]=v||0;this[1]=A||0;this[2]=w||0}else{this.push(v||0,A||0,w||0)}this.typedContainer=new o(3)};s.create=function(){return new o(3)};s.prototype=Object.create(p.prototype,{$$family:{value:"Vec3"},x:g(0),y:g(1),z:g(2)});var q={setVec3:function(v,w){v[0]=w[0];v[1]=w[1];v[2]=w[2];return v},set:function(w,v,B,A){w[0]=v;w[1]=B;w[2]=A;return w},add:function(v,w){return new s(v[0]+w[0],v[1]+w[1],v[2]+w[2])},$add:function(v,w){v[0]+=w[0];v[1]+=w[1];v[2]+=w[2];return v},add2:function(x,w,v){x[0]=w[0]+v[0];x[1]=w[1]+v[1];x[2]=w[2]+v[2];return x},sub:function(v,w){return new s(v[0]-w[0],v[1]-w[1],v[2]-w[2])},$sub:function(v,w){v[0]-=w[0];v[1]-=w[1];v[2]-=w[2];return v},sub2:function(x,w,v){x[0]=w[0]-v[0];x[1]=w[1]-v[1];x[2]=w[2]-v[2];return x},scale:function(v,w){return new s(v[0]*w,v[1]*w,v[2]*w)},$scale:function(v,w){v[0]*=w;v[1]*=w;v[2]*=w;return v},neg:function(v){return new s(-v[0],-v[1],-v[2])},$neg:function(v){v[0]=-v[0];v[1]=-v[1];v[2]=-v[2];return v},unit:function(w){var v=s.norm(w);if(v>0){return s.scale(w,1/v)}return s.clone(w)},$unit:function(w){var v=s.norm(w);if(v>0){return s.$scale(w,1/v)}return w},cross:function(z,B){var x=z[0],w=z[1],v=z[2],C=B[0],A=B[1],y=B[2];return new s(w*y-v*A,v*C-x*y,x*A-w*C)},$cross:function(z,B){var x=z[0],w=z[1],v=z[2],C=B[0],A=B[1],y=B[2];z[0]=w*y-v*A;z[1]=v*C-x*y;z[2]=x*A-w*C;return z},distTo:function(y,z){var x=y[0]-z[0],w=y[1]-z[1],v=y[2]-z[2];return t(x*x+w*w+v*v)},distToSq:function(y,z){var x=y[0]-z[0],w=y[1]-z[1],v=y[2]-z[2];return x*x+w*w+v*v},norm:function(y){var x=y[0],w=y[1],v=y[2];return t(x*x+w*w+v*v)},normSq:function(y){var x=y[0],w=y[1],v=y[2];return x*x+w*w+v*v},dot:function(v,w){return v[0]*w[0]+v[1]*w[1]+v[2]*w[2]},clone:function(v){if(v.$$family){return new s(v[0],v[1],v[2])}else{return s.setVec3(new o(3),v)}},toFloat32Array:function(w){var v=w.typedContainer;if(!v){return w}v[0]=w[0];v[1]=w[1];v[2]=w[2];return v}};var j=s.prototype;for(var f in q){s[f]=q[f];j[f]=(function(v){return function(){var w=r.call(arguments);w.unshift(this);return s[v].apply(s,w)}})(f)}var i=function(H,G,E,C,z,y,x,w,v,K,J,I,F,D,B,A){p.call(this,16);this.length=16;if(typeof H=="number"){this.set(H,G,E,C,z,y,x,w,v,K,J,I,F,D,B,A)}else{this.id()}this.typedContainer=new o(16)};i.create=function(){return new o(16)};i.prototype=Object.create(p.prototype,{$$family:{value:"Mat4"},n11:g(0),n12:g(4),n13:g(8),n14:g(12),n21:g(1),n22:g(5),n23:g(9),n24:g(13),n31:g(2),n32:g(6),n33:g(10),n34:g(14),n41:g(3),n42:g(7),n43:g(11),n44:g(15)});q={id:function(v){v[0]=1;v[1]=0;v[2]=0;v[3]=0;v[4]=0;v[5]=1;v[6]=0;v[7]=0;v[8]=0;v[9]=0;v[10]=1;v[11]=0;v[12]=0;v[13]=0;v[14]=0;v[15]=1;return v},clone:function(v){if(v.$$family){return new i(v[0],v[4],v[8],v[12],v[1],v[5],v[9],v[13],v[2],v[6],v[10],v[14],v[3],v[7],v[11],v[15])}else{return new o(v)}},set:function(I,H,G,E,C,z,y,x,w,v,L,K,J,F,D,B,A){I[0]=H;I[4]=G;I[8]=E;I[12]=C;I[1]=z;I[5]=y;I[9]=x;I[13]=w;I[2]=v;I[6]=L;I[10]=K;I[14]=J;I[3]=F;I[7]=D;I[11]=B;I[15]=A;return I},mulVec3:function(w,x){var v=s.clone(x);return i.$mulVec3(w,v)},$mulVec3:function(w,y){var z=y[0],x=y[1],v=y[2],A=1/(w[3]*z+w[7]*x+w[11]*v+w[15]);y[0]=(w[0]*z+w[4]*x+w[8]*v+w[12])*A;y[1]=(w[1]*z+w[5]*x+w[9]*v+w[13])*A;y[2]=(w[2]*z+w[6]*x+w[10]*v+w[14])*A;return y},mulMat42:function(H,aa,Y){var E=aa[0],D=aa[1],B=aa[2],z=aa[3],P=aa[4],O=aa[5],N=aa[6],M=aa[7],ad=aa[8],ac=aa[9],ab=aa[10],Z=aa[11],G=aa[12],F=aa[13],C=aa[14],A=aa[15],W=Y[0],U=Y[1],S=Y[2],Q=Y[3],y=Y[4],x=Y[5],w=Y[6],v=Y[7],L=Y[8],K=Y[9],J=Y[10],I=Y[11],X=Y[12],V=Y[13],T=Y[14],R=Y[15];H[0]=W*E+U*P+S*ad+Q*G;H[1]=W*D+U*O+S*ac+Q*F;H[2]=W*B+U*N+S*ab+Q*C;H[3]=W*z+U*M+S*Z+Q*A;H[4]=y*E+x*P+w*ad+v*G;H[5]=y*D+x*O+w*ac+v*F;H[6]=y*B+x*N+w*ab+v*C;H[7]=y*z+x*M+w*Z+v*A;H[8]=L*E+K*P+J*ad+I*G;H[9]=L*D+K*O+J*ac+I*F;H[10]=L*B+K*N+J*ab+I*C;H[11]=L*z+K*M+J*Z+I*A;H[12]=X*E+V*P+T*ad+R*G;H[13]=X*D+V*O+T*ac+R*F;H[14]=X*B+V*N+T*ab+R*C;H[15]=X*z+V*M+T*Z+R*A;return H},mulMat4:function(x,w){var v=i.clone(x);return i.mulMat42(v,x,w)},$mulMat4:function(w,v){return i.mulMat42(w,w,v)},add:function(w,v){var x=i.clone(w);return i.$add(x,v)},$add:function(w,v){w[0]+=v[0];w[1]+=v[1];w[2]+=v[2];w[3]+=v[3];w[4]+=v[4];w[5]+=v[5];w[6]+=v[6];w[7]+=v[7];w[8]+=v[8];w[9]+=v[9];w[10]+=v[10];w[11]+=v[11];w[12]+=v[12];w[13]+=v[13];w[14]+=v[14];w[15]+=v[15];return w},transpose:function(w){var v=i.clone(w);return i.$transpose(v)},$transpose:function(H){var z=H[4],w=H[8],F=H[12],D=H[1],v=H[9],E=H[13],B=H[2],y=H[6],C=H[14],A=H[3],x=H[7],G=H[11];H[1]=z;H[2]=w;H[3]=F;H[4]=D;H[6]=v;H[7]=E;H[8]=B;H[9]=y;H[11]=C;H[12]=A;H[13]=x;H[14]=G;return H},rotateAxis:function(w,y,x){var v=i.clone(w);return i.$rotateAxis(v,y,x)},$rotateAxis:function(E,D,G){var F=n(D),S=u(D),C=1-S,P=G[0],M=G[1],J=G[2],Z=P*P*C+S,W=P*M*C+J*F,T=P*J*C-M*F,A=M*P*C-J*F,y=M*M*C+S,w=M*J*C+P*F,O=P*J*C+M*F,L=M*J*C-P*F,I=J*J*C+S,ab=E[0],Y=E[1],V=E[2],R=E[3],B=E[4],z=E[5],x=E[6],v=E[7],Q=E[8],N=E[9],K=E[10],H=E[11],ac=E[12],aa=E[13],X=E[14],U=E[15];E[0]=ab*Z+B*W+Q*T;E[1]=Y*Z+z*W+N*T;E[2]=V*Z+x*W+K*T;E[3]=R*Z+v*W+H*T;E[4]=ab*A+B*y+Q*w;E[5]=Y*A+z*y+N*w;E[6]=V*A+x*y+K*w;E[7]=R*A+v*y+H*w;E[8]=ab*O+B*L+Q*I;E[9]=Y*O+z*L+N*I;E[10]=V*O+x*L+K*I;E[11]=R*O+v*L+H*I;return E},rotateXYZ:function(w,z,y,x){var v=i.clone(w);return i.$rotateXYZ(v,z,y,x)},$rotateXYZ:function(G,B,y,w){var X=G[0],W=G[1],U=G[2],S=G[3],F=G[4],E=G[5],C=G[6],z=G[7],N=G[8],M=G[9],K=G[10],I=G[11],v=u(B),Z=u(y),Y=u(w),Q=n(B),P=n(y),O=n(w),V=Z*Y,D=-v*O+Q*P*Y,L=Q*O+v*P*Y,T=Z*O,A=v*Y+Q*P*O,J=-Q*Y+v*P*O,R=-P,x=Q*Z,H=v*Z;G[0]=X*V+F*T+N*R;G[1]=W*V+E*T+M*R;G[2]=U*V+C*T+K*R;G[3]=S*V+z*T+I*R;G[4]=X*D+F*A+N*x;G[5]=W*D+E*A+M*x;G[6]=U*D+C*A+K*x;G[7]=S*D+z*A+I*x;G[8]=X*L+F*J+N*H;G[9]=W*L+E*J+M*H;G[10]=U*L+C*J+K*H;G[11]=S*L+z*J+I*H;return G},translate:function(A,w,C,B){var v=i.clone(A);return i.$translate(v,w,C,B)},$translate:function(w,v,B,A){w[12]=w[0]*v+w[4]*B+w[8]*A+w[12];w[13]=w[1]*v+w[5]*B+w[9]*A+w[13];w[14]=w[2]*v+w[6]*B+w[10]*A+w[14];w[15]=w[3]*v+w[7]*B+w[11]*A+w[15];return w},scale:function(A,w,C,B){var v=i.clone(A);return i.$scale(v,w,C,B)},$scale:function(w,v,B,A){w[0]*=v;w[1]*=v;w[2]*=v;w[3]*=v;w[4]*=B;w[5]*=B;w[6]*=B;w[7]*=B;w[8]*=A;w[9]*=A;w[10]*=A;w[11]*=A;return w},invert:function(w){var v=i.clone(w);return i.$invert(v)},$invert:function(D){var O=D[0],N=D[1],M=D[2],L=D[3],K=D[4],J=D[5],I=D[6],H=D[7],G=D[8],F=D[9],w=D[10],v=D[11],Y=D[12],W=D[13],U=D[14],S=D[15];var X=O*J-N*K,V=O*I-M*K,T=O*H-L*K,R=N*I-M*J,Q=N*H-L*J,P=M*H-L*I,C=G*W-F*Y,B=G*U-w*Y,A=G*S-v*Y,z=F*U-w*W,y=F*S-v*W,x=w*S-v*U;var E=1/(X*x-V*y+T*z+R*A-Q*B+P*C);D[0]=(+J*x-I*y+H*z)*E;D[1]=(-N*x+M*y-L*z)*E;D[2]=(+W*P-U*Q+S*R)*E;D[3]=(-F*P+w*Q-v*R)*E;D[4]=(-K*x+I*A-H*B)*E;D[5]=(+O*x-M*A+L*B)*E;D[6]=(-Y*P+U*T-S*V)*E;D[7]=(+G*P-w*T+v*V)*E;D[8]=(+K*y-J*A+H*C)*E;D[9]=(-O*y+N*A-L*C)*E;D[10]=(+Y*Q-W*T+S*X)*E;D[11]=(-G*Q+F*T-v*X)*E;D[12]=(-K*z+J*B-I*C)*E;D[13]=(+O*z-N*B+M*C)*E;D[14]=(-Y*R+W*V-U*X)*E;D[15]=(+G*R-F*V+w*X)*E;return D},lookAt:function(C,B,A,w){var D=s.sub(B,A);D.$unit();var v=s.cross(w,D);v.$unit();var E=s.cross(D,v);E.$unit();return i.set(C,v[0],v[1],v[2],-v.dot(B),E[0],E[1],E[2],-E.dot(B),D[0],D[1],D[2],-D.dot(B),0,0,0,1)},frustum:function(D,w,E,v,C,z,y){var A=E-w,x=C-v,B=y-z;D[0]=(z*2)/A;D[1]=0;D[2]=0;D[3]=0;D[4]=0;D[5]=(z*2)/x;D[6]=0;D[7]=0;D[8]=(E+w)/A;D[9]=(C+v)/x;D[10]=-(y+z)/B;D[11]=-1;D[12]=0;D[13]=0;D[14]=-(y*z*2)/B;D[15]=0;return D},perspective:function(D,z,v,B,A){var x=B*m(z*k/360),C=-x,w=C*v,y=x*v;return i.frustum(D,w,y,C,x,B,A)},ortho:function(D,w,E,v,C,z,y){var A=E-w,x=C-v,B=y-z;D[0]=2/A;D[1]=0;D[2]=0;D[3]=0;D[4]=0;D[5]=2/x;D[6]=0;D[7]=0;D[8]=0;D[9]=0;D[10]=-2/B;D[11]=0;D[12]=-(w+E)/A;D[13]=-(C+v)/x;D[14]=-(y+z)/B;D[15]=1;return D},toFloat32Array:function(w){var v=w.typedContainer;if(!v){return w}v[0]=w[0];v[1]=w[1];v[2]=w[2];v[3]=w[3];v[4]=w[4];v[5]=w[5];v[6]=w[6];v[7]=w[7];v[8]=w[8];v[9]=w[9];v[10]=w[10];v[11]=w[11];v[12]=w[12];v[13]=w[13];v[14]=w[14];v[15]=w[15];return v}};j=i.prototype;for(f in q){i[f]=q[f];j[f]=(function(v){return function(){var w=r.call(arguments);w.unshift(this);return i[v].apply(i,w)}})(f)}var l=function(v,C,B,A){p.call(this,4);this[0]=v||0;this[1]=C||0;this[2]=B||0;this[3]=A||0;this.typedContainer=new o(4)};l.create=function(){return new o(4)};q={setQuat:function(v,w){v[0]=w[0];v[1]=w[1];v[2]=w[2];v[3]=w[3];return v},set:function(B,v,D,C,A){B[0]=v||0;B[1]=D||0;B[2]=C||0;B[3]=A||0;return B},clone:function(v){if(v.$$family){return new l(v[0],v[1],v[2],v[3])}else{return l.setQuat(new o(4),v)}},neg:function(v){return new l(-v[0],-v[1],-v[2],-v[3])},$neg:function(v){v[0]=-v[0];v[1]=-v[1];v[2]=-v[2];v[3]=-v[3];return v},add:function(v,w){return new l(v[0]+w[0],v[1]+w[1],v[2]+w[2],v[3]+w[3])},$add:function(v,w){v[0]+=w[0];v[1]+=w[1];v[2]+=w[2];v[3]+=w[3];return v},sub:function(v,w){return new l(v[0]-w[0],v[1]-w[1],v[2]-w[2],v[3]-w[3])},$sub:function(v,w){v[0]-=w[0];v[1]-=w[1];v[2]-=w[2];v[3]-=w[3];return v},scale:function(v,w){return new l(v[0]*w,v[1]*w,v[2]*w,v[3]*w)},$scale:function(v,w){v[0]*=w;v[1]*=w;v[2]*=w;v[3]*=w;return v},mulQuat:function(D,x){var B=D[0],A=D[1],z=D[2],C=D[3],w=x[0],v=x[1],E=x[2],y=x[3];return new l(C*w+B*y+A*E-z*v,C*v+A*y+z*w-B*E,C*E+z*y+B*v-A*w,C*y-B*w-A*v-z*E)},$mulQuat:function(D,x){var B=D[0],A=D[1],z=D[2],C=D[3],w=x[0],v=x[1],E=x[2],y=x[3];D[0]=C*w+B*y+A*E-z*v;D[1]=C*v+A*y+z*w-B*E;D[2]=C*E+z*y+B*v-A*w;D[3]=C*y-B*w-A*v-z*E;return D},divQuat:function(E,x){var B=E[0],A=E[1],z=E[2],C=E[3],w=x[0],v=x[1],F=x[2],y=x[3];var D=1/(y*y+w*w+v*v+F*F);return new l((B*y-C*w-A*F+z*v)*D,(B*F-C*v+A*y-z*w)*D,(A*w+z*y-C*F-B*v)*D,(C*y+B*w+A*v+z*F)*D)},$divQuat:function(E,x){var B=E[0],A=E[1],z=E[2],C=E[3],w=x[0],v=x[1],F=x[2],y=x[3];var D=1/(y*y+w*w+v*v+F*F);E[0]=(B*y-C*w-A*F+z*v)*D;E[1]=(B*F-C*v+A*y-z*w)*D;E[2]=(A*w+z*y-C*F-B*v)*D;E[3]=(C*y+B*w+A*v+z*F)*D;return E},invert:function(x){var w=x[0],v=x[1],A=x[2],z=x[3];var y=1/(w*w+v*v+A*A+z*z);return new l(-w*y,-v*y,-A*y,z*y)},$invert:function(x){var w=x[0],v=x[1],A=x[2],z=x[3];var y=1/(w*w+v*v+A*A+z*z);x[0]=-w*y;x[1]=-v*y;x[2]=-A*y;x[3]=z*y;return x},norm:function(x){var w=x[0],v=x[1],z=x[2],y=x[3];return t(w*w+v*v+z*z+y*y)},normSq:function(x){var w=x[0],v=x[1],z=x[2],y=x[3];return w*w+v*v+z*z+y*y},unit:function(v){return l.scale(v,1/l.norm(v))},$unit:function(v){return l.$scale(v,1/l.norm(v))},conjugate:function(v){return new l(-v[0],-v[1],-v[2],v[3])},$conjugate:function(v){v[0]=-v[0];v[1]=-v[1];v[2]=-v[2];return v}};j=l.prototype={};for(f in q){l[f]=q[f];j[f]=(function(v){return function(){var w=r.call(arguments);w.unshift(this);return l[v].apply(l,w)}})(f)}s.fromQuat=function(v){return new s(v[0],v[1],v[2])};l.fromVec3=function(w,x){return new l(w[0],w[1],w[2],x||0)};l.fromMat4=function(x){var A;var z;var y;if(x[0]>x[5]&&x[0]>x[10]){A=0;z=1;y=2}else{if(x[5]>x[0]&&x[5]>x[10]){A=1;z=2;y=0}else{A=2;z=0;y=1}}var B=t(1+x[A*5]-x[z*5]-x[y*5]);var C=new l;C[A]=0.5*B;C[z]=0.5*(x["n"+z+""+A]+x["n"+A+""+z])/B;C[y]=0.5*(x["n"+A+""+y]+x["n"+y+""+A])/B;C[3]=0.5*(x["n"+z+""+y]-x["n"+y+""+z])/B;return C};l.fromXRotation=function(v){return new l(n(v/2),0,0,u(v/2))};l.fromYRotation=function(v){return new l(0,n(v/2),0,u(v/2))};l.fromZRotation=function(v){return new l(0,0,n(v/2),u(v/2))};l.fromAxisRotation=function(w,D){var v=w[0],F=w[1],C=w[2],B=1/t(v*v+F*F+C*C),A=n(D/2),E=u(D/2);return new l(A*v*B,A*F*B,A*C*B,E)};i.fromQuat=function(x){var w=x[3],v=x[0],z=x[1],y=x[2];return new i(w*w+v*v-z*z-y*y,2*v*z-2*w*y,2*v*y+2*w*z,0,2*v*z+2*w*y,w*w-v*v+z*z-y*y,2*z*y-2*w*v,0,2*v*y-2*w*z,2*z*y+2*w*v,w*w-v*v-z*z+y*y,0,0,0,0,1)};PhiloGL.Vec3=s;PhiloGL.Mat4=i;PhiloGL.Quat=l})();(function(){function h(l){return l!==true?l:false}var k=function(l){var m=l.getBoundingClientRect();return{x:m.left,y:m.top,bbox:m}};var i={get:function(m,l){l=l||window;return m||l.event},getWheel:function(l){return l.wheelDelta?l.wheelDelta/120:-(l.detail||0)/3},getKey:function(o){var n=o.which||o.keyCode;var m=j(n);var l=n-111;if(l>0&&l<13){m="f"+l}m=m||String.fromCharCode(n).toLowerCase();return{code:n,key:m,shift:o.shiftKey,control:o.ctrlKey,alt:o.altKey,meta:o.metaKey}},isRightClick:function(l){return(l.which==3||l.button==2)},getPos:function(o,n){n=n||window;o=o||n.event;var m=n.document;m=m.documentElement||m.body;if(o.touches&&o.touches.length){o=o.touches[0]}var l={x:o.pageX||(o.clientX+m.scrollLeft),y:o.pageY||(o.clientY+m.scrollTop)};return l},stop:function(l){if(l.stopPropagation){l.stopPropagation()}l.cancelBubble=true;if(l.preventDefault){l.preventDefault()}else{l.returnValue=false}}};var g=function(n,l){var m=n.canvas;this.scene=n.scene;this.domElem=m;this.pos=k(m);this.opt=this.callbacks=l;this.size={width:m.width||m.offsetWidth,height:m.height||m.offsetHeight};this.attachEvents()};g.prototype={hovered:false,pressed:false,touched:false,touchMoved:false,moved:false,attachEvents:function(){var n=this.domElem,l=this.opt,o=this;if(l.disableContextMenu){n.oncontextmenu=function(){return false}}["mouseup","mousedown","mousemove","mouseover","mouseout","touchstart","touchmove","touchend"].forEach(function(p){n.addEventListener(p,function(r,q){o[p](o.eventInfo(p,r,q))},false)});["keydown","keyup"].forEach(function(p){document.addEventListener(p,function(r,q){o[p](o.eventInfo(p,r,q))},false)});var m="";if(!document.getBoxObjectFor&&window.mozInnerScreenX==null){m="mousewheel"}else{m="DOMMouseScroll"}n.addEventListener(m,function(q,p){o.mousewheel(o.eventInfo("mousewheel",q,p))},false)},eventInfo:function(t,s,r){var o=this.domElem,q=this.scene,m=this.opt,C=this.getSize(),l=m.relative,n=m.centerOrigin,w=m.cachePosition&&this.pos||k(o),A=i.get(s,r),p=i.getPos(s,r),B={};var z=p.x,v=p.y;if(l){z-=w.x;v-=w.y;if(n){z-=C.width/2;v-=C.height/2;v*=-1}}switch(t){case"mousewheel":B.wheel=i.getWheel(A);break;case"keydown":case"keyup":a.extend(B,i.getKey(A));break;case"mouseup":B.isRightClick=i.isRightClick(A);break}var u;a.extend(B,{x:z,y:v,cache:false,stop:function(){i.stop(A)},getTarget:function(){if(u){return u}return(u=!m.picking||q.pick(p.x-w.x,p.y-w.y,m.lazyPicking)||true)}});B.event=A;return B},getSize:function(){if(this.cacheSize){return this.size}var l=this.domElem;return{width:l.width||l.offsetWidth,height:l.height||l.offsetHeight}},mouseup:function(l){if(!this.moved){if(l.isRightClick){this.callbacks.onRightClick(l,this.hovered)}else{this.callbacks.onClick(l,h(this.pressed))}}if(this.pressed){if(this.moved){this.callbacks.onDragEnd(l,h(this.pressed))}else{this.callbacks.onDragCancel(l,h(this.pressed))}this.pressed=this.moved=false}},mouseout:function(n){var l=n.relatedTarget,m=this.domElem;while(l&&l.parentNode){if(m==l.parentNode){return}l=l.parentNode}if(this.hovered){this.callbacks.onMouseLeave(n,this.hovered);this.hovered=false}if(this.pressed&&this.moved){this.callbacks.onDragEnd(n);this.pressed=this.moved=false}},mouseover:function(l){},mousemove:function(m){if(this.pressed){this.moved=true;this.callbacks.onDragMove(m,h(this.pressed));return}if(this.hovered){var l=h(m.getTarget());if(!l||l.hash!=this.hash){this.callbacks.onMouseLeave(m,this.hovered);this.hovered=l;this.hash=l;if(l){this.hash=l.hash;this.callbacks.onMouseEnter(m,this.hovered)}}else{this.callbacks.onMouseMove(m,this.hovered)}}else{this.hovered=h(m.getTarget());this.hash=this.hovered;if(this.hovered){this.hash=this.hovered.hash;this.callbacks.onMouseEnter(m,this.hovered)}}if(!this.opt.picking){this.callbacks.onMouseMove(m)}},mousewheel:function(l){this.callbacks.onMouseWheel(l)},mousedown:function(l){this.pressed=l.getTarget();this.callbacks.onDragStart(l,h(this.pressed))},touchstart:function(l){this.touched=l.getTarget();this.callbacks.onTouchStart(l,h(this.touched))},touchmove:function(l){if(this.touched){this.touchMoved=true;this.callbacks.onTouchMove(l,h(this.touched))}},touchend:function(l){if(this.touched){if(this.touchMoved){this.callbacks.onTouchEnd(l,h(this.touched))}else{this.callbacks.onTouchCancel(l,h(this.touched))}this.touched=this.touchMoved=false}},keydown:function(l){this.callbacks.onKeyDown(l)},keyup:function(l){this.callbacks.onKeyUp(l)}};var f={};f.create=function(n,m){m=a.extend({cachePosition:true,cacheSize:true,relative:true,centerOrigin:true,disableContextMenu:true,bind:false,picking:false,lazyPicking:false,onClick:a.empty,onRightClick:a.empty,onDragStart:a.empty,onDragMove:a.empty,onDragEnd:a.empty,onDragCancel:a.empty,onTouchStart:a.empty,onTouchMove:a.empty,onTouchEnd:a.empty,onTouchCancel:a.empty,onMouseMove:a.empty,onMouseEnter:a.empty,onMouseLeave:a.empty,onMouseWheel:a.empty,onKeyDown:a.empty,onKeyUp:a.empty},m||{});var o=m.bind;if(o){for(var l in m){if(l.match(/^on[a-zA-Z0-9]+$/)){(function(p,q){m[p]=function(){return q.apply(o,Array.prototype.slice.call(arguments))}})(l,m[l])}}}new g(n,m);n.events=m};f.Keys={enter:13,up:38,down:40,left:37,right:39,esc:27,space:32,backspace:8,tab:9,"delete":46};function j(m){var n=f.Keys;for(var l in n){if(n[l]==m){return l}}}PhiloGL.Events=f})();(function(){var j=function(r,s,q){var n=r.createShader(q);if(n==null){throw"Error creating the shader with shader type: "+q}r.shaderSource(n,s);r.compileShader(n);var p=r.getShaderParameter(n,r.COMPILE_STATUS);if(!p){var o=r.getShaderInfoLog(n);r.deleteShader(n);throw"Error while compiling the shader "+o}return n};var g=function(q,p,n){var o=q.createProgram();q.attachShader(o,j(q,p,q.VERTEX_SHADER));q.attachShader(o,j(q,n,q.FRAGMENT_SHADER));m(q,o);return o};var i=function(o){var n=o.lastIndexOf("/");if(n=="/"){return"./"}else{return o.substr(0,n+1)}};var k=function(q,p,u,s,t){t=t||{};var o;if((o=p.match(/#include "(.*?)"/))){var r=PhiloGL.IO.XHR,n=i(q)+o[1];if(t[n]){s("Recursive include")}new r({url:n,noCache:true,onError:function(v){s("Load included file `"+n+"` failed: Code "+v)},onSuccess:function(v){t[n]=true;return k(n,v,function(w){delete t[n];p=p.replace(/#include ".*?"/,w);p=p.replace(/\sHAS_EXTENSION\s*\(\s*([A-Za-z_\-0-9]+)\s*\)/g,function(y,x){return d.getExtension(x)?" 1 ":" 0 "});return k(n,p,u,s,t)},s,t)}}).send();return null}else{return u(p)}};var m=function(o,n){o.linkProgram(n);var p=o.getProgramParameter(n,o.LINK_STATUS);if(!p){throw"Error linking the shader: "+o.getProgramInfoLog(n)}return true};var l=function(r,o,s){var n=o.name,t=d.getUniformLocation(r,n),v=o.type,x=false,p=true,q,w;if(o.size>1&&s){switch(v){case d.FLOAT:q=d.uniform1fv;w=Float32Array;p=false;break;case d.INT:case d.BOOL:case d.SAMPLER_2D:case d.SAMPLER_CUBE:q=d.uniform1iv;w=Uint16Array;p=false;break}}if(p){switch(v){case d.FLOAT:q=d.uniform1f;break;case d.FLOAT_VEC2:q=d.uniform2fv;w=s?Float32Array:new Float32Array(2);break;case d.FLOAT_VEC3:q=d.uniform3fv;w=s?Float32Array:new Float32Array(3);break;case d.FLOAT_VEC4:q=d.uniform4fv;w=s?Float32Array:new Float32Array(4);break;case d.INT:case d.BOOL:case d.SAMPLER_2D:case d.SAMPLER_CUBE:q=d.uniform1i;break;case d.INT_VEC2:case d.BOOL_VEC2:q=d.uniform2iv;w=s?Uint16Array:new Uint16Array(2);break;case d.INT_VEC3:case d.BOOL_VEC3:q=d.uniform3iv;w=s?Uint16Array:new Uint16Array(3);break;case d.INT_VEC4:case d.BOOL_VEC4:q=d.uniform4iv;w=s?Uint16Array:new Uint16Array(4);break;case d.FLOAT_MAT2:x=true;q=d.uniformMatrix2fv;break;case d.FLOAT_MAT3:x=true;q=d.uniformMatrix3fv;break;case d.FLOAT_MAT4:x=true;q=d.uniformMatrix4fv;break}}if(q.bind){q=q.bind(d)}else{var u=q;q=function(){u.apply(d,arguments)}}if(s&&w){return function(y){q(t,new w(y))}}else{if(x){return function(y){q(t,false,y.toFloat32Array())}}else{if(w){return function(y){w.set(y.toFloat32Array?y.toFloat32Array():y);q(t,w)}}else{return function(y){q(t,y)}}}}throw"Unknown type: "+v};var f=function(w,p){var s=g(d,w,p);if(!s){return false}var q={},v={},x={},o,n,u;var t=d.getProgramParameter(s,d.ACTIVE_ATTRIBUTES);for(var r=0;r<t;r++){o=d.getActiveAttrib(s,r);n=o.name;u=d.getAttribLocation(s,o.name);q[n]=u}t=d.getProgramParameter(s,d.ACTIVE_UNIFORMS);for(r=0;r<t;r++){o=d.getActiveUniform(s,r);n=o.name;n=n[n.length-1]=="]"?n.substr(0,n.length-3):n;x[n]=l(s,o,o.name!=n)}this.program=s;this.attributes=q;this.attributeEnabled=v;this.uniforms=x};f.prototype={$$family:"program",setUniform:function(n,o){if(this.uniforms[n]){this.uniforms[n](o)}return this},setUniforms:function(o){for(var n in o){this.setUniform(n,o[n])}return this}};["setBuffer","setBuffers","use"].forEach(function(n){f.prototype[n]=function(){var o=Array.prototype.slice.call(arguments);o.unshift(this);c[n].apply(c,o);return this}});["setFrameBuffer","setFrameBuffers","setRenderBuffer","setRenderBuffers","setTexture","setTextures"].forEach(function(n){f.prototype[n]=function(){c[n].apply(c,arguments);return this}});function h(n,p){var o;if(n.length==2){o={vs:n[0],fs:n[1]}}else{o=n[0]||{}}return a.merge(p||{},o)}f.fromShaderIds=function(){var o=h(arguments),p=a(o.vs),n=a(o.fs);return k(o.path,p.innerHTML,function(q){return k(o.path,n.innerHTML,function(r){o.onSuccess(new f(q,r),o)})})};f.fromShaderSources=function(){var n=h(arguments,{path:"./"});return k(n.path,n.vs,function(o){return k(n.path,n.fs,function(p){try{var q=new f(o,p);if(n.onSuccess){n.onSuccess(q,n)}else{return q}}catch(r){if(n.onError){n.onError(r,n)}else{throw r}}})})};f.fromDefaultShaders=function(p){p=p||{};var q=p.vs||"Default",n=p.fs||"Default",o=PhiloGL.Shaders;p.vs=o.Vertex[q];p.fs=o.Fragment[n];return PhiloGL.Program.fromShaderSources(p)};f.fromShaderURIs=function(p){p=a.merge({path:"",vs:"",fs:"",noCache:false,onSuccess:a.empty,onError:a.empty},p||{});var n=p.path+p.vs,o=p.path+p.fs,q=PhiloGL.IO.XHR;new q.Group({urls:[n,o],noCache:p.noCache,onError:function(r){p.onError(r)},onComplete:function(r){try{return k(n,r[0],function(t){return k(o,r[1],function(u){p.vs=t;p.fs=u;return f.fromShaderSources(p)},p.onError)},p.onError)}catch(s){p.onError(s,p)}}}).send()};PhiloGL.Program=f})();(function(){var f={};var h=function(k){k=a.merge({url:"http://philogljs.org/",method:"GET",async:true,noCache:false,sendAsBinary:false,responseType:false,onProgress:a.empty,onSuccess:a.empty,onError:a.empty,onAbort:a.empty,onComplete:a.empty},k||{});this.opt=k;this.initXHR()};h.State={};["UNINITIALIZED","LOADING","LOADED","INTERACTIVE","COMPLETED"].forEach(function(l,k){h.State[l]=k});h.prototype={initXHR:function(){var l=this.req=new XMLHttpRequest(),k=this;["Progress","Error","Abort","Load"].forEach(function(m){if(l.addEventListener){l.addEventListener(m.toLowerCase(),function(n){k["handle"+m](n)},false)}else{l["on"+m.toLowerCase()]=function(n){k["handle"+m](n)}}})},send:function(k){var n=this.req,l=this.opt,m=l.async;if(l.noCache){l.url+=(l.url.indexOf("?")>=0?"&":"?")+a.uid()}n.open(l.method,l.url,m);if(l.responseType){n.responseType=l.responseType}if(m){n.onreadystatechange=function(o){if(n.readyState==h.State.COMPLETED){if(n.status==200){l.onSuccess(n.responseType?n.response:n.responseText)}else{l.onError(n.status)}}}}if(l.sendAsBinary){n.sendAsBinary(k||l.body||null)}else{n.send(k||l.body||null)}if(!m){if(n.status==200){l.onSuccess(n.responseType?n.response:n.responseText)}else{l.onError(n.status)}}},setRequestHeader:function(l,k){this.req.setRequestHeader(l,k);return this},handleProgress:function(k){if(k.lengthComputable){this.opt.onProgress(k,Math.round(k.loaded/k.total*100))}else{this.opt.onProgress(k,-1)}},handleError:function(k){this.opt.onError(k)},handleAbort:function(){this.opt.onAbort(e)},handleLoad:function(k){this.opt.onComplete(k)}};h.Group=function(o){o=a.merge({urls:[],onError:a.empty,onSuccess:a.empty,onComplete:a.empty,method:"GET",async:true,noCache:false,sendAsBinary:false,responseType:false},o||{});var p=a.splat(o.urls),l=p.length,n=new Array(l),m=p.map(function(r,s){return new h({url:r,method:o.method,async:o.async,noCache:o.noCache,sendAsBinary:o.sendAsBinary,responseType:o.responseType,body:o.body,onError:q(s),onSuccess:k(s)})});function q(r){return function(s){--l;o.onError(s,r);if(!l){o.onComplete(n)}}}function k(r){return function(s){--l;n[r]=s;o.onSuccess(s,r);if(!l){o.onComplete(n)}}}this.reqs=m};h.Group.prototype={send:function(){for(var n=0,m=this.reqs,k=m.length;n<k;++n){m[n].send()}}};var i=function(m){m=a.merge({url:"http://philogljs.org/",data:{},noCache:false,onComplete:a.empty,callbackKey:"callback"},m||{});var l=i.counter++;var n=[];for(var p in m.data){n.push(p+"="+m.data[p])}n=n.join("&");if(m.noCache){n+=(n.indexOf("?")>=0?"&":"?")+a.uid()}var o=m.url+(m.url.indexOf("?")>-1?"&":"?")+m.callbackKey+"=PhiloGL.IO.JSONP.requests.request_"+l+(n.length>0?"&"+n:"");var k=document.createElement("script");k.type="text/javascript";k.src=o;i.requests["request_"+l]=function(q){m.onComplete(q);if(k.parentNode){k.parentNode.removeChild(k)}if(k.clearAttributes){k.clearAttributes()}};document.getElementsByTagName("head")[0].appendChild(k)};i.counter=0;i.requests={};var j=function(k){k=a.merge({src:[],noCache:false,onProgress:a.empty,onComplete:a.empty},k||{});var p=0,m=k.src.length;var t=function(){k.onProgress(Math.round(++p/m*100));if(p==m){k.onComplete(r)}};var s=function(){if(++p==m){k.onComplete(r)}};var n=k.noCache,q=a.uid(),o=function(l){return(l.indexOf("?")>=0?"&":"?")+q};var r=k.src.map(function(v,u){var l=new Image();l.index=u;l.onload=t;l.onerror=s;l.src=v+(n?o(v):"");return l});return r};var g=function(k){k=a.merge({src:[],noCache:false,onComplete:a.empty},k||{});j({src:k.src,noCache:k.noCache,onComplete:function(m){var l={};m.forEach(function(n,o){l[k.id&&k.id[o]||k.src&&k.src[o]]=a.merge({data:{value:n}},k)});c.setTextures(l);k.onComplete()}})};f.XHR=h;f.JSONP=i;f.Images=j;f.Textures=g;PhiloGL.IO=f})();(function(){var g=PhiloGL.Vec3,f=PhiloGL.Mat4;var h=function(n,i,q,p,k){k=k||{};var s=k.position,r=k.target,o=k.up;this.type=k.type?k.type:"perspective";this.fov=n;this.near=q;this.far=p;this.aspect=i;this.position=s&&new g(s.x,s.y,s.z)||new g();this.target=r&&new g(r.x,r.y,r.z)||new g();this.up=o&&new g(o.x,o.y,o.z)||new g(0,1,0);if(this.type=="perspective"){this.projection=new f().perspective(n,i,q,p)}else{var l=q*Math.tan(n*Math.PI/360),t=-l,j=t*i,m=l*i;this.projection=new f().ortho(j,m,t,l,q,p)}this.view=new f()};h.prototype={update:function(){if(this.type=="perspective"){this.projection=new f().perspective(this.fov,this.aspect,this.near,this.far)}else{var i=this.near*Math.tan(this.fov*Math.PI/360),k=-i,l=k*this.aspect,j=i*this.aspect;this.projection=new f().ortho(l,j,k,i,this.near,this.far)}this.view.lookAt(this.position,this.target,this.up)},setStatus:function(l){var m=this,o=m.position,k=m.view,i=m.projection,n=k.mulMat4(i),j=n.invert();l.setUniforms({cameraPosition:[o.x,o.y,o.z],projectionMatrix:i,viewMatrix:k,viewProjectionMatrix:n,viewInverseMatrix:k.invert(),viewProjectionInverseMatrix:j})}};PhiloGL.Camera=h})();(function(){var m=PhiloGL.Vec3,f=PhiloGL.Mat4,o=Math.cos,i=Math.sin,h=Math.PI,j=Math.max,l=Array.prototype.slice;function k(u,w){if(u&&u.length<w){var t=u[0],s=u[1],r=u[2],p=u[3],x=[t,s,r,p],q=w/u.length,v;while(--q){v=q*4;x[v]=t;x[v+1]=s;x[v+2]=r;x[v+3]=p}return new Float32Array(x)}else{return u}}var g={attributeMap:{position:"vertices",normal:"normals",pickingColor:"pickingColors",colors:"color"}};g.Model=function(p){p=p||{};this.id=p.id||a.uid();this.pickable=!!p.pickable;this.pick=p.pick||function(){return false};this.vertices=p.vertices;this.normals=p.normals;this.textures=p.textures&&a.splat(p.textures);this.colors=p.colors;this.indices=p.indices;this.shininess=p.shininess||0;this.reflection=p.reflection||0;this.refraction=p.refraction||0;if(p.pickingColors){this.pickingColors=p.pickingColors}if(p.texCoords){this.texCoords=p.texCoords}this.uniforms=p.uniforms||{};this.attributes=p.attributes||{};this.render=p.render;this.drawType=p.drawType||"TRIANGLES";this.display="display" in p?p.display:true;this.onBeforeRender=p.onBeforeRender||a.empty;this.onAfterRender=p.onAfterRender||a.empty;if(p.program){this.program=p.program}this.position=new m;this.rotation=new m;this.scale=new m(1,1,1);this.matrix=new f;if(p.computeCentroids){this.computeCentroids()}if(p.computeNormals){this.computeNormals()}};var n={setUniforms:function(p){p.setUniforms(this.uniforms)},setAttributes:function(q){var p=this.attributes;for(var r in p){var t=p[r],s=this.id+"-"+r;if(!Object.keys(t).length){q.setBuffer(s,true)}else{t.attribute=r;q.setBuffer(s,t);delete t.value}}},setVertices:function(p){if(!this.$vertices){return}if(this.dynamic){p.setBuffer("position-"+this.id,{attribute:"position",value:this.$vertices,size:3})}else{p.setBuffer("position-"+this.id)}},setNormals:function(p){if(!this.$normals){return}if(this.dynamic){p.setBuffer("normal-"+this.id,{attribute:"normal",value:this.$normals,size:3})}else{p.setBuffer("normal-"+this.id)}},setIndices:function(p){if(!this.$indices){return}if(this.dynamic){p.setBuffer("indices-"+this.id,{bufferType:d.ELEMENT_ARRAY_BUFFER,drawType:d.STATIC_DRAW,value:this.$indices,size:1})}else{p.setBuffer("indices-"+this.id)}},setPickingColors:function(p){if(!this.$pickingColors){return}if(this.dynamic){p.setBuffer("pickingColor-"+this.id,{attribute:"pickingColor",value:this.$pickingColors,size:4})}else{p.setBuffer("pickingColor-"+this.id)}},setColors:function(p){if(!this.$colors){return}if(this.dynamic){p.setBuffer("color-"+this.id,{attribute:"color",value:this.$colors,size:4})}else{p.setBuffer("color-"+this.id)}},setTexCoords:function(s){if(!this.$texCoords){return}var u=this.id,t,q,p,r;if(this.dynamic){if(a.type(this.$texCoords)=="object"){for(t=0,q=this.textures,p=q.length;t<p;t++){r=q[t];s.setBuffer("texCoord-"+t+"-"+u,{attribute:"texCoord"+(t+1),value:this.$texCoords[r],size:2})}}else{s.setBuffer("texCoord-"+u,{attribute:"texCoord1",value:this.$texCoords,size:2})}}else{if(a.type(this.$texCoords)=="object"){for(t=0,q=this.textures,p=q.length;t<p;t++){s.setBuffer("texCoord-"+t+"-"+u)}}else{s.setBuffer("texCoord-"+u)}}},setTextures:function(r,u){this.textures=this.textures?a.splat(this.textures):[];var v=5;for(var t=0,w=this.textures,q=w.length,s=PhiloGL.Scene.MAX_TEXTURES;t<s;t++){if(t<q){var p=c.textureMemo[w[t]].isCube;if(p){r.setUniform("hasTextureCube"+(t+1),true);r.setTexture(w[t],d["TEXTURE"+(t+v)])}else{r.setUniform("hasTexture"+(t+1),true);r.setTexture(w[t],d["TEXTURE"+t])}}else{r.setUniform("hasTextureCube"+(t+1),false);r.setUniform("hasTexture"+(t+1),false)}r.setUniform("sampler"+(t+1),t);r.setUniform("samplerCube"+(t+1),t+v)}},setState:function(p){this.setUniforms(p);this.setAttributes(p);this.setVertices(p);this.setColors(p);this.setPickingColors(p);this.setNormals(p);this.setTextures(p);this.setTexCoords(p);this.setIndices(p)},unsetState:function(q){var p=q.attributes;d.bindBuffer(d.ARRAY_BUFFER,null);d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,null);for(var r in p){d.disableVertexAttribArray(p[r])}}};g.Model.prototype=Object.create(null,{hash:{get:function(){return this.id+" "+this.$pickingIndex}},vertices:{set:function(q){if(!q){delete this.$vertices;delete this.$verticesLength;return}var p=q.length;if(q.BYTES_PER_ELEMENT){this.$vertices=q}else{if(this.$verticesLength==p){this.$vertices.set(q)}else{this.$vertices=new Float32Array(q)}}this.$verticesLength=p},get:function(){return this.$vertices}},normals:{set:function(q){if(!q){delete this.$normals;delete this.$normalsLength;return}var p=q.length;if(q.BYTES_PER_ELEMENT){this.$normals=q}else{if(this.$normalsLength==p){this.$normals.set(q)}else{this.$normals=new Float32Array(q)}}this.$normalsLength=p},get:function(){return this.$normals}},colors:{set:function(q){if(!q){delete this.$colors;delete this.$colorsLength;return}var p=q.length;if(q.BYTES_PER_ELEMENT){this.$colors=q}else{if(this.$colorsLength==p){this.$colors.set(q)}else{this.$colors=new Float32Array(q)}}if(this.$vertices&&this.$verticesLength/3*4!=p){this.$colors=k(l.call(this.$colors),this.$verticesLength/3*4)}this.$colorsLength=this.$colors.length},get:function(){return this.$colors}},pickingColors:{set:function(q){if(!q){delete this.$pickingColors;delete this.$pickingColorsLength;return}var p=q.length;if(q.BYTES_PER_ELEMENT){this.$pickingColors=q}else{if(this.$pickingColorsLength==p){this.$pickingColors.set(q)}else{this.$pickingColors=new Float32Array(q)}}if(this.$vertices&&this.$verticesLength/3*4!=p){this.$pickingColors=k(l.call(this.$pickingColors),this.$verticesLength/3*4)}this.$pickingColorsLength=this.$pickingColors.length},get:function(){return this.$pickingColors}},texCoords:{set:function(s){if(!s){delete this.$texCoords;delete this.$texCoordsLength;return}if(a.type(s)=="object"){var q={};for(var t in s){var p=s[t];q[t]=p.BYTES_PER_ELEMENT?p:new Float32Array(p)}this.$texCoords=q}else{var r=s.length;if(s.BYTES_PER_ELEMENT){this.$texCoords=s}else{if(this.$texCoordsLength==r){this.$texCoords.set(s)}else{this.$texCoords=new Float32Array(s)}}this.$texCoordsLength=r}},get:function(){return this.$texCoords}},indices:{set:function(q){if(!q){delete this.$indices;delete this.$indicesLength;return}var p=q.length;if(q.BYTES_PER_ELEMENT){this.$indices=q}else{if(this.$indicesLength==p){this.$indices.set(q)}else{this.$indices=new Uint16Array(q)}}this.$indicesLength=p},get:function(){return this.$indices}}});a.extend(g.Model.prototype,{$$family:"model",update:function(){var q=this.matrix,s=this.position,p=this.rotation,r=this.scale;q.id();q.$translate(s.x,s.y,s.z);q.$rotateXYZ(p.x,p.y,p.z);q.$scale(r.x,r.y,r.z)},computeCentroids:function(){var p=this.faces,q=this.vertices,r=[];p.forEach(function(t){var s=[0,0,0],u=0;t.forEach(function(v){var w=q[v];s[0]+=w[0];s[1]+=w[1];s[2]+=w[2];u++});s[0]/=u;s[1]/=u;s[2]/=u;r.push(s)});this.centroids=r},computeNormals:function(){var p=this.faces,q=this.vertices,r=[];p.forEach(function(t){var x=q[t[0]],w=q[t[1]],v=q[t[2]],u={x:v[0]-w[0],y:v[1]-w[1],z:v[1]-w[2]},s={x:x[0]-w[0],y:x[1]-w[1],z:x[2]-w[2]};m.$cross(s,u);if(m.norm(s)>0.000001){m.unit(s)}r.push([s.x,s.y,s.z])});this.normals=r}});a.extend(g.Model.prototype,n);g.Cube=function(p){g.Model.call(this,a.extend({vertices:[-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1],texCoords:[0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1],normals:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0],indices:[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]},p||{}))};g.Cube.prototype=Object.create(g.Model.prototype);g.Sphere=function(p){var S=p.nlat||10,N=p.nlong||10,w=p.radius||1,aa=0,U=h,X=U-aa,ab=0,O=2*h,Q=O-ab,Z=(S+1)*(N+1),D=new Float32Array(Z*3),M=new Float32Array(Z*3),t=new Float32Array(Z*2),C=new Uint16Array(S*N*6);if(typeof w=="number"){var T=w;w=function(ad,ac,y,x,r){return T}}for(var G=0;G<=S;G++){for(var H=0;H<=N;H++){var J=H/N,I=G/S,F=Q*J,s=X*I,Y=i(F),K=o(F),W=i(s),q=o(s),B=K*W,A=q,z=Y*W,L=w(B,A,z,J,I),E=H+G*(N+1),P=E*3,R=E*2;D[P+0]=L*B;D[P+1]=L*A;D[P+2]=L*z;M[P+0]=B;M[P+1]=A;M[P+2]=z;t[R+0]=J;t[R+1]=I}}var V=S+1;for(H=0;H<S;H++){for(G=0;G<N;G++){var E=(H*N+G)*6;C[E+0]=G*V+H;C[E+1]=G*V+H+1;C[E+2]=(G+1)*V+H;C[E+3]=(G+1)*V+H;C[E+4]=G*V+H+1;C[E+5]=(G+1)*V+H+1}}g.Model.call(this,a.extend({vertices:D,indices:C,normals:M,texCoords:t},p||{}))};g.Sphere.prototype=Object.create(g.Model.prototype);g.IcoSphere=function(Q){var ad=Q.iterations||0,q=[],s=[],Z=Math.sqrt,ai=Math.acos,U=Math.atan2,O=Math.PI,D=O*2;Q.onAddVertex=Q.onAddVertex||a.empty;var ab=(1+Z(5))/2,P=Z(1+ab*ab);q.push(-1/P,ab/P,0,1/P,ab/P,0,-1/P,-ab/P,0,1/P,-ab/P,0,0,-1/P,ab/P,0,1/P,ab/P,0,-1/P,-ab/P,0,1/P,-ab/P,ab/P,0,-1/P,ab/P,0,1/P,-ab/P,0,-1/P,-ab/P,0,1/P);s.push(0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1);var p=(function(){var t={};return function(ax,aw){ax*=3;aw*=3;var aD=ax<aw?ax:aw,ay=ax>aw?ax:aw,aH=aD+"|"+ay;if(aH in t){return t[aH]}var au=q[ax],aF=q[ax+1],aA=q[ax+2],at=q[aw],aE=q[aw+1],az=q[aw+2],aB=(au+at)/2,av=(aF+aE)/2,aG=(aA+az)/2,aC=Z(aB*aB+av*av+aG*aG);aB/=aC;av/=aC;aG/=aC;q.push(aB,av,aG);return(t[aH]=(q.length/3-1))}})();for(var af=0;af<ad;af++){var G=[];for(var ae=0,ac=s.length;ae<ac;ae+=3){var ap=p(s[ae],s[ae+1]),am=p(s[ae+1],s[ae+2]),ak=p(s[ae+2],s[ae]);G.push(s[ae],ap,ak,s[ae+1],am,ap,s[ae+2],ak,am,ap,am,ak)}s=G}var ac=s.length,R=new Float32Array(ac*3),N=new Float32Array(ac*2);for(var af=0;af<ac;af+=3){var B=s[af],A=s[af+1],z=s[af+2],V=B*3,T=A*3,S=z*3,x=B*2,v=A*2,r=z*2,M=q[V],ar=q[V+1],Y=q[V+2],F=ai(Y/Z(M*M+ar*ar+Y*Y)),y=U(ar,M),ao=F/O,K=1-y/D,L=q[T],aq=q[T+1],X=q[T+2],E=ai(X/Z(L*L+aq*aq+X*X)),w=U(aq,L),al=E/O,I=1-w/D,J=q[S],an=q[S+1],W=q[S+2],C=ai(W/Z(J*J+an*an+W*W)),u=U(an,J),aj=C/O,H=1-u/D,ah={x:J-L,y:an-aq,z:W-X},ag={x:M-L,y:ar-aq,z:Y-X},aa=m.cross(ah,ag).$unit();R[V]=R[T]=R[S]=aa.x;R[V+1]=R[T+1]=R[S+1]=aa.y;R[V+2]=R[T+2]=R[S+2]=aa.z;N[x]=K;N[x+1]=ao;N[v]=I;N[v+1]=al;N[r]=H;N[r+1]=aj}g.Model.call(this,a.extend({vertices:q,indices:s,normals:R,texCoords:N},Q||{}))};g.IcoSphere.prototype=Object.create(g.Model.prototype);g.TruncatedCone=function(Y){var J=Y.bottomRadius||0,Q=Y.topRadius||0,N=Y.height||1,I=Y.nradial||10,L=Y.nvertical||10,t=!!Y.topCap,B=!!Y.bottomCap,s=(t?2:0)+(B?2:0),V=(I+1)*(L+1+s),E=new Float32Array(V*3),O=new Float32Array(V*3),z=new Float32Array(V*2),D=new Uint16Array(I*(L+s)*6),T=I+1,u=Math,S=u.atan2(J-Q,N),C=u.sin,G=u.cos,x=u.PI,X=G(S),q=C(S),A=t?-2:0,w=L+(B?2:0),P=0,R=0;for(var W=A;W<=w;W++){var K=W/L,H=N*K,M;if(W<0){H=0;K=1;M=J}else{if(W>L){H=N;K=1;M=Q}else{M=J+(Q-J)*(W/L)}}if(W==-2||W==L+2){M=0;K=0}H-=N/2;for(var U=0;U<T;U++){var p=C(U*x*2/I);var r=G(U*x*2/I);E[P+0]=p*M;E[P+1]=H;E[P+2]=r*M;O[P+0]=(W<0||W>L)?0:(p*X);O[P+1]=(W<0)?-1:(W>L?1:q);O[P+2]=(W<0||W>L)?0:(r*X);z[R+0]=U/I;z[R+1]=K;R+=2;P+=3}}for(W=0;W<L+s;W++){for(U=0;U<I;U++){var F=(W*I+U)*6;D[F+0]=T*(W+0)+0+U;D[F+1]=T*(W+0)+1+U;D[F+2]=T*(W+1)+1+U;D[F+3]=T*(W+0)+0+U;D[F+4]=T*(W+1)+1+U;D[F+5]=T*(W+1)+0+U}}g.Model.call(this,a.extend({vertices:E,normals:O,texCoords:z,indices:D},Y||{}))};g.TruncatedCone.prototype=Object.create(g.Model.prototype);g.Cone=function(p){p.topRadius=0;p.topCap=!!p.cap;p.bottomCap=!!p.cap;p.bottomRadius=p.radius||3;g.TruncatedCone.call(this,p)};g.Cone.prototype=Object.create(g.TruncatedCone.prototype);g.Cylinder=function(p){p.bottomRadius=p.radius;p.topRadius=p.radius;g.TruncatedCone.call(this,p)};g.Cylinder.prototype=Object.create(g.TruncatedCone.prototype);g.Plane=function(N){var q=N.type,K=q.split(","),p=N[K[0]+"len"],y=N[K[1]+"len"],M=N["n"+K[0]]||1,L=N["n"+K[1]]||1,t=N.offset,G=!!N.flipCull,J=(M+1)*(L+1),A=new Float32Array(J*3),F=new Float32Array(J*3),r=new Float32Array(J*2),I=0,H=0;if(G){p=-p}for(var B=0;B<=L;B++){for(var C=0;C<=M;C++){var E=C/M,D=B/L;if(G){r[I+0]=1-E}else{r[I+0]=E}r[I+1]=D;I+=2;switch(q){case"x,y":A[H+0]=p*E-p*0.5;A[H+1]=y*D-y*0.5;A[H+2]=t;F[H+0]=0;F[H+1]=0;if(G){F[H+2]=1}else{F[H+2]=-1}break;case"x,z":A[H+0]=p*E-p*0.5;A[H+1]=t;A[H+2]=y*D-y*0.5;F[H+0]=0;if(G){F[H+1]=1}else{F[H+1]=-1}F[H+2]=0;break;case"y,z":A[H+0]=t;A[H+1]=p*E-p*0.5;A[H+2]=y*D-y*0.5;if(G){F[H+0]=1}else{F[H+0]=-1}F[H+1]=0;F[H+2]=0;break}H+=3}}var O=M+1,s=[];for(B=0;B<L;B++){for(C=0;C<M;C++){var w=(B*M+C)*6;s[w+0]=(B+0)*O+C;s[w+1]=(B+1)*O+C;s[w+2]=(B+0)*O+C+1;s[w+3]=(B+1)*O+C;s[w+4]=(B+1)*O+C+1;s[w+5]=(B+0)*O+C+1}}g.Model.call(this,a.extend({vertices:A,normals:F,texCoords:r,indices:s},N))};g.Plane.prototype=Object.create(g.Model.prototype);g.id=a.time();PhiloGL.O3D=g})();(function(){var g={Vertex:{},Fragment:{}};var h=g.Vertex,f=g.Fragment;h.Default=["#define LIGHT_MAX 4","attribute vec3 position;","attribute vec3 normal;","attribute vec4 color;","attribute vec4 pickingColor;","attribute vec2 texCoord1;","uniform mat4 viewMatrix;","uniform mat4 viewInverseMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewProjectionMatrix;","uniform mat4 worldMatrix;","uniform mat4 worldInverseMatrix;","uniform mat4 worldInverseTransposeMatrix;","uniform mat4 objectMatrix;","uniform vec3 cameraPosition;","uniform bool enableLights;","uniform vec3 ambientColor;","uniform vec3 directionalColor;","uniform vec3 lightingDirection;","uniform vec3 pointLocation[LIGHT_MAX];","uniform vec3 pointColor[LIGHT_MAX];","uniform int numberPoints;","uniform bool useReflection;","varying vec3 vReflection;","varying vec4 vColor;","varying vec4 vPickingColor;","varying vec2 vTexCoord;","varying vec4 vNormal;","varying vec3 lightWeighting;","void main(void) {","vec4 mvPosition = worldMatrix * vec4(position, 1.0);","vec4 transformedNormal = worldInverseTransposeMatrix * vec4(normal, 1.0);","if(!enableLights) {","lightWeighting = vec3(1.0, 1.0, 1.0);","} else {","vec3 plightDirection;","vec3 pointWeight = vec3(0.0, 0.0, 0.0);","float directionalLightWeighting = max(dot(transformedNormal.xyz, lightingDirection), 0.0);","for (int i = 0; i < LIGHT_MAX; i++) {","if (i < numberPoints) {","plightDirection = normalize((viewMatrix * vec4(pointLocation[i], 1.0)).xyz - mvPosition.xyz);","pointWeight += max(dot(transformedNormal.xyz, plightDirection), 0.0) * pointColor[i];","} else {","break;","}","}","lightWeighting = ambientColor + (directionalColor * directionalLightWeighting) + pointWeight;","}","if (useReflection) {","vReflection = (viewInverseMatrix[3] - (worldMatrix * vec4(position, 1.0))).xyz;","} else {","vReflection = vec3(1.0, 1.0, 1.0);","}","vColor = color;","vPickingColor = pickingColor;","vTexCoord = texCoord1;","vNormal = transformedNormal;","gl_Position = projectionMatrix * worldMatrix * vec4(position, 1.0);","}"].join("\n");f.Default=["#ifdef GL_ES","precision highp float;","#endif","varying vec4 vColor;","varying vec4 vPickingColor;","varying vec2 vTexCoord;","varying vec3 lightWeighting;","varying vec3 vReflection;","varying vec4 vNormal;","uniform bool hasTexture1;","uniform sampler2D sampler1;","uniform bool hasTextureCube1;","uniform samplerCube samplerCube1;","uniform bool enablePicking;","uniform bool hasPickingColors;","uniform vec3 pickColor;","uniform float reflection;","uniform float refraction;","uniform bool hasFog;","uniform vec3 fogColor;","uniform float fogNear;","uniform float fogFar;","void main(){","if (!hasTexture1) {","gl_FragColor = vec4(vColor.rgb * lightWeighting, vColor.a);","} else {","gl_FragColor = vec4(texture2D(sampler1, vec2(vTexCoord.s, vTexCoord.t)).rgb * lightWeighting, 1.0);","}","if (hasTextureCube1) {","vec3 nReflection = normalize(vReflection);","vec3 reflectionValue;","if (refraction > 0.0) {","reflectionValue = refract(nReflection, vNormal.xyz, refraction);","} else {","reflectionValue = -reflect(nReflection, vNormal.xyz);","}","vec4 cubeColor = textureCube(samplerCube1, vec3(-reflectionValue.x, -reflectionValue.y, reflectionValue.z));","gl_FragColor = vec4(mix(gl_FragColor.xyz, cubeColor.xyz, reflection), 1.0);","}","if (enablePicking) {","if (hasPickingColors) {","gl_FragColor = vPickingColor;","} else {","gl_FragColor = vec4(pickColor, 1.0);","}","}","if (hasFog) {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float fogFactor = smoothstep(fogNear, fogFar, depth);","gl_FragColor = mix(gl_FragColor, vec4(fogColor, gl_FragColor.w), fogFactor);","}","}"].join("\n");PhiloGL.Shaders=g})();(function(){var g=PhiloGL.Vec3,f=PhiloGL.Mat4;var h=function(i,k,j){j=a.merge({lights:{enable:false,ambient:{r:0.2,g:0.2,b:0.2},directional:{direction:{x:1,y:1,z:1},color:{r:0,g:0,b:0}}},effects:{fog:false}},j||{});this.program=j.program?i[j.program]:i;this.camera=k;this.models=[];this.config=j};h.prototype={add:function(){for(var m=0,n=this.models,j=arguments.length;m<j;m++){var k=arguments[m];k.id=k.id||a.uid();n.push(k);this.defineBuffers(k)}},remove:function(i){var k=this.models,j=k.indexOf(i);if(j>-1){k.splice(j,1)}},getProgram:function(j){var i=this.program;if(i.$$family!="program"&&j&&j.program){i=i[j.program];i.use();return i}return i},defineBuffers:function(k){var i=this.getProgram(k),j=k.dynamic;k.dynamic=true;k.setState(i);k.dynamic=j;k.unsetState(i)},beforeRender:function(i){this.setupLighting(i);this.setupEffects(i);if(this.camera){this.camera.setStatus(i)}},setupLighting:function(q){var t=Math.abs,D=this.camera,j=D.position,o=this.config.lights,k=o.ambient,z=o.directional,E=z.color,u=z.direction,r=o.enable,A=o.points&&a.splat(o.points)||[],B=A.length,m=[],y=[],s=[],n=[];u=new g(u.x,u.y,u.z).$unit().$scale(-1);q.setUniform("enableLights",r);if(!r){return}q.setUniform("ambientColor",[k.r,k.g,k.b]);q.setUniform("directionalColor",[E.r,E.g,E.b]);q.setUniform("lightingDirection",[u.x,u.y,u.z]);q.setUniform("numberPoints",B);for(var C=0,w=B;C<w;C++){var v=A[C],F=v.position,x=v.color||v.diffuse,p=v.specular;m.push(F.x,F.y,F.z);y.push(x.r,x.g,x.b);s.push(+!!p);if(p){n.push(p.r,p.g,p.b)}else{n.push(0,0,0)}}q.setUniforms({pointLocation:m,pointColor:y});q.setUniforms({enableSpecular:s,pointSpecularColor:n})},setupEffects:function(j){var k=this.config.effects,l=k.fog,i=l.color||{r:0.5,g:0.5,b:0.5};if(l){j.setUniforms({hasFog:true,fogNear:l.near,fogFar:l.far,fogColor:[i.r,i.g,i.b]})}else{j.setUniform("hasFog",false)}},render:function(k){k=k||{};var t=this.camera,r=this.program,s=k.renderProgram,p=a.type(r),n=!s&&p=="object",u=a.extend({onBeforeRender:a.empty,onAfterRender:a.empty},k||{});!n&&this.beforeRender(s||r);for(var q=0,j=this.models,o=j.length;q<o;++q){var m=j[q];if(m.display){var r=s||this.getProgram(m);n&&this.beforeRender(r);m.onBeforeRender(r,t);u.onBeforeRender(m,q);this.renderObject(m,r);u.onAfterRender(m,q);m.onAfterRender(r,t)}}},renderToTexture:function(j,k){k=k||{};var l=c.textures[j+"-texture"],i=c.textureMemo[j+"-texture"];this.render(k);d.bindTexture(i.textureType,l)},renderObject:function(j,k){var n=this.camera,o=n.view,m=n.projection,i=j.matrix,l=o.mulMat4(i),q=l.invert(),p=q.transpose();j.setState(k);k.setUniforms({objectMatrix:i,worldMatrix:l,worldInverseMatrix:q,worldInverseTransposeMatrix:p});if(j.render){j.render(d,k,n)}else{if(j.$indicesLength){d.drawElements((j.drawType!==undefined)?d.get(j.drawType):d.TRIANGLES,j.$indicesLength,d.UNSIGNED_SHORT,0)}else{d.drawArrays((j.drawType!==undefined)?d.get(j.drawType):d.TRIANGLES,0,j.$verticesLength/3)}}j.unsetState(k)},setupPicking:function(){var i=PhiloGL.Program.fromDefaultShaders(),j=Math.floor;c.setFrameBuffer("$picking",{width:5,height:1,bindToTexture:{parameters:[{name:"TEXTURE_ MAG_FILTER",value:"LINEAR"},{name:"TEXTURE_MIN_FILTER",value:"LINEAR",generateMipmap:false}]},bindToRenderBuffer:true});c.setFrameBuffer("$picking",false);this.pickingProgram=i},pick:function(B,A,J){if(!this.pickingProgram){this.setupPicking()}var v={},m=[],z=c.usedProgram,G=this.pickingProgram,L=this.camera,u=L.target,D=L.aspect,R=this.config,s=R.lights.enable,Q=R.effects.fog,F=d.canvas.width,E=d.canvas.height,M=Math.floor,q=h.PICKING_RES,C=5,w=1,P=B*2/F-1,N=1-A*2/E,S=this.unproject([P,N,1],L),k=[],p=new Uint8Array(1*1*4),t=0,r,I,j;this.camera.target=S;this.camera.update();R.lights.enable=false;R.effects.fog=false;c.setFrameBuffer("$picking",true);G.use();G.setUniform("enablePicking",true);d.disable(d.BLEND);d.viewport(0,0,C,w);d.clear(d.COLOR_BUFFER_BIT|d.DEPTH_BUFFER_BIT);d.readPixels(0,0,1,1,d.RGBA,d.UNSIGNED_BYTE,p);r=p[0]+p[1]*256+p[2]*256*256;this.renderPickingScene({background:r,o3dHash:v,o3dList:m,hash:k});d.readPixels(2,0,1,1,d.RGBA,d.UNSIGNED_BYTE,p);var o=[p[0],p[1],p[2]].join(),O=v[o],n;if(!O){for(var K=0,H=m.length;K<H;K++){O=m[K];n=O.pick(p);if(n!==false){O.$pickingIndex=n}else{O=false}}}c.setFrameBuffer("$picking",false);c.setTexture("$picking-texture",false);G.setUniform("enablePicking",false);R.lights.enable=s;R.effects.fog=Q;if(z){z.use()}d.viewport(0,0,F,E);L.target=u;L.aspect=D;L.update();this.o3dHash=v;this.o3dList=m;this.pixel=p;this.capture=I;return O&&O.pickable&&O},unproject:function(j,i){return i.view.invert().mulMat4(i.projection.invert()).mulVec3(j)},renderPickingScene:function(l){if(this.config.renderPickingScene){this.config.renderPickingScene.call(this,l);return}var j=this.pickingProgram,o=l.o3dHash,n=l.o3dList,k=l.background,m=l.hash,i=0;this.renderToTexture("$picking",{renderProgram:j,onBeforeRender:function(r,q){if(q==k){i=1}var p=q+i,s=!!r.pickingColors;j.setUniform("hasPickingColors",s);if(!s){m[0]=p%256;m[1]=((p/256)>>0)%256;m[2]=((p/(256*256))>>0)%256;j.setUniform("pickColor",[m[0]/255,m[1]/255,m[2]/255]);o[m.join()]=r}else{n.push(r)}}})},resetPicking:a.empty};h.MAX_TEXTURES=10;h.MAX_POINT_LIGHTS=4;h.PICKING_RES=4;PhiloGL.Scene=h})();(function(){function f(i,h){var g=this.workers=[];while(h--){g.push(new Worker(i))}}f.prototype={map:function(m){var h=this.workers;var k=this.configs=[];for(var j=0,g=h.length;j<g;j++){k.push(m&&m(j))}return this},reduce:function(h){var o=h.reduceFn,g=this.workers,m=this.configs,j=g.length,p=h.initialValue,r=function(i){j--;if(p===undefined){p=i.data}else{p=o(p,i.data)}if(j==0){h.onComplete(p)}};for(var k=0,n=j;k<n;k++){var q=g[k];q.onmessage=r;q.postMessage(m[k])}return this}};PhiloGL.WorkerGroup=f})();(function(){var j=function(l){this.opt=a.merge({delay:0,duration:1000,transition:function(m){return m},onCompute:a.empty,onComplete:a.empty},l||{})};var h=j.Queue=[];j.prototype={time:null,start:function(l){this.opt=a.merge(this.opt,l||{});this.time=a.time();this.animating=true;h.push(this)},step:function(){if(!this.animating){return}var n=a.time(),p=this.time,m=this.opt,l=m.delay,o=m.duration,q=0;if(n<p+l){m.onCompute.call(this,q);return}if(n<p+l+o){q=m.transition((n-p-l)/o);m.onCompute.call(this,q)}else{this.animating=false;m.onCompute.call(this,1);m.onComplete.call(this)}}};j.compute=function(n,m,l){return n+(m-n)*l};j.Transition={linear:function(l){return l}};var k=j.Transition;(function(){var l=function(p,o){o=a.splat(o);return a.extend(p,{easeIn:function(q){return p(q,o)},easeOut:function(q){return 1-p(1-q,o)},easeInOut:function(q){return(q<=0.5)?p(2*q,o)/2:(2-p(2*(1-q),o))/2}})};var n={Pow:function(q,o){return Math.pow(q,o[0]||6)},Expo:function(o){return Math.pow(2,8*(o-1))},Circ:function(o){return 1-Math.sin(Math.acos(o))},Sine:function(o){return 1-Math.sin((1-o)*Math.PI/2)},Back:function(q,o){o=o[0]||1.618;return Math.pow(q,2)*((o+1)*q-o)},Bounce:function(s){var r;for(var q=0,o=1;1;q+=o,o/=2){if(s>=(7-4*q)/11){r=o*o-Math.pow((11-6*q-11*s)/4,2);break}}return r},Elastic:function(q,o){return Math.pow(2,10*--q)*Math.cos(20*q*Math.PI*(o[0]||1)/3)}};for(var m in n){k[m]=l(n[m])}["Quad","Cubic","Quart","Quint"].forEach(function(p,o){k[p]=l(function(q){return Math.pow(q,[o+2])})})})();var g=self||window,f=function(){var p=h;h=[];if(p.length){for(var n=0,m=p.length,o;n<m;n++){o=p[n];o.step();if(o.animating){h.push(o)}}j.Queue=h}};if(g){var i=false;["webkitAnimationTime","mozAnimationTime","animationTime","webkitAnimationStartTime","mozAnimationStartTime","animationStartTime"].forEach(function(l){if(l in g){j.animationTime=function(){return g[l]};i=true}});if(!i){j.animationTime=a.time}i=false;["webkitRequestAnimationFrame","mozRequestAnimationFrame","requestAnimationFrame"].forEach(function(l){if(l in g){j.requestAnimationFrame=function(m){g[l](function(){f();m()})};i=true}});if(!i){j.requestAnimationFrame=function(l){setTimeout(function(){f();l()},1000/60)}}}PhiloGL.Fx=j})();(function(){var g={};var f=function(){};f.postProcess=(function(){var h=new PhiloGL.O3D.Plane({type:"x,y",xlen:1,ylen:1,offset:0}),i=new PhiloGL.Camera(45,1,0.1,500,{position:{x:0,y:0,z:1.205}}),j=new PhiloGL.Scene({},i);return function(o){var n=c.program.$$family?c.program:c.program[o.program],l=o.fromTexture?a.splat(o.fromTexture):[],q=o.toFrameBuffer,m=!!o.toScreen,p=o.width||c.canvas.width,k=o.height||c.canvas.height;i.aspect=o.aspectRatio?o.aspectRatio:Math.max(k/p,p/k);i.update();j.program=n;h.textures=l;h.program=n;if(!j.models.length){j.add(h)}if(q){if(!(q in c.frameBufferMemo)){c.setFrameBuffer(q,{width:p,height:k,bindToTexture:{parameters:[{name:"TEXTURE_MAG_FILTER",value:"LINEAR"},{name:"TEXTURE_MIN_FILTER",value:"LINEAR",generateMipmap:false}]},bindToRenderBuffer:false})}n.use();c.setFrameBuffer(q,true);d.viewport(0,0,p,k);d.clear(d.COLOR_BUFFER_BIT|d.DEPTH_BUFFER_BIT);n.setUniforms(o.uniforms||{});j.renderToTexture(q);c.setFrameBuffer(q,false)}if(m){n.use();d.viewport(0,0,p,k);d.clear(d.COLOR_BUFFER_BIT|d.DEPTH_BUFFER_BIT);n.setUniforms(o.uniforms||{});j.render()}return this}})();g.Image=f;PhiloGL.Media=g})()})();function Controls(d){var c=this;this.app=d;this.root=$("config");this.elements={};this.fadePreset=new PhiloGL.Fx({duration:1500,transition:PhiloGL.Fx.Transition.Quart.easeInOut});var b=$$("nav#view-config li");b.addEvent("click",function(){b.removeClass("selected");c.setPreset(this.textContent.toLowerCase());this.addClass("selected")});var a=$("city"),f=["blur","watermark","terrain","clear","dark"];a.addEvent("change",function(){var g=f.map(function(h){return"img/maps/"+a.value+"/"+h+".png"});d.log.write("Loading, please wait...");PhiloGL.IO.Textures({src:g,parameters:[{name:"TEXTURE_MAG_FILTER",value:"LINEAR"},{name:"TEXTURE_WRAP_S",value:"CLAMP_TO_EDGE"},{name:"TEXTURE_WRAP_T",value:"CLAMP_TO_EDGE"},{name:"TEXTURE_MIN_FILTER",value:"LINEAR"},{name:"TEXTURE_WRAP_S",value:"CLAMP_TO_EDGE"},{name:"TEXTURE_WRAP_T",value:"CLAMP_TO_EDGE"}],onComplete:function(){g.splice(1,0,"depth-texture");console.log(g);d.plane.textures=g;c.setRange("elevation",0);c.setPreset(c.preset||"heat");d.log.write("Done.",true)}})})}Controls.prototype={compute:function(d,c,f){if(d.length){return d.map(function(b,a){return PhiloGL.Fx.compute(b,c[a],f)})}return PhiloGL.Fx.compute(d,c,f)},getElement:function(a){if(this.elements[a]){return this.elements[a]}return(this.elements[a]=$(a))},getCheckbox:function(b){var a=this.getElement(b);return a.checked},setCheckbox:function(c,b){var a=this.getElement(c);a.value=!!b},getColor:function(b){var a=this.getElement(b);return a.value.hexToRgb(true).map(function(c){return c/255})},setColor:function(c,b){var a=this.getElement(c);a.value=b.map(function(d){return(d*255)>>>0}).rgbToHex()},getSelect:function(b){var a=this.getElement(b);return a.selectedIndex},setSelect:function(c,b){var a=this.getElement(c);a.selectedIndex=b},getRange:function(b){var a=this.getElement(b);return +a.value},setRange:function(c,b){var a=this.getElement(c);a.value=+b},getAsUniforms:function(){return{elevation:this.getRange("elevation"),ambient:this.getColor("ambient"),diffuse:this.getColor("diffuse"),specular:this.getColor("specular"),shininess:this.getRange("shininess"),x:this.getRange("x"),y:this.getRange("y"),z:this.getRange("z"),background:this.getColor("background"),foreground:this.getColor("foreground"),type:this.getSelect("type"),enable:this.getCheckbox("enable"),shadow:this.getRange("shadow")}},setPreset:function(v){var k=this.getAsUniforms(),u=Controls.Presets[v],l=u.ids,t=u.models,p=u.camera,b=this.app.plane,s=b.position.x,r=b.position.y,q=b.position.z,f=b.rotation.x,d=b.rotation.y,c=b.rotation.z,o=this.app.camera,j=o.position.x,i=o.position.y,h=o.position.z,n=this.compute,a=k.hasOwnProperty("type")?k.type:0,m=l.hasOwnProperty("type")?l.type:a,g=this;this.preset=v;this.fadePreset.animating=false;this.fadePreset.start({onCompute:function(w){if(l.hasOwnProperty("elevation")){g.setRange("elevation",n(k.elevation,l.elevation,w))}if(l.ambient){g.setColor("ambient",n(k.ambient,l.ambient,w))}if(l.diffuse){g.setColor("diffuse",n(k.diffuse,l.diffuse,w))}if(l.specular){g.setColor("specular",n(k.specular,l.specular,w))}if(l.background){g.setColor("background",n(k.background,l.background,w))}if(l.foreground){g.setColor("foreground",n(k.foreground,l.foreground,w))}if(l.hasOwnProperty("shininess")){g.setRange("shininess",n(k.shininess,l.shininess,w))}if(l.hasOwnProperty("shadow")){g.setRange("shadow",n(k.shadow,l.shadow,w))}if(t&&t.hasOwnProperty("positionX")){b.position.x=n(s,t.positionX,w);b.position.y=n(r,t.positionY,w);b.position.z=n(q,t.positionZ,w)}if(t&&t.hasOwnProperty("rotationX")){b.rotation.x=n(f,t.rotationX,w);b.rotation.y=n(d,t.rotationY,w);b.rotation.z=n(c,t.rotationZ,w)}b.update();if(p&&p.hasOwnProperty("x")){o.position.x=n(j,p.x,w);o.position.y=n(i,p.y,w);o.position.z=n(h,p.z,w);o.update()}b.uniforms.texture=[a,m,w]},onComplete:function(){if(l.hasOwnProperty("type")){g.setSelect("type",l.type);b.uniforms.type=l.type}}})}};Controls.Presets={lightX:2.7,lightY:-0.2,lightZ:3,high:{ids:{elevation:1,shadow:1}},medium:{ids:{elevation:0.5,shadow:0}},low:{ids:{elevation:0.1,shadow:0}},planexy:{ids:{ambient:[1,1,1],diffuse:[0.8,0.8,0.8],specular:[0.533,0.533,0.533],background:[0,0.6745098039215687,0.9333333333333333],elevation:0.12,shadow:0,type:0},models:{positionX:0,positionY:0,positionZ:0,rotationX:-Math.PI/2,rotationY:0,rotationZ:0},camera:{x:0,y:0,z:-1.3}},planeyz:{ids:{ambient:[1,1,1],diffuse:[0.8,0.8,0.8],specular:[0.533,0.533,0.533],background:[0,0.6745098039215687,0.9333333333333333],elevation:0.12,shadow:0,type:0},models:{positionX:0,positionY:-0.01,positionZ:0,rotationX:0,rotationY:Math.PI/2,rotationZ:0},camera:{x:0,y:0,z:-0.81}},planexz:{ids:{ambient:[1,1,1],diffuse:[0.8,0.8,0.8],specular:[0.533,0.533,0.533],background:[0,0.6745098039215687,0.9333333333333333],elevation:0.12,shadow:0,type:0},models:{positionX:0,positionY:-0.01,positionZ:0,rotationX:0,rotationY:0,rotationZ:0},camera:{x:0,y:0,z:-0.81}},fill:{ids:{elevation:0.34,ambient:[0.7725490196078432,0.7725490196078432,0.7725490196078432],diffuse:[0.9058823529411765,0.9058823529411765,0.9058823529411765],specular:[0.5294117647058824,0.5294117647058824,0.5294117647058824],background:[0.5529411764705883,0.5450980392156862,0.17647058823529413],foreground:[0.5529411764705883,0.5450980392156862,0.17647058823529413],shadow:0.23,shininess:10,type:0},models:{positionX:0,positionY:0,positionZ:0,rotationX:-1.11,rotationY:0,rotationZ:0},camera:{x:0,y:0,z:-1.36}},heat:{ids:{elevation:0.5,ambient:[1,1,1],diffuse:[0.8,0.8,0.8],specular:[0.533,0.533,0.533],background:[0.067,0.067,0.067],foreground:[0,0.55294,0.94901],shadow:1,shininess:10,type:3},models:{positionX:0,positionY:0,positionZ:0,rotationX:-Math.PI/2,rotationY:0,rotationZ:0},camera:{x:0,y:0,z:-1.3}},grid:{ids:{elevation:1,ambient:[1,1,1],diffuse:[0.8,0.8,0.8],specular:[0.533,0.533,0.533],background:[0.067,0.067,0.067],foreground:[1,0.13725490196078433,0.1450980392156863],shadow:1,shininess:10,type:1},models:{positionX:0,positionY:0,positionZ:0,rotationX:-Math.PI/2,rotationY:0,rotationZ:0},camera:{x:0,y:0,z:-1.3}},contour:{ids:{elevation:0.1,ambient:[0.5294117647058824,0.5294117647058824,0.5294117647058824],diffuse:[0.8,0.8,0.8],specular:[0.533,0.533,0.533],background:[0.85098,0.811764,0.57647],foreground:[0.10588235294117647,0.10588235294117647,0.11372549019607843],shadow:0,shininess:10,type:2},models:{positionX:0,positionY:0,positionZ:0,rotationX:-0.44079,rotationY:0.26,rotationZ:0},camera:{x:0,y:0,z:-0.335}},watermark:{ids:{elevation:0.1,ambient:[0.4313,0.4313,0.4313],diffuse:[0.41176,0.41176,0.41176],specular:[0.52941,0.52941,0.52941],shadow:0.26,shininess:10,type:4},models:{positionX:0,positionY:0,positionZ:0,rotationX:-1.2407,rotationY:0,rotationZ:0},camera:{x:0,y:0,z:-0.7}},terrain:{ids:{elevation:0.22,ambient:[0.64705,0.6627,0.7607],diffuse:[0.2235,0.24313,0.22352],specular:[0.1411,0.1843,0.23137],shadow:0.32,shininess:10,type:5},models:{positionX:0,positionY:0,positionZ:0,rotationX:-1.55079632,rotationY:0,rotationZ:0},camera:{x:0,y:0,z:-1}},clear:{ids:{elevation:0.22,ambient:[0.64705,0.6627,0.7607],diffuse:[0.2235,0.24313,0.22352],specular:[0.1411,0.1843,0.23137],shadow:0.32,shininess:10,type:6},models:{positionX:0,positionY:0,positionZ:0,rotationX:-1.55079632,rotationY:0,rotationZ:0},camera:{x:0,y:0,z:-1}},dark:{ids:{elevation:0.22,ambient:[0.64705,0.6627,0.7607],diffuse:[0.2235,0.24313,0.22352],specular:[0.1411,0.1843,0.23137],shadow:0.32,shininess:10,type:7},models:{positionX:0,positionY:0,positionZ:0,rotationX:-1.55079632,rotationY:0,rotationZ:0},camera:{x:0,y:0,z:-1}}};PhiloGL.O3D.LargePlane=function(w){var b=w.type,q=b.split(","),a=w[q[0]+"len"],g=w[q[1]+"len"],t=w["n"+q[0]]||1,s=w["n"+q[1]]||1,d=w.offset,m=!!w.flipCull,p=(t+1)*(s+1),h=new Float32Array(p*3),r,A,o=0,n=0;if(m){a=-a}for(var i=0;i<=s;i++){for(var j=0;j<=t;j++){var l=j/t,k=i/s;o+=2;switch(b){case"x,y":h[n+0]=a*l-a*0.5;h[n+1]=g*k-g*0.5;h[n+2]=d;if(i==s){A=[0,0,1]}break;case"x,z":h[n+0]=a*l-a*0.5;h[n+1]=d;h[n+2]=g*k-g*0.5;if(i==s){A=[0,1,0]}break;case"y,z":h[n+0]=d;h[n+1]=a*l-a*0.5;h[n+2]=g*k-g*0.5;if(i==s){A=[1,0,0]}break}n+=3}}var y=t+1,c=[];r=new Float32Array(t*s*6*3);for(i=0;i<s;i++){for(j=0;j<t;j++){var f=(i*t+j)*6*3;r[f+0]=h[((i+0)*y+j)*3+0];r[f+1]=h[((i+0)*y+j)*3+1];r[f+2]=h[((i+0)*y+j)*3+2];r[f+3]=h[((i+1)*y+j)*3+0];r[f+4]=h[((i+1)*y+j)*3+1];r[f+5]=h[((i+1)*y+j)*3+2];r[f+6]=h[((i+0)*y+j+1)*3+0];r[f+7]=h[((i+0)*y+j+1)*3+1];r[f+8]=h[((i+0)*y+j+1)*3+2];r[f+9]=h[((i+1)*y+j)*3+0];r[f+10]=h[((i+1)*y+j)*3+1];r[f+11]=h[((i+1)*y+j)*3+2];r[f+12]=h[((i+1)*y+j+1)*3+0];r[f+13]=h[((i+1)*y+j+1)*3+1];r[f+14]=h[((i+1)*y+j+1)*3+2];r[f+15]=h[((i+0)*y+j+1)*3+0];r[f+16]=h[((i+0)*y+j+1)*3+1];r[f+17]=h[((i+0)*y+j+1)*3+2]}}PhiloGL.O3D.Model.call(this,Object.merge({vertices:r,uniforms:{normal:A}},w))};PhiloGL.O3D.LargePlane.prototype=Object.create(PhiloGL.O3D.Model.prototype);window.addEvent("domready",init,false);function init(){var i={},f={},c,h="low",g=1,d=(window.innerWidth/g)>>>0,a=(window.innerHeight/g)>>>0;var b={elem:null,timer:null,getElem:function(){if(!this.elem){return(this.elem=$("log-message"))}return this.elem},write:function(m,j){if(this.timer){this.timer=clearTimeout(this.timer)}var l=this.getElem(),k=l.style;k.height="2.1em";l.textContent=m;k.visibility="visible";if(j){this.timer=setTimeout(function(){k.visibility="hidden";k.height=0;l.textContent=""},5000)}}};if(!PhiloGL.hasWebGL()){b.write("Your machine does not support WebGL! Here's a video of what you're missing.");$("map").dispose();$$("body > aside a").dispose();$$("body > aside")[0].addClass("hidden");$("quality-wording").setStyle("display","none");$("canvas-container").set("html",'<iframe width="800" height="600" src="http://www.youtube.com/embed/c8SHpJ3E2mA?rel=0" frameborder="0" allowfullscreen></iframe>');return}b.write("Doing many things, please wait...");PhiloGL("map",{program:[{id:"plane",from:"uris",path:"./shaders/",vs:"plane.vs",fs:"plane.fs"},{id:"depth",from:"uris",path:"./shaders/",vs:"depth.vs",fs:"depth.fs"},{id:"blur",from:"uris",path:"./shaders/",vs:"bloom.vs",fs:"bloom.fs"}],camera:{position:{x:0,y:0,z:-1.3},near:0.01,far:7},scene:{lights:{enable:true,ambient:{r:0.3,g:0.3,b:0.3},points:{diffuse:{r:0.6,g:0.6,b:0.6},specular:{r:0.4,g:0.4,b:0.5},position:{x:2.7,y:-0.2,z:3}}}},textures:{src:["img/maps/sf/blur.png","img/maps/sf/watermark.png","img/maps/sf/terrain.png","img/maps/sf/clear.png","img/maps/sf/dark.png"],parameters:[{name:"TEXTURE_MAG_FILTER",value:"LINEAR"},{name:"TEXTURE_WRAP_S",value:"CLAMP_TO_EDGE"},{name:"TEXTURE_WRAP_T",value:"CLAMP_TO_EDGE"},{name:"TEXTURE_MIN_FILTER",value:"LINEAR"},{name:"TEXTURE_WRAP_S",value:"CLAMP_TO_EDGE"},{name:"TEXTURE_WRAP_T",value:"CLAMP_TO_EDGE"}]},events:{onDragStart:function(j){this.pos={x:j.x,y:j.y}},onDragMove:function(l){var m=this.camera.position.z,k=Math.abs(m)/m,n=this.pos,j=this.plane;j.rotation.y+=-(n.x-l.x)/100;j.rotation.x+=k*(n.y-l.y)/100;j.update();n.x=l.x;n.y=l.y},onMouseWheel:function(k){k.stop();var j=this.camera;j.position.z+=k.wheel/20;j.update()}},onError:function(j){b.wrote("There was an error!, stopping here.");console.log("error",arguments)},onLoad:function(o){b.write("Still loading...");var D=$$("body > aside")[0],v=o.gl,n=o.program,x=o.scene,k=o.canvas,w=o.camera,j=Controls.Presets,p=[j.lightX,j.lightY,-j.lightZ],B=new PhiloGL.Camera(w.fov,w.aspect,w.near,w.far),C=x.config.lights,r=new PhiloGL.O3D.LargePlane({program:"plane",type:"x,z",xlen:1,zlen:1,nx:1000,nz:1000,offset:0,textures:["img/maps/sf/blur.png","depth-texture","img/maps/sf/watermark.png","img/maps/sf/terrain.png","img/maps/sf/clear.png","img/maps/sf/dark.png"],uniforms:{shininess:10,size:[d,a],type:0,elevation:0,near:w.near,far:w.far}}),q=new PhiloGL.O3D.Plane({program:"plane",type:"x,z",xlen:1,zlen:1,nx:200,nz:200,offset:0,textures:["img/maps/sf/blur.png","depth-texture","img/maps/sf/watermark.png","img/maps/sf/terrain.png","img/maps/sf/clear.png","img/maps/sf/dark.png"],uniforms:{shininess:10,size:[d,a],type:0,elevation:0,near:w.near,far:w.far}}),F=1,l={width:d/F,height:a/F,bindToTexture:{parameters:[{name:"TEXTURE_MAG_FILTER",value:"LINEAR"},{name:"TEXTURE_MIN_FILTER",value:"LINEAR"},{name:"TEXTURE_WRAP_S",value:"CLAMP_TO_EDGE"},{name:"TEXTURE_WRAP_T",value:"CLAMP_TO_EDGE"}]},bindToRenderBuffer:true},s=new Controls(o),u=C.points,E=u.position,z=q.uniforms,A,t,m;o.log=b;o.controls=s;o.depthCamera=B;window.app=o;$("toggle").addEvent("click",function(G){G.preventDefault();D.toggleClass("hidden")});$("switchToHigh").addEvent("click",function(G){h="high";o.plane=r;r.uniforms=q.uniforms;r.rotation=q.rotation;r.program=q.program;z=r.uniforms;r.update();x.remove(q);x.add(r);$("quality-wording").setStyle("display","none")});window.addEvent("resize",function(G){d=(window.innerWidth/F)>>>0;a=(window.innerHeight/F)>>>0;k.width=d;k.height=a;l.width=k.width;l.height=k.height;o.setFrameBuffer("depth",l).setFrameBuffer("blur",l)});k.width=d;k.height=a;o.setFrameBuffer("depth",l).setFrameBuffer("blur",l);v.clearColor(0,0,0,0);v.clearDepth(1);v.enable(v.DEPTH_TEST);v.depthFunc(v.LEQUAL);v.viewport(0,0,+k.width,+k.height);x.add(q);o.plane=q;o.plane.rotation.x=-Math.PI/2;o.plane.update();B.position.x=u.position.x;B.position.y=u.position.y;B.position.z=-u.position.z;B.update();b.write("Done.",true);s.setPreset("watermark");(function y(){A=s.getAsUniforms();C.enable=A.enable;C.ambient={r:A.ambient[0],g:A.ambient[1],b:A.ambient[2]};u.diffuse={r:A.diffuse[0],g:A.diffuse[1],b:A.diffuse[2]};u.specular={r:A.specular[0],g:A.specular[1],b:A.specular[2]};o.plane.rotation.x+=Math.PI/2;o.plane.update();m=o.plane.matrix.mulVec3([j.lightX,j.lightY,j.lightZ]);u.position={x:m[0],y:m[1],z:m[2]};m=o.plane.matrix.mulVec3(p);B.position.x=m[0];B.position.y=m[1];B.position.z=m[2];B.update();o.plane.rotation.x-=Math.PI/2;o.plane.update();z.background=A.background;z.foreground=A.foreground;z.type=A.type;z.shininess=A.shininess;z.depthView=B.view;z.depthProjection=B.projection;z.enableShadow=A.shadow;z.elevation=A.elevation;if(h!="low"&&A.shadow>0){o.setFrameBuffer("depth",true);v.viewport(0,0,k.width/F,k.height/F);v.clear(v.COLOR_BUFFER_BIT|v.DEPTH_BUFFER_BIT);o.plane.program="depth";x.camera=B;x.renderToTexture("depth");o.setFrameBuffer("depth",false);PhiloGL.Media.Image.postProcess({fromTexture:"depth-texture",toFrameBuffer:"blur",program:"blur",uniforms:{radius:5,blurX:1,blurY:0,width:k.width/F,height:k.height/F}}).postProcess({fromTexture:"blur-texture",toFrameBuffer:"depth",program:"blur",uniforms:{radius:5,blurX:0,blurY:1,width:k.width/F,height:k.height/F}})}v.viewport(0,0,k.width,k.height);v.clear(v.COLOR_BUFFER_BIT|v.DEPTH_BUFFER_BIT);o.plane.program="plane";x.camera=w;x.render();PhiloGL.Fx.requestAnimationFrame(y)}())}})};